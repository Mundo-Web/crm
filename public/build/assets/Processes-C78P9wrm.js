var C=Object.defineProperty;var j=(s,t,o)=>t in s?C(s,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[t]=o;var m=(s,t,o)=>j(s,typeof t!="symbol"?t+"":t,o);import{C as v,c as w,j as r,r as i}from"./CreateReactScript-DzUQzfGT.js";import{B as D,A as B,S as E}from"./Adminto-gT2hg0MO.js";import{M as T}from"./Modal-C-8pRjtx.js";import{T as y,D as d}from"./DxPanelButton-CpOYnvBD.js";import{I as P}from"./InputFormGroup-BKEuQBMN.js";import{T as S}from"./TextareaFormGroup-BR-quq0y.js";import{D as x}from"./DxButton-CsjWvhyj.js";import"./server.browser-BwVmVyxX.js";class k extends D{constructor(){super(...arguments);m(this,"path","processes")}}const u=new k,A=({can:s})=>{const t=i.useRef(),o=i.useRef(),l=i.useRef(),c=i.useRef(),a=i.useRef(),[R,f]=i.useState(!1),p=e=>{e!=null&&e.id?f(!0):f(!1),l.current.value=(e==null?void 0:e.id)||null,c.current.value=(e==null?void 0:e.name)||null,a.current.value=(e==null?void 0:e.description)||null,$(o.current).modal("show")},b=async e=>{e.preventDefault();const n={id:l.current.value||void 0,name:c.current.value,description:a.current.value};await u.save(n)&&($(t.current).dxDataGrid("instance").refresh(),$(o.current).modal("hide"))},g=async e=>{const{isConfirmed:n}=await E.fire({title:"Eliminar proceso",text:"¿Está seguro de eliminar este proceso?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"Cancelar"});!n||!await u.delete(e)||$(t.current).dxDataGrid("instance").refresh()};return r.jsxs(r.Fragment,{children:[r.jsx(y,{gridRef:t,title:"Procesos",rest:u,toolBar:e=>{e.unshift(d({className:"btn btn-xs btn-soft-dark",text:"Actualizar",title:"Refrescar tabla",icon:"fas fa-undo-alt",onClick:()=>$(t.current).dxDataGrid("instance").refresh()})),s("processes","all","create")&&e.unshift(d({className:"btn btn-xs btn-soft-primary",text:"Nuevo",title:"Agregar registro",icon:"fa fa-plus",onClick:()=>p()}))},columns:[{dataField:"name",caption:"Proceso",dataType:"string"},{dataField:"description",caption:"Descripcion",dataType:"string"},{caption:"Acciones",cellTemplate:(e,{data:n})=>{s("processes","root","all","update")&&e.append(x({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>p(n)})),s("processes","root","all","delete")&&e.append(x({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash-alt",onClick:()=>g(n.id)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsx(T,{modalRef:o,title:R?"Editar proceso":"Agregar proceso",onSubmit:b,children:r.jsxs("div",{className:"row",children:[r.jsx("input",{ref:l,type:"hidden"}),r.jsx(P,{eRef:c,label:"Proceso",col:"col-12",required:!0}),r.jsx(S,{eRef:a,label:"Descripción",col:"col-12"})]})})]})};v((s,t)=>{if(!t.can("processes","root","all","list"))return location.href="/";w(s).render(r.jsx(B,{...t,title:"Procesos",children:r.jsx(A,{...t})}))});
