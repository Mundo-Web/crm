var C=Object.defineProperty;var E=(n,e,a)=>e in n?C(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var t=(n,e,a)=>E(n,typeof e!="symbol"?e+"":e,a);import{m as o,j as s,G as $}from"./CreateReactScript-DzUQzfGT.js";import{B as N}from"./Adminto-gT2hg0MO.js";class y extends N{constructor(){super(...arguments);t(this,"path","clients");t(this,"get",async a=>{try{const{status:r,result:i}=await o.Fetch(`/api/${this.path}/${a}`);if(!r)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return i.data}catch(r){return o.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:r.message,type:"danger"}),null}})}}t(y,"assign",async(a,r)=>{try{const{status:i,result:c}=await o.Fetch("/api/clients/assign",{method:r?"PUT":"DELETE",body:JSON.stringify({id:a})});if(!i)throw new Error((c==null?void 0:c.message)??"Ocurrio un error inesperado");return o.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:c.message,type:"success"}),!0}catch(i){return o.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:i.message,type:"danger"}),!1}}),t(y,"clientStatus",async(a,r)=>{try{const{status:i,result:c}=await o.Fetch("/api/clients/client-status",{method:"PATCH",body:JSON.stringify({client:a,status:r})});if(!i)throw new Error((c==null?void 0:c.message)??"Ocurrio un error inesperado");return o.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:c.message,type:"success"}),!0}catch(i){return o.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:i.message,type:"danger"}),!1}});const f=({className:n,style:e,html:a})=>s.jsx("div",{className:n,style:e,dangerouslySetInnerHTML:{__html:a}}),k=({id:n,status:e,name:a,description:r,assigned:i,priority:c,type:l,onChange:h,ends_at:m})=>{const d={Pendiente:{icon:"mdi mdi-clock-time-eight-outline",color:"btn-danger"},"En curso":{icon:"mdi mdi-timer-sand",color:"btn-primary"},Realizado:{icon:"mdi mdi-check",color:"btn-success"}},j={Llamada:{icon:"mdi mdi-phone-forward"},Correo:{icon:"mdi mdi-email-send"},"Por hacer":{icon:"mdi mdi-clock-start"}},b={Baja:{color:"bg-light"},Media:{color:"bg-success"},Alta:{color:"bg-warning"},Urgente:{color:"bg-danger"}};return s.jsx("div",{className:"card border border-default mb-1",children:s.jsxs("div",{className:"card-body p-2",children:[s.jsxs("blockquote",{className:"card-bodyquote mb-0",children:[s.jsxs("div",{className:"btn-group mb-1 d-flex justify-content-between align-items-center",children:[s.jsx("div",{children:h?s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:`btn btn-xs ${d[e].color} btn-sm dropdown-toggle`,type:"button","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:[s.jsx("i",{className:d[e].icon})," ",e," ",s.jsx("i",{className:"mdi mdi-chevron-down"})]}),s.jsx("div",{className:"dropdown-menu",children:Object.keys(d).map((x,u)=>s.jsxs("span",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>h(n,x),children:[s.jsx("i",{className:d[x].icon})," ",x]},`status-${u}`))})]}):s.jsxs("span",{className:`btn btn-xs ${d[e].color} btn-sm`,style:{whiteSpace:"nowrap",cursor:"default"},children:[s.jsx("i",{className:d[e].icon})," ",e]})}),s.jsxs("small",{className:"text-muted ms-1",children:["vence ",moment(m).fromNow()]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("span",{className:"badge bg-light text-dark me-1",children:[s.jsx("i",{className:j[l].icon})," ",l]}),s.jsx("span",{className:`badge ${b[c].color}`,children:c})]}),s.jsx("h5",{className:"mt-0",children:a}),r&&s.jsx("small",{children:s.jsx(f,{html:r})})]}),i&&s.jsxs("small",{children:[s.jsx("img",{src:`//${$.APP_DOMAIN}/api/profile/thumbnail/${i.relative_id}`,alt:i.fullname,className:"img-fluid avatar-xs rounded-circle me-1"}),"Asignado a ",s.jsx("b",{children:i.fullname})]})]})})},T=({id:n,type:e,name:a,process:r,description:i,created_at:c,updated_at:l,user_id:h,tasks:m,onTaskChange:d,showOptions:j=!0,session:b,onDeleteNote:x,onUpdateNote:u,status:p,manage_status:g})=>e?s.jsxs("div",{className:"card border border-primary mb-2",children:[a&&s.jsxs("div",{className:"card-header p-2 d-flex justify-content-between align-items-center",children:[s.jsx("h5",{className:"card-title mb-0",children:r?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"mdi mdi-timeline-text me-1"})," ",r," ",s.jsx("small",{className:"text-muted",children:a})]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:`${(e==null?void 0:e.icon)??"mdi mdi-clock"} me-1`})," ",a]})}),j&&h==b.service_user.id&&s.jsxs("div",{className:"dropdown",children:[s.jsx("a",{className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",style:{cursor:"pointer"},children:s.jsx("i",{className:"mdi mdi-dots-vertical"})}),s.jsxs("div",{className:"dropdown-menu dropdown-menu-end",children:[s.jsxs("a",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>u({id:n,type:e,name:a,description:i,tasks:m}),children:[s.jsx("i",{className:"fa fa-pen me-1"}),"Editar"]}),s.jsxs("a",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>x(n),children:[s.jsx("i",{className:"fa fa-trash me-1"}),"Eliminar"]})]})]})]}),s.jsxs("div",{className:"card-body p-2",children:[i&&s.jsx("div",{className:"card-text",children:s.jsx(f,{html:i})}),m.length>0&&m.map((w,v)=>s.jsx(k,{...w,onChange:d},`task-${v}`)),(p||g)&&s.jsxs("div",{className:"d-flex mb-1 gap-1",children:[p&&s.jsx("span",{className:"badge rounded-pill px-1",style:{paddingTop:"4px",backgroundColor:p.color},children:p.name}),g&&s.jsx("span",{className:"badge rounded-pill px-1",style:{paddingTop:"4px",backgroundColor:g.color},children:g.name})]}),s.jsx("p",{className:"card-text",children:s.jsxs("small",{className:"text-muted",children:[moment(c).format("LLL")," ",l!=c&&s.jsxs("span",{children:["· ",s.jsx("i",{children:"Editado"})]})]})})]})]}):s.jsxs("div",{className:"card card-body p-2 mb-2",style:{border:"1px solid #dee2e6"},children:[s.jsxs("p",{className:"card-text mb-0",children:[s.jsx("i",{className:"mdi mdi-clock me-1"}),a]}),s.jsx("p",{className:"card-text",children:s.jsxs("small",{className:"text-muted",children:[moment(c).format("LLL")," ",l!=c&&s.jsxs("span",{children:["· ",s.jsx("i",{children:"Editado"})]})]})})]});class O extends N{constructor(){super(...arguments);t(this,"path","client-notes");t(this,"byClient",async a=>{const{result:r}=await o.Fetch(`/api/${this.path}/client/${a}`);return(r==null?void 0:r.data)??[]})}}class S extends N{constructor(){super(...arguments);t(this,"path","products-by-client");t(this,"byClient",async a=>{const{result:r}=await o.Fetch(`/api/${this.path}/client/${a}`);return(r==null?void 0:r.data)??[]})}}export{y as C,f as H,S as P,k as T,O as a,T as b};
