var v=Object.defineProperty;var w=(o,t,r)=>t in o?v(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r;var m=(o,t,r)=>w(o,typeof t!="symbol"?t+"":t,r);import{m as n,C as E,c as T,j as s,r as d}from"./CreateReactScript-xvpUtUf-.js";import{R as c}from"./ReactAppend-CbQ9xRYf.js";import{A as R}from"./Adminto-DIU1NFHn.js";import{M as C}from"./Modal-C58GK_rV.js";import{T as S,D as g}from"./DxPanelButton-B6rqaCe-.js";import{I as D}from"./InputFormGroup-aagpvPA0.js";import{T as F}from"./TextareaFormGroup-DxwEjr-u.js";import{T as f}from"./TippyButton-DI3bb-DI.js";import"./server.browser-BrMqSrzL.js";class u{}m(u,"paginate",async t=>{const{result:r}=await n.Fetch("/api/tables/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});return r}),m(u,"save",async t=>{try{const{status:r,result:a}=await n.Fetch("/api/tables",{method:"POST",body:JSON.stringify(t)});if(!r)throw new Error((a==null?void 0:a.message)||"Ocurrio un error inesperado");return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:a.message,type:"success"}),!0}catch(r){return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:r.message,type:"danger"}),!1}}),m(u,"status",async({id:t,status:r})=>{try{const{status:a,result:l}=await n.Fetch("/api/tables/status",{method:"PATCH",body:JSON.stringify({id:t,status:r})});if(!a)throw new Error((l==null?void 0:l.message)??"Ocurrio un error inesperado");return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:l.message,type:"success"}),!0}catch(a){return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:a.message,type:"danger"}),!1}}),m(u,"delete",async t=>{try{const{status:r,result:a}=await n.Fetch(`/api/tables/${t}`,{method:"DELETE"});if(!r)throw new Error((a==null?void 0:a.message)??"Ocurrio un error inesperado");return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:a.message,type:"success"}),!0}catch(r){return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:r.message,type:"danger"}),!1}});const k=()=>{const o=d.useRef(),t=d.useRef(),r=d.useRef(),a=d.useRef(),l=d.useRef(),[b,p]=d.useState(!1),x=e=>{e!=null&&e.id?p(!0):p(!1),r.current.value=(e==null?void 0:e.id)||null,a.current.value=(e==null?void 0:e.name)||null,l.current.value=(e==null?void 0:e.description)||null,$(t.current).modal("show")},y=async e=>{e.preventDefault();const i={id:r.current.value||void 0,name:a.current.value,description:l.current.value};await u.save(i)&&($(o.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"))},h=async({id:e,status:i})=>{await u.status({id:e,status:i})&&$(o.current).dxDataGrid("instance").refresh()},j=async e=>{await u.delete(e)&&$(o.current).dxDataGrid("instance").refresh()};return s.jsxs(s.Fragment,{children:[s.jsx(S,{gridRef:o,title:"Tablas",rest:u,toolBar:e=>{e.unshift(g({className:"btn btn-xs btn-soft-dark",text:"Actualizar",title:"Refrescar tabla",icon:"fas fa-undo-alt",onClick:()=>$(o.current).dxDataGrid("instance").refresh()})),e.unshift(g({className:"btn btn-xs btn-soft-primary",text:"Nuevo",title:"Agregar registro",icon:"fa fa-plus",onClick:()=>onOpenModal()}))},columns:[{dataField:"id",caption:"ID",dataType:"number",sortOrder:"asc"},{dataField:"name",caption:"Tipo"},{dataField:"description",caption:"Descripcion",cellTemplate:(e,{value:i})=>{i?c(e,i):c(e,s.jsx("i",{className:"text-muted",children:"- Sin descripcion -"}))}},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(e,{data:i})=>{switch(i.status){case 1:c(e,s.jsx("span",{className:"badge bg-success rounded-pill",children:"Activo"}));break;case 0:c(e,s.jsx("span",{className:"badge bg-danger rounded-pill",children:"Inactivo"}));break;default:c(e,s.jsx("span",{className:"badge bg-dark rounded-pill",children:"Eliminado"}));break}}},{caption:"Acciones",cellTemplate:(e,{data:i})=>{e.attr("style","display: flex; gap: 4px; overflow: unset"),c(e,s.jsx(f,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>x(i),children:s.jsx("i",{className:"fa fa-pen"})})),c(e,s.jsx(f,{className:"btn btn-xs btn-light",title:i.status===null?"Restaurar":"Cambiar estado",onClick:()=>h(i),children:i.status===1?s.jsx("i",{className:"fa fa-toggle-on text-success"}):i.status===0?s.jsx("i",{className:"fa fa-toggle-off text-danger"}):s.jsx("i",{className:"fas fa-trash-restore"})})),c(e,s.jsx(f,{className:"btn btn-xs btn-soft-danger",title:"Eliminar",onClick:()=>j(i.id),children:s.jsx("i",{className:"fa fa-trash-alt"})}))},allowFiltering:!1,allowExporting:!1}]}),s.jsx(C,{modalRef:t,title:b?"Editar tabla":"Agregar tabla",onSubmit:y,size:"sm",children:s.jsxs("div",{className:"row",children:[s.jsx("input",{ref:r,type:"hidden"}),s.jsx(D,{eRef:a,label:"Tabla",col:"col-12",required:!0}),s.jsx(F,{eRef:l,label:"Descripcion",col:"col-12"})]})})]})};E((o,t)=>{T(o).render(s.jsx(R,{...t,title:"Tablas",children:s.jsx(k,{...t})}))});
