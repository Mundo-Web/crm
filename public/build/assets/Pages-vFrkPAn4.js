var I=Object.defineProperty;var q=(r,s,a)=>s in r?I(r,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[s]=a;var b=(r,s,a)=>q(r,typeof s!="symbol"?s+"":s,a);import{C as z,c as O,j as t,r as o}from"./CreateReactScript-BkSYNPDa.js";import{R as j}from"./ReactAppend-C3nw6mVj.js";import{B as J,A as V,i as R}from"./Adminto-Dzs843Af.js";import{M as H}from"./Modal-DG-P1Du9.js";import{T as K}from"./Table-Zqq82qEi.js";import{I as E}from"./InputFormGroup-BsGpj5M3.js";import{T as L}from"./TextareaFormGroup-BaA4wmxj.js";import{T as B}from"./TippyButton-Dy-dmNFr.js";import{D as M}from"./DxPanelButton-DW0NGhtK.js";import{S as Q}from"./sweetalert2.esm.all-C1CfSMFW.js";import{S as U}from"./SelectFormGroup-BvmjNpHW.js";import{r as W}from"./server.browser-BEhsz7UB.js";import{I as v}from"./ImageFormGroup-BSqo4066.js";import"./Logout-CWX_kGJ0.js";import"./default-Dfqbhhm5.js";import"./index-DDS45CMq.js";import"./ArrayJoin-2k6ba35P.js";class X extends J{constructor(){super(...arguments);b(this,"path","pages");b(this,"hasFiles",!0)}}const w=new X,Y=({subdomains:r,subdomain:s,can:a})=>{const c=o.useRef(),d=o.useRef(),f=o.useRef(),g=o.useRef(),x=o.useRef(),h=o.useRef(),m=o.useRef(),p=o.useRef(),u=o.useRef(),[P,N]=o.useState(!1),k=e=>{e!=null&&e.id?N(!0):N(!1),f.current.value=(e==null?void 0:e.id)||null,x.current.value=(e==null?void 0:e.path)||"",g.current.value=(e==null?void 0:e.name)||"",h.current.value=(e==null?void 0:e.description)||"",m.image.src=`/api/pages/media/${e.img_desktop}`,p.image.src=`/api/pages/media/${e.img_tablet}`,u.image.src=`/api/pages/media/${e.img_mobile}`,m.current.value=null,p.current.value=null,u.current.value=null,$(d.current).modal("show")},A=async e=>{var T,D,_;e.preventDefault();const i={id:f.current.value||void 0,path:x.current.value,name:g.current.value,description:h.current.value??void 0},n=new FormData;for(const C in i)n.append(C,i[C]);const l=((T=m.current.files)==null?void 0:T[0])??null,S=((D=p.current.files)==null?void 0:D[0])??null,y=((_=u.current.files)==null?void 0:_[0])??null;l&&n.append("img_desktop",l),S&&n.append("img_tablet",S),y&&n.append("img_mobile",y),await w.save(n)&&($(c.current).dxDataGrid("instance").refresh(),$(d.current).modal("hide"))},G=async e=>{const{isConfirmed:i}=await Q.fire({title:"Eliminar rol",text:"¿Está seguro de eliminar este rol?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"Cancelar"});!i||!await w.delete(e)||$(c.current).dxDataGrid("instance").refresh()},F=({id:e,text:i,element:n})=>{if(!e)return i;const l=$(n).data("option");return $(W(t.jsxs("div",{children:[t.jsxs("b",{className:"d-block",children:[i," ",t.jsx("code",{children:l.correlative})]}),t.jsx("small",{className:"d-block text-truncate w-100",children:l.description||"Sin descripción larga larguisima de todos modos larog"})]})))};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"row",children:t.jsx("div",{className:"col-xl-3 col-lg-4 col-md-6 col-sm-8 col-12 mb-2",children:t.jsx(U,{minimumResultsForSearch:-1,templateResult:F,templateSelection:F,onChange:e=>setSelectedMonth(e.target.value),children:r.map((e,i)=>t.jsx("option",{value:e.correlative,"data-option":JSON.stringify(e),children:e.name},i))})})}),t.jsx(K,{gridRef:c,title:`Páginas - ${s.name}`,rest:w,toolBar:e=>{e.unshift(M({className:"btn btn-xs btn-soft-dark",text:"Actualizar",title:"Refrescar tabla",icon:"fas fa-undo-alt",onClick:()=>$(c.current).dxDataGrid("instance").refresh()})),a("pages","all","create")&&e.unshift(M({className:"btn btn-xs btn-soft-primary",text:"Nuevo",title:"Agregar registro",icon:"fa fa-plus",onClick:()=>k()}))},filterValue:["subdomain_id","=",s.id],columns:[{dataField:"subdomain_id",visible:!1},{dataField:"path",caption:"Ruta"},{dataField:"name",caption:"Nombre"},{dataField:"description",caption:"Descripcion"},{dataField:"images",caption:"Imagenes",allowFiltering:!1,width:"200px",cellTemplate:(e,{data:i})=>{j(e,t.jsxs("div",{className:"d-flex gap-1",children:[t.jsx(R,{content:"Desktop",children:t.jsx("img",{src:`/api/pages/media/${i.img_desktop}`,className:"border",style:{height:"40px",aspectRatio:16/9,objectFit:"cover",objectPosition:"top center"}})}),t.jsx(R,{content:"Tablet",children:t.jsx("img",{src:`/api/pages/media/${i.img_tablet||i.img_desktop}`,className:"border",style:{height:"40px",aspectRatio:4/3,objectFit:"cover",objectPosition:"top center"}})}),t.jsx(R,{content:"Mobile",children:t.jsx("img",{src:`/api/pages/media/${i.img_mobile||i.img_tablet||i.img_desktop}`,className:"border",style:{height:"40px",aspectRatio:9/16,objectFit:"cover",objectPosition:"top center"}})})]}))}},{caption:"Acciones",cellTemplate:(e,{data:i})=>{e.attr("style","display: flex; gap: 4px; overflow: unset; height: 51px"),j(e,t.jsx(B,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>k(i),children:t.jsx("i",{className:"fa fa-pen"})})),j(e,t.jsx(B,{className:"btn btn-xs btn-soft-danger",title:"Eliminar",onClick:()=>G(i.id),children:t.jsx("i",{className:"fa fa-trash-alt"})}))},allowFiltering:!1,allowExporting:!1}]}),t.jsxs(H,{modalRef:d,title:P?"Editar página":"Agregar página",onSubmit:A,size:"sm",children:[t.jsx("input",{ref:f,type:"hidden"}),t.jsx(E,{eRef:x,label:"Ruta",col:"col-12",required:!0}),t.jsx(E,{eRef:g,label:"Nombre",col:"col-12",required:!0}),t.jsx(L,{eRef:h,label:"Descripcion",col:"col-12",rows:2}),t.jsxs("div",{className:"d-flex flex-wrap justify-content-start gap-2",children:[t.jsx(v,{eRef:m,label:"Desktop",aspect:16/9,height:"50px",width:"auto",containerStyle:{width:"max-content"},onError:"/api/pages/media/undefined"}),t.jsx(v,{eRef:p,label:"Tablet",aspect:4/3,height:"50px",width:"auto",containerStyle:{width:"max-content"},onError:"/api/pages/media/undefined"}),t.jsx(v,{eRef:u,label:"Mobile",aspect:9/16,height:"50px",width:"auto",containerStyle:{width:"max-content"},onError:"/api/pages/media/undefined"})]})]})]})};z((r,s)=>{O(r).render(t.jsx(V,{...s,title:"Páginas",children:t.jsx(Y,{...s})}))});
