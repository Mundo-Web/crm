var C=Object.defineProperty;var E=(o,i,r)=>i in o?C(o,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[i]=r;var n=(o,i,r)=>E(o,typeof i!="symbol"?i+"":i,r);import{m as c,j as s,G as $}from"./CreateReactScript-DcwmeAVN.js";import{B as N}from"./Adminto-Dn18fT8W.js";import{H as f}from"./HtmlContent-B-JChW0o.js";class y extends N{constructor(){super(...arguments);n(this,"path","clients");n(this,"get",async r=>{try{const{status:e,result:a}=await c.Fetch(`/api/${this.path}/${r}`);if(!e)throw new Error((a==null?void 0:a.message)||"Ocurrio un error inesperado");return a.data}catch(e){return c.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:e.message,type:"danger"}),null}});n(this,"massiveDelete",async r=>{try{const{status:e,result:a}=await c.Fetch(`/api/${this.path}/massive-delete`,{method:"POST",body:JSON.stringify(r)});if(!e)throw new Error((a==null?void 0:a.message)||"Ocurrio un error inesperado");return!0}catch(e){return c.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:e.message,type:"danger"}),!1}})}}n(y,"assign",async(r,e)=>{try{const{status:a,result:t}=await c.Fetch("/api/clients/assign",{method:e?"PUT":"DELETE",body:JSON.stringify({id:r})});if(!a)throw new Error((t==null?void 0:t.message)??"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:t.message,type:"success"}),!0}catch(a){return c.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:a.message,type:"danger"}),!1}}),n(y,"clientStatus",async(r,e)=>{try{const{status:a,result:t}=await c.Fetch("/api/clients/client-status",{method:"PATCH",body:JSON.stringify({client:r,status:e})});if(!a)throw new Error((t==null?void 0:t.message)??"Ocurrio un error inesperado");return c.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:t.message,type:"success"}),!0}catch(a){return c.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:a.message,type:"danger"}),!1}});const k=({id:o,status:i,name:r,description:e,assigned:a,priority:t,type:l,onChange:x,ends_at:m})=>{const d={Pendiente:{icon:"mdi mdi-clock-time-eight-outline",color:"btn-danger"},"En curso":{icon:"mdi mdi-timer-sand",color:"btn-primary"},Realizado:{icon:"mdi mdi-check",color:"btn-success"}},j={Llamada:{icon:"mdi mdi-phone-forward"},Correo:{icon:"mdi mdi-email-send"},"Por hacer":{icon:"mdi mdi-clock-start"}},b={Baja:{color:"bg-light"},Media:{color:"bg-success"},Alta:{color:"bg-warning"},Urgente:{color:"bg-danger"}};return s.jsx("div",{className:"card border border-default mb-1",children:s.jsxs("div",{className:"card-body p-2",children:[s.jsxs("blockquote",{className:"card-bodyquote mb-0",children:[s.jsxs("div",{className:"btn-group mb-1 d-flex justify-content-between align-items-center",children:[s.jsx("div",{children:x?s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:`btn btn-xs ${d[i].color} btn-sm dropdown-toggle`,type:"button","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:[s.jsx("i",{className:d[i].icon})," ",i," ",s.jsx("i",{className:"mdi mdi-chevron-down"})]}),s.jsx("div",{className:"dropdown-menu",children:Object.keys(d).map((h,u)=>s.jsxs("span",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>x(o,h),children:[s.jsx("i",{className:d[h].icon})," ",h]},`status-${u}`))})]}):s.jsxs("span",{className:`btn btn-xs ${d[i].color} btn-sm`,style:{whiteSpace:"nowrap",cursor:"default"},children:[s.jsx("i",{className:d[i].icon})," ",i]})}),s.jsxs("small",{className:"text-muted ms-1",children:["vence ",moment(m).fromNow()]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("span",{className:"badge bg-light text-dark me-1",children:[s.jsx("i",{className:j[l].icon})," ",l]}),s.jsx("span",{className:`badge ${b[t].color}`,children:t})]}),s.jsx("h5",{className:"mt-0",children:r}),e&&s.jsx("small",{children:s.jsx(f,{html:e})})]}),a&&s.jsxs("small",{children:[s.jsx("img",{src:`//${$.APP_DOMAIN}/api/profile/thumbnail/${a.relative_id}`,alt:a.fullname,className:"img-fluid avatar-xs rounded-circle me-1"}),"Asignado a ",s.jsx("b",{children:a.fullname})]})]})})},S=({id:o,type:i,name:r,process:e,description:a,created_at:t,updated_at:l,user_id:x,tasks:m,onTaskChange:d,showOptions:j=!0,session:b,onDeleteNote:h,onUpdateNote:u,status:p,manage_status:g})=>i?s.jsxs("div",{className:"card border border-primary mb-2",children:[r&&s.jsxs("div",{className:"card-header p-2 d-flex justify-content-between align-items-center",children:[s.jsx("h5",{className:"card-title mb-0",children:e?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"mdi mdi-timeline-text me-1"})," ",e," ",s.jsx("small",{className:"text-muted",children:r})]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:`${(i==null?void 0:i.icon)??"mdi mdi-clock"} me-1`})," ",r]})}),j&&x==b.service_user.id&&s.jsxs("div",{className:"dropdown",children:[s.jsx("a",{className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",style:{cursor:"pointer"},children:s.jsx("i",{className:"mdi mdi-dots-vertical"})}),s.jsxs("div",{className:"dropdown-menu dropdown-menu-end",children:[s.jsxs("a",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>u({id:o,type:i,name:r,description:a,tasks:m}),children:[s.jsx("i",{className:"fa fa-pen me-1"}),"Editar"]}),s.jsxs("a",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>h(o),children:[s.jsx("i",{className:"fa fa-trash me-1"}),"Eliminar"]})]})]})]}),s.jsxs("div",{className:"card-body p-2",children:[a&&s.jsx("div",{className:"card-text",children:s.jsx(f,{html:a})}),m.length>0&&m.map((w,v)=>s.jsx(k,{...w,onChange:d},`task-${v}`)),(p||g)&&s.jsxs("div",{className:"d-flex mb-1 gap-1",children:[p&&s.jsx("span",{className:"badge rounded-pill px-1",style:{paddingTop:"4px",backgroundColor:p.color},children:p.name}),g&&s.jsx("span",{className:"badge rounded-pill px-1",style:{paddingTop:"4px",backgroundColor:g.color},children:g.name})]}),s.jsx("p",{className:"card-text",children:s.jsxs("small",{className:"text-muted",children:[moment(t).format("LLL")," ",l!=t&&s.jsxs("span",{children:["· ",s.jsx("i",{children:"Editado"})]})]})})]})]}):s.jsxs("div",{className:"card card-body p-2 mb-2",style:{border:"1px solid #dee2e6"},children:[s.jsxs("p",{className:"card-text mb-0",children:[s.jsx("i",{className:"mdi mdi-clock me-1"}),r]}),s.jsx("p",{className:"card-text",children:s.jsxs("small",{className:"text-muted",children:[moment(t).format("LLL")," ",l!=t&&s.jsxs("span",{children:["· ",s.jsx("i",{children:"Editado"})]})]})})]});class T extends N{constructor(){super(...arguments);n(this,"path","client-notes");n(this,"byClient",async r=>{const{result:e}=await c.Fetch(`/api/${this.path}/client/${r}`);return(e==null?void 0:e.data)??[]})}}class A extends N{constructor(){super(...arguments);n(this,"path","products-by-client");n(this,"byClient",async r=>{const{result:e}=await c.Fetch(`/api/${this.path}/client/${r}`);return(e==null?void 0:e.data)??[]})}}export{y as C,A as P,k as T,T as a,S as b};
