import{r as b,j as a,R as q}from"./CreateReactScript-CgEuCtoy.js";import{r as K}from"./server.browser-DtYOuO13.js";import{l as Q,d as U}from"./default-C8QyGrl1.js";const J=({gridRef:e,rest:n,columns:t,toolBar:r,masterDetail:i,filterValue:c,defaultRows:s,selection:l,allowedPageSizes:w=[5,10,25,50,100],pageSize:h=100,exportable:P,exportableName:p,customizeCell:D=()=>{},reloadWith:S=[null],height:z="calc(100vh - 185px)",keyExpr:F,onSelectionChanged:O})=>(b.useEffect(()=>{var g,N,C;DevExpress.localization.locale(navigator.language),$(e.current).data("dxDataGrid")&&((N=(g=$(e.current))==null?void 0:g.dxDataGrid("instance"))==null||N.dispose()),$(e.current).dxDataGrid({language:"es",dataSource:{load:async m=>{const d=await n.paginate(m)??{};let u=(d==null?void 0:d.data)||[];if(s){const f=s.map(x=>Object.keys(x)),W=u.concat(s.filter(x=>!u.some(v=>f.some(M=>M.every(E=>v[E]==x[E])))));d.data=W}return d}},onToolbarPreparing:m=>{const{items:d}=m.toolbarOptions;r(d)},remoteOperations:!0,columnResizingMode:"widget",allowColumnResizing:!0,allowColumnReordering:!0,columnAutoWidth:!0,scrollbars:"auto",filterPanel:{visible:!1},searchPanel:{visible:!1},headerFilter:{visible:!0,search:{enabled:!0}},height:z,filterValue:c,keyExpr:F,selection:l||null,onSelectionChanged:O,export:{enabled:!1},onExporting:function(m){var d=new ExcelJS.Workbook,u=d.addWorksheet("Main sheet");DevExpress.excelExporter.exportDataGrid({worksheet:u,component:m.component,customizeCell:function(f){D(f),f.excelCell.alignment={horizontal:"left",vertical:"top",...f.excelCell.alignment}}}).then(function(){d.xlsx.writeBuffer().then(function(f){saveAs(new Blob([f],{type:"application/octet-stream"}),`${p}.xlsx`)})})},rowAlternationEnabled:!0,showBorders:!0,filterRow:{visible:!0,applyFilter:"auto"},filterBuilderPopup:{visible:!1,position:{of:window,at:"top",my:"top",offset:{y:10}}},paging:{pageSize:h},pager:{visible:!0,allowedPageSizes:w,showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0},allowFiltering:!0,scrolling:{mode:"standard",useNative:!0,preloadEnabled:!0,rowRenderingMode:"standard"},columnChooser:{title:"Mostrar/Ocultar columnas",enabled:!1,mode:"select",search:{enabled:!0}},columns:t,masterDetail:i,onContentReady:(...m)=>{tippy(".tippy-here",{arrow:!0,animation:"scale"})},onOptionChanged:m=>{if(m.fullName==="filterValue"){const d=location.pathname,u=Local.get("dxSettings")||{};u[d]={filterValue:m.value},Local.set("dxSettings",u)}}}).dxDataGrid("instance"),tippy(".dx-button",{arrow:!0});const k=Local.get("dxSettings")||{};(C=k[location.pathname])!=null&&C.filterValue&&$(e.current).dxDataGrid("instance").option("filterValue",k[location.pathname].filterValue)},S),a.jsx("div",{ref:e})),Z={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},ee=(e,n,t)=>{let r;const i=Z[e];return typeof i=="string"?r=i:n===1?r=i.one:r=i.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"en "+r:"hace "+r:r};function A(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const te={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},ae={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},ne={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},re={date:A({formats:te,defaultWidth:"full"}),time:A({formats:ae,defaultWidth:"full"}),dateTime:A({formats:ne,defaultWidth:"full"})},oe={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},se={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},ie=(e,n,t,r)=>n.getHours()!==1?se[e]:oe[e];function y(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let i;if(r==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,l=t!=null&&t.width?String(t.width):s;i=e.formattingValues[l]||e.formattingValues[s]}else{const s=e.defaultWidth,l=t!=null&&t.width?String(t.width):e.defaultWidth;i=e.values[l]||e.values[s]}const c=e.argumentCallback?e.argumentCallback(n):n;return i[c]}}const de={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},le={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},ce={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},me={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},ue={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},he={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},fe=(e,n)=>Number(e)+"º",be={ordinalNumber:fe,era:y({values:de,defaultWidth:"wide"}),quarter:y({values:le,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:y({values:ce,defaultWidth:"wide"}),day:y({values:me,defaultWidth:"wide"}),dayPeriod:y({values:ue,defaultWidth:"wide",formattingValues:he,defaultFormattingWidth:"wide"})};function pe(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const i=r[0],c=n.match(e.parsePattern);if(!c)return null;let s=e.valueCallback?e.valueCallback(c[0]):c[0];s=t.valueCallback?t.valueCallback(s):s;const l=n.slice(i.length);return{value:s,rest:l}}}function j(e){return(n,t={})=>{const r=t.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],c=n.match(i);if(!c)return null;const s=c[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],w=Array.isArray(l)?ve(l,p=>p.test(s)):xe(l,p=>p.test(s));let h;h=e.valueCallback?e.valueCallback(w):w,h=t.valueCallback?t.valueCallback(h):h;const P=n.slice(s.length);return{value:h,rest:P}}}function xe(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function ve(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}const we=/^(\d+)(º)?/i,ge=/\d+/i,ye={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},je={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},Pe={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},De={any:[/1/i,/2/i,/3/i,/4/i]},ke={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},Ne={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},Ce={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},We={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},Me={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},Ee={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},Se={ordinalNumber:pe({matchPattern:we,parsePattern:ge,valueCallback:function(e){return parseInt(e,10)}}),era:j({matchPatterns:ye,defaultMatchWidth:"wide",parsePatterns:je,defaultParseWidth:"any"}),quarter:j({matchPatterns:Pe,defaultMatchWidth:"wide",parsePatterns:De,defaultParseWidth:"any",valueCallback:e=>e+1}),month:j({matchPatterns:ke,defaultMatchWidth:"wide",parsePatterns:Ne,defaultParseWidth:"any"}),day:j({matchPatterns:Ce,defaultMatchWidth:"wide",parsePatterns:We,defaultParseWidth:"any"}),dayPeriod:j({matchPatterns:Me,defaultMatchWidth:"any",parsePatterns:Ee,defaultParseWidth:"any"})},ze={code:"es",formatDistance:ee,formatLong:re,formatRelative:ie,localize:be,match:Se,options:{weekStartsOn:1,firstWeekContainsDate:1}},Ge=({title:e,gridRef:n,rest:t,columns:r,toolBar:i,masterDetail:c,filterValue:s=[],defaultRows:l,selection:w,className:h="",allowedPageSizes:P,pageSize:p,exportable:D=!1,customizeCell:S,reloadWith:z,height:F,cardStyle:O,keyExpr:k,onSelectionChanged:g,massiveActions:N})=>{const C=K(a.jsx("div",{children:e})),m=$(C).text().trim().replace("-",""),[d,u]=b.useState([{startDate:new Date,endDate:new Date,key:"selection"}]),[f,W]=b.useState(!1),[x,v]=b.useState(!1),[M,E]=b.useState(0),T=b.useRef(null);`${crypto.randomUUID()}`;const[V,G]=b.useState(!1),X=b.useCallback(Q.debounce(o=>{$(n.current).dxDataGrid("instance").searchByText(o)},500),[n]),B=()=>{const{startDate:o,endDate:L}=d[0];if(!o||!L)return;const I=new Date(o);I.setHours(-5,0,0,0);const R=new Date(L);R.setHours(18,59,59,999),$(n.current).dxDataGrid("instance").filter([["created_at",">=",I],"and",["created_at","<=",R]]),W(!0),v(!1)},_=()=>{$(n.current).dxDataGrid("instance").clearFilter(),u([{startDate:new Date,endDate:new Date,key:"selection"}]),W(!1),v(!1)},Y=()=>{const o=$(n.current).dxDataGrid("instance");o.exportToExcel&&o.exportToExcel(!1),o._options.onExporting&&o._options.onExporting({component:o.current})},H=o=>{T.current&&!T.current.contains(o.target)&&v(!1)};return q.useEffect(()=>(document.addEventListener("mousedown",H),()=>{document.removeEventListener("mousedown",H)}),[]),a.jsx("div",{className:`row ${h}`,children:a.jsx("div",{className:"col-12",children:a.jsx("div",{className:"card",style:O,children:a.jsxs("div",{className:"card-body",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[typeof e=="string"?a.jsxs("h4",{className:"w-100 my-0 header-title",children:["Lista de ",e]}):a.jsx("div",{className:"w-100 my-0",children:e}),a.jsxs("button",{className:"btn btn-white btn-xs text-nowrap",onClick:()=>$(n.current).dxDataGrid("instance").refresh(),children:[a.jsx("i",{className:"mdi mdi-refresh me-1"}),"Actualizar"]})]}),a.jsxs("div",{className:"d-flex mb-2 gap-2",children:[a.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Buscar...",onChange:o=>X(o.target.value)}),a.jsxs("div",{className:"d-flex gap-2",children:[M>0&&a.jsxs("div",{className:"dropdown position-relative",children:[a.jsxs("button",{className:"btn btn-white btn-sm dropdown-toggle position-relative bg-white",type:"button",onClick:()=>G(!V),style:{zIndex:V?1e4:void 0},children:[a.jsx("i",{className:"mdi mdi-format-list-checks me-1"}),"Acciones",a.jsx("span",{className:"badge bg-primary ms-1",children:M}),a.jsx("i",{className:"mdi mdi-chevron-down ms-1"})]}),V&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"position-fixed",style:{top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999},onClick:()=>G(!1)}),a.jsx("ul",{className:"dropdown-menu dropdown-menu-end show",style:{position:"absolute",zIndex:1e4},onClick:()=>G(!1),children:N})]})]}),a.jsxs("div",{className:"dropdown position-relative",ref:T,children:[a.jsxs("button",{className:"position-relative btn btn-sm btn-white dropdown-toggle bg-white",onClick:()=>v(!x),style:{zIndex:x?1e4:void 0},children:[a.jsx("i",{className:"mdi mdi-calendar-range me-1"}),"Periodo",f&&a.jsx("span",{className:"ms-1 badge bg-primary",children:a.jsx("i",{className:"mdi mdi-filter"})})]}),x&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"position-fixed",style:{top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999},onClick:()=>v(!1)}),a.jsxs("div",{className:"dropdown-menu p-2 show mt-1",style:{minWidth:"650px",position:"absolute",right:0,transform:"translateX(0)",zIndex:1e4},children:[a.jsx(U.DateRange,{editableDateInputs:!0,onChange:o=>u([o.selection]),moveRangeOnFirstSelection:!1,ranges:d,locale:ze,months:2,direction:"horizontal",showDateDisplay:!1}),a.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-2",children:[a.jsxs("button",{className:"btn btn-sm btn-danger",onClick:_,children:[a.jsx("i",{className:"mdi mdi-filter-remove me-1"}),"Limpiar"]}),a.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>B(),children:[a.jsx("i",{className:"mdi mdi-filter me-1"}),"Filtrar"]})]})]})]})]}),a.jsxs("button",{className:"btn btn-sm btn-white text-nowrap",onClick:Y,disabled:!D,children:[a.jsx("i",{className:"mdi mdi-download me-1"}),"Exportar"]})]})]}),a.jsx(J,{gridRef:n,rest:t,columns:r.filter(Boolean),toolBar:i,masterDetail:c,filterValue:s,defaultRows:l,selection:w,allowedPageSizes:P,pageSize:p,exportable:D,exportableName:m.toLowerCase(),customizeCell:S,reloadWith:z,height:F,keyExpr:k,onSelectionChanged:o=>{E(o.selectedRowKeys.length),g==null||g(o)}})]})})})})};export{Ge as T};
