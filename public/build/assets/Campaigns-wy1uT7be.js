var w=Object.defineProperty;var F=(n,t,s)=>t in n?w(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var R=(n,t,s)=>F(n,typeof t!="symbol"?t+"":t,s);import{C as k,c as y,j as r,r as o}from"./CreateReactScript-DcwmeAVN.js";import{B,A as S}from"./Adminto-D0ZUZ42-.js";import{M as D}from"./Modal-C2Wyq7YS.js";import{T as N}from"./Table-CVEiUzZj.js";import{I as p}from"./InputFormGroup-Ba-Teh2n.js";import{T as A}from"./TextareaFormGroup-BKpwC6cY.js";import{S as G}from"./SelectFormGroup-Csb1tKiR.js";import{S as q}from"./sweetalert2.esm.all-BB4SRWjP.js";import{D as b}from"./DxPanelButton-Ba-9tjk6.js";import{D as h}from"./DxButton-CsjWvhyj.js";import{s as v}from"./socials-DxbJIEf3.js";import"./Logout-CMhpjQt5.js";import"./server.browser-brRkNDR6.js";import"./default-P54wx-21.js";import"./index-0LxMiNUP.js";class M extends B{constructor(){super(...arguments);R(this,"path","campaigns")}}const d=new M,I=({can:n})=>{const t=o.useRef(),s=o.useRef(),i=o.useRef(),a=o.useRef(),c=o.useRef(),u=o.useRef(),m=o.useRef(),f=o.useRef(),[C,x]=o.useState(!1),g=e=>{e!=null&&e.id?x(!0):x(!1),i.current.value=(e==null?void 0:e.id)||null,a.current.value=(e==null?void 0:e.code)||null,$(c.current).val((e==null?void 0:e.source)||null).trigger("change"),u.current.value=(e==null?void 0:e.title)||null,m.current.value=(e==null?void 0:e.link)||null,f.current.value=(e==null?void 0:e.notes)||null,$(s.current).modal("show")},j=async e=>{e.preventDefault();const l={id:i.current.value||void 0,code:a.current.value,source:$(c.current).val(),title:u.current.value,link:m.current.value,notes:f.current.value};await d.save(l)&&($(t.current).dxDataGrid("instance").refresh(),$(s.current).modal("hide"))},T=async e=>{const{isConfirmed:l}=await q.fire({title:"Eliminar campaña",text:"¿Está seguro de eliminar esta campaña?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"Cancelar"});!l||!await d.delete(e)||$(t.current).dxDataGrid("instance").refresh()};return r.jsxs(r.Fragment,{children:[r.jsx(N,{gridRef:t,title:"Campaña",rest:d,toolBar:e=>{e.unshift(b({className:"btn btn-xs btn-soft-dark",text:"Actualizar",title:"Refrescar tabla",icon:"fas fa-undo-alt",onClick:()=>$(t.current).dxDataGrid("instance").refresh()})),n("campaigns","all","create")&&e.unshift(b({className:"btn btn-xs btn-soft-primary",text:"Nuevo",title:"Agregar registro",icon:"fa fa-plus",onClick:()=>g()}))},columns:[{dataField:"code",caption:"Código",dataType:"string",cssClass:"font-monospace"},{dataField:"source",caption:"Fuente",dataType:"string",lookup:{dataSource:v,valueExpr:"id",displayExpr:"label"}},{dataField:"title",caption:"Título",dataType:"string"},{dataField:"link",caption:"Enlace",dataType:"string"},{dataField:"notes",caption:"Notas",dataType:"string"},{caption:"Acciones",cellTemplate:(e,{data:l})=>{n("campaigns","root","all","update")&&e.append(h({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>g(l)})),n("campaigns","root","all","delete")&&e.append(h({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash-alt",onClick:()=>T(l.id)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsx(D,{modalRef:s,title:C?"Editar campaña":"Agregar campaña",onSubmit:j,children:r.jsxs("div",{className:"row",id:"campaign-form",children:[r.jsx("input",{ref:i,type:"hidden"}),r.jsx(p,{eRef:a,label:"Código",col:"col-12",required:!0}),r.jsx(G,{eRef:c,label:"Fuente",col:"col-12",required:!0,dropdownParent:"#campaign-form",children:v.map(e=>r.jsx("option",{value:e.id,children:e.label},e.id))}),r.jsx(p,{eRef:u,label:"Título",col:"col-12",required:!0}),r.jsx(p,{eRef:m,label:"Enlace",col:"col-12"}),r.jsx(A,{eRef:f,label:"Notas",col:"col-12"})]})})]})};k((n,t)=>{if(!t.can("campaigns","root","all","list"))return location.href="/";y(n).render(r.jsx(S,{...t,title:"Campañas",showTitle:!1,children:r.jsx(I,{...t})}))});
