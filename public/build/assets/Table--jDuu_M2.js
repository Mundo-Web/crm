import{r as v,j as n,R as A}from"./CreateReactScript-Ci2gSFYl.js";import{r as R}from"./server.browser-Bt6ZiyRW.js";import{l as X,d as B}from"./default-D2g-YKbc.js";const I=({gridRef:e,rest:a,columns:t,toolBar:r,masterDetail:s,filterValue:c,defaultRows:o,selection:l,allowedPageSizes:x=[5,10,25,50,100],pageSize:h=100,exportable:P,exportableName:p,customizeCell:D=()=>{},reloadWith:E=[null],height:S="calc(100vh - 185px)"})=>(v.useEffect(()=>{var W,C,N;DevExpress.localization.locale(navigator.language),$(e.current).data("dxDataGrid")&&((C=(W=$(e.current))==null?void 0:W.dxDataGrid("instance"))==null||C.dispose()),$(e.current).dxDataGrid({language:"es",dataSource:{load:async m=>{const d=await a.paginate(m)??{};let f=(d==null?void 0:d.data)||[];if(o){const u=o.map(b=>Object.keys(b)),g=f.concat(o.filter(b=>!f.some(w=>u.some(z=>z.every(M=>w[M]==b[M])))));d.data=g}return d}},onToolbarPreparing:m=>{const{items:d}=m.toolbarOptions;r(d)},remoteOperations:!0,columnResizingMode:"widget",allowColumnResizing:!0,allowColumnReordering:!0,columnAutoWidth:!0,scrollbars:"auto",filterPanel:{visible:!1},searchPanel:{visible:!1},headerFilter:{visible:!0,search:{enabled:!0}},height:S,filterValue:c,selection:l||null,export:{enabled:!1},onExporting:function(m){var d=new ExcelJS.Workbook,f=d.addWorksheet("Main sheet");DevExpress.excelExporter.exportDataGrid({worksheet:f,component:m.component,customizeCell:function(u){D(u),u.excelCell.alignment={horizontal:"left",vertical:"top",...u.excelCell.alignment}}}).then(function(){d.xlsx.writeBuffer().then(function(u){saveAs(new Blob([u],{type:"application/octet-stream"}),`${p}.xlsx`)})})},rowAlternationEnabled:!0,showBorders:!0,filterRow:{visible:!0,applyFilter:"auto"},filterBuilderPopup:{visible:!1,position:{of:window,at:"top",my:"top",offset:{y:10}}},paging:{pageSize:h},pager:{visible:!0,allowedPageSizes:x,showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0},allowFiltering:!0,scrolling:{mode:"standard",useNative:!0,preloadEnabled:!0,rowRenderingMode:"standard"},columnChooser:{title:"Mostrar/Ocultar columnas",enabled:!1,mode:"select",search:{enabled:!0}},columns:t,masterDetail:s,onContentReady:(...m)=>{tippy(".tippy-here",{arrow:!0,animation:"scale"})},onOptionChanged:m=>{if(m.fullName==="filterValue"){const d=location.pathname,f=Local.get("dxSettings")||{};f[d]={filterValue:m.value},Local.set("dxSettings",f)}}}).dxDataGrid("instance"),tippy(".dx-button",{arrow:!0});const k=Local.get("dxSettings")||{};(N=k[location.pathname])!=null&&N.filterValue&&$(e.current).dxDataGrid("instance").option("filterValue",k[location.pathname].filterValue)},E),n.jsx("div",{ref:e})),_={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},Y=(e,a,t)=>{let r;const s=_[e];return typeof s=="string"?r=s:a===1?r=s.one:r=s.other.replace("{{count}}",a.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"en "+r:"hace "+r:r};function T(e){return(a={})=>{const t=a.width?String(a.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const q={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},K={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Q={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},J={date:T({formats:q,defaultWidth:"full"}),time:T({formats:K,defaultWidth:"full"}),dateTime:T({formats:Q,defaultWidth:"full"})},U={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},Z={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},ee=(e,a,t,r)=>a.getHours()!==1?Z[e]:U[e];function y(e){return(a,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=t!=null&&t.width?String(t.width):o;s=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=t!=null&&t.width?String(t.width):e.defaultWidth;s=e.values[l]||e.values[o]}const c=e.argumentCallback?e.argumentCallback(a):a;return s[c]}}const te={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},ae={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},ne={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},re={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},oe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},ie={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},se=(e,a)=>Number(e)+"º",de={ordinalNumber:se,era:y({values:te,defaultWidth:"wide"}),quarter:y({values:ae,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:y({values:ne,defaultWidth:"wide"}),day:y({values:re,defaultWidth:"wide"}),dayPeriod:y({values:oe,defaultWidth:"wide",formattingValues:ie,defaultFormattingWidth:"wide"})};function le(e){return(a,t={})=>{const r=a.match(e.matchPattern);if(!r)return null;const s=r[0],c=a.match(e.parsePattern);if(!c)return null;let o=e.valueCallback?e.valueCallback(c[0]):c[0];o=t.valueCallback?t.valueCallback(o):o;const l=a.slice(s.length);return{value:o,rest:l}}}function j(e){return(a,t={})=>{const r=t.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],c=a.match(s);if(!c)return null;const o=c[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],x=Array.isArray(l)?me(l,p=>p.test(o)):ce(l,p=>p.test(o));let h;h=e.valueCallback?e.valueCallback(x):x,h=t.valueCallback?t.valueCallback(h):h;const P=a.slice(o.length);return{value:h,rest:P}}}function ce(e,a){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&a(e[t]))return t}function me(e,a){for(let t=0;t<e.length;t++)if(a(e[t]))return t}const ue=/^(\d+)(º)?/i,he=/\d+/i,fe={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},be={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},pe={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},xe={any:[/1/i,/2/i,/3/i,/4/i]},ve={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},ge={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},we={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},ye={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},je={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},Pe={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},De={ordinalNumber:le({matchPattern:ue,parsePattern:he,valueCallback:function(e){return parseInt(e,10)}}),era:j({matchPatterns:fe,defaultMatchWidth:"wide",parsePatterns:be,defaultParseWidth:"any"}),quarter:j({matchPatterns:pe,defaultMatchWidth:"wide",parsePatterns:xe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:j({matchPatterns:ve,defaultMatchWidth:"wide",parsePatterns:ge,defaultParseWidth:"any"}),day:j({matchPatterns:we,defaultMatchWidth:"wide",parsePatterns:ye,defaultParseWidth:"any"}),dayPeriod:j({matchPatterns:je,defaultMatchWidth:"any",parsePatterns:Pe,defaultParseWidth:"any"})},ke={code:"es",formatDistance:Y,formatLong:J,formatRelative:ee,localize:de,match:De,options:{weekStartsOn:1,firstWeekContainsDate:1}},Ee=({title:e,gridRef:a,rest:t,columns:r,toolBar:s,masterDetail:c,filterValue:o=[],defaultRows:l,selection:x,className:h="",allowedPageSizes:P,pageSize:p,exportable:D=!1,customizeCell:E,reloadWith:S,height:k,cardStyle:W})=>{const C=R(n.jsx("div",{children:e})),N=$(C).text().trim().replace("-",""),[m,d]=v.useState([{startDate:new Date,endDate:new Date,key:"selection"}]),[f,u]=v.useState(!1),[g,b]=v.useState(!1),w=v.useRef(null),z=v.useCallback(X.debounce(i=>{$(a.current).dxDataGrid("instance").searchByText(i)},500),[a]),M=()=>{const{startDate:i,endDate:F}=m[0];if(!i||!F)return;const G=new Date(i);G.setHours(-5,0,0,0);const L=new Date(F);L.setHours(18,59,59,999),$(a.current).dxDataGrid("instance").filter([["created_at",">=",G],"and",["created_at","<=",L]]),u(!0),b(!1)},O=()=>{$(a.current).dxDataGrid("instance").clearFilter(),d([{startDate:new Date,endDate:new Date,key:"selection"}]),u(!1),b(!1)},H=()=>{const i=$(a.current).dxDataGrid("instance");i.exportToExcel&&i.exportToExcel(!1),i._options.onExporting&&i._options.onExporting({component:i.current})},V=i=>{w.current&&!w.current.contains(i.target)&&b(!1)};return A.useEffect(()=>(document.addEventListener("mousedown",V),()=>{document.removeEventListener("mousedown",V)}),[]),n.jsx("div",{className:`row ${h}`,children:n.jsx("div",{className:"col-12",children:n.jsx("div",{className:"card",style:W,children:n.jsxs("div",{className:"card-body",children:[typeof e=="string"?n.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[n.jsxs("h4",{className:"header-title w-100 my-0",children:["Lista de ",e]}),n.jsxs("button",{className:"btn btn-white btn-xs text-nowrap",onClick:()=>$(a.current).dxDataGrid("instance").refresh(),children:[n.jsx("i",{className:"mdi mdi-refresh me-1"}),"Actualizar"]})]}):n.jsx("div",{className:"card-header",children:e}),n.jsxs("div",{className:"d-flex mb-2 gap-2",children:[n.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Buscar...",onChange:i=>z(i.target.value)}),n.jsxs("div",{className:"d-flex gap-2",children:[n.jsxs("div",{className:"dropdown position-relative",ref:w,children:[n.jsxs("button",{className:"position-relative btn btn-sm btn-white dropdown-toggle bg-white",onClick:()=>b(!g),style:{zIndex:g?1e4:void 0},children:[n.jsx("i",{className:"mdi mdi-calendar-range me-1"}),"Periodo",f&&n.jsx("span",{className:"ms-1 badge bg-primary",children:n.jsx("i",{className:"mdi mdi-filter"})})]}),g&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"position-fixed",style:{top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999},onClick:()=>b(!1)}),n.jsxs("div",{className:"dropdown-menu p-2 show mt-1",style:{minWidth:"650px",position:"absolute",right:0,transform:"translateX(0)",zIndex:1e4},children:[n.jsx(B.DateRange,{editableDateInputs:!0,onChange:i=>d([i.selection]),moveRangeOnFirstSelection:!1,ranges:m,locale:ke,months:2,direction:"horizontal",showDateDisplay:!1}),n.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-2",children:[n.jsxs("button",{className:"btn btn-sm btn-danger",onClick:O,children:[n.jsx("i",{className:"mdi mdi-filter-remove me-1"}),"Limpiar"]}),n.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>M(),children:[n.jsx("i",{className:"mdi mdi-filter me-1"}),"Filtrar"]})]})]})]})]}),n.jsxs("button",{className:"btn btn-sm btn-white text-nowrap",onClick:H,disabled:!D,children:[n.jsx("i",{className:"mdi mdi-download me-1"}),"Exportar"]})]})]}),n.jsx(I,{gridRef:a,rest:t,columns:r.filter(Boolean),toolBar:s,masterDetail:c,filterValue:o,defaultRows:l,selection:x,allowedPageSizes:P,pageSize:p,exportable:D,exportableName:N.toLowerCase(),customizeCell:E,reloadWith:S,height:k})]})})})})};export{Ee as T};
