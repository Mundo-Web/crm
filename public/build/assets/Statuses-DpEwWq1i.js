import{C as S,c as C,j as s,r as n}from"./CreateReactScript-DcwmeAVN.js";import{a as E,S as I}from"./SetSelectValue-Njwhrlc_.js";import{S as k}from"./StatusesRest-BoWk9HM9.js";import{A}from"./Adminto-D0ZUZ42-.js";import{M as T}from"./Modal-C2Wyq7YS.js";import{I as v}from"./InputFormGroup-Ba-Teh2n.js";import{T as q}from"./TextareaFormGroup-BKpwC6cY.js";import{S as B}from"./sweetalert2.esm.all-BB4SRWjP.js";import"./Logout-CMhpjQt5.js";const N=new k,F=({statuses:c,tables:i})=>{const[b,a]=n.useState(c);n.useRef();const u=n.useRef(),d=n.useRef(),l=n.useRef(),m=n.useRef(),p=n.useRef(),f=n.useRef(),[R,j]=n.useState(!1),[G,M]=n.useState(null),x=e=>{var o,r,t;e!=null&&e.id?j(!0):j(!1),d.current.value=(e==null?void 0:e.id)||null,I(l.current,(o=e==null?void 0:e.table)==null?void 0:o.id,(r=e==null?void 0:e.table)==null?void 0:r.name),(t=e==null?void 0:e.table)!=null&&t.id?$(l.current).parents(".form-group").hide():$(l.current).parents(".form-group").show(),m.current.value=(e==null?void 0:e.name)||null,p.current.value=(e==null?void 0:e.color)||"#343a40",f.current.value=(e==null?void 0:e.description)||null,$(u.current).modal("show")},w=async e=>{e.preventDefault();const o={id:d.current.value||void 0,table_id:l.current.value,name:m.current.value,color:p.current.value,description:f.current.value},r=await N.save(o);r&&(b.find(t=>t.id==r.id)?a(t=>{const h=t.findIndex(y=>y.id==r.id);return t[h]=r,[...t]}):a(t=>[...t,r]),$(u.current).modal("hide"))},g=async e=>{const{isConfirmed:o}=await B.fire({title:"Estas seguro de eliminar este estado?",text:"No podras revertir esta accion!",icon:"warning",showCancelButton:!0,confirmButtonText:"Continuar",cancelButtonText:"Cancelar"});!o||!await N.delete(e)||a(t=>[...t.filter(h=>h.id!=e)])};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"container",children:[s.jsx("div",{className:"text-center",children:s.jsx("button",{className:"btn btn-primary mb-4 rounded-pill",onClick:()=>x(),children:"Nuevo Estado"})}),s.jsx("div",{className:"row align-items-start justify-content-center",children:i.map((e,o)=>s.jsx("div",{className:"col-md-6",children:s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[s.jsxs("h5",{className:"my-0 text-capitalize",children:["Estados de ",e.name]}),s.jsx("button",{className:"btn btn-xs btn-primary rounded-pill",onClick:()=>x({table:e}),children:"Nuevo estado"})]})}),s.jsx("div",{className:"card-body d-flex align-items-start justify-content-center gap-2",style:{flexWrap:"wrap",minHeight:"200px"},children:b.filter(r=>r.table_id===e.id).map((r,t)=>s.jsxs("div",{className:"btn-group dropup col-auto",children:[s.jsxs("span",{type:"button",className:"btn btn-sm btn-white",style:{cursor:"default"},children:[s.jsx("i",{className:"mdi mdi-circle me-1",style:{color:r.color}}),r.name]}),s.jsx("button",{type:"button",className:"btn btn-sm btn-white dropdown-toggle","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:s.jsx("i",{className:"mdi mdi-dots-vertical"})}),s.jsxs("div",{className:"dropdown-menu",children:[s.jsx("span",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>x(r),children:"Editar"}),s.jsx("span",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>g(r.id),children:"Eliminar"})]})]},t))})]})},o))})]}),s.jsx(T,{modalRef:u,title:R?"Editar estado":"Agregar estado",onSubmit:w,size:"sm",children:s.jsxs("div",{className:"row",id:"status-crud-container",children:[s.jsx("input",{ref:d,type:"hidden"}),s.jsx(v,{eRef:m,label:"Nombre de estado",col:"col-12",required:!0}),s.jsx(E,{eRef:l,label:"Tabla",col:"col-12",dropdownParent:"#status-crud-container",searchAPI:"/api/tables/paginate",searchBy:"name",required:!0}),s.jsx(v,{eRef:p,type:"color",label:"Color",col:"col-12",required:!0}),s.jsx(q,{eRef:f,label:"Descripcion",col:"col-12"})]})})]})};S((c,i)=>{if(!i.can("statuses","root","all","list"))return location.href="/";C(c).render(s.jsx(A,{...i,title:"Gestor de estados",children:s.jsx(F,{...i})}))});
