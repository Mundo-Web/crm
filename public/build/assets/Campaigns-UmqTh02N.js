var j=Object.defineProperty;var F=(n,t,i)=>t in n?j(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var x=(n,t,i)=>F(n,typeof t!="symbol"?t+"":t,i);import{C as y,c as E,j as l,r}from"./CreateReactScript-ByDl3m9l.js";import{B,A as D}from"./Adminto-C2cfOxEo.js";import{M as S}from"./Modal-CJxY9cBG.js";import{T as N}from"./Table-C02PdTh3.js";import{I as f}from"./InputFormGroup-DtEJO489.js";import{T as A}from"./TextareaFormGroup-DELmltYl.js";import{S as G}from"./SelectFormGroup-CLE8XJj3.js";import{S as M}from"./sweetalert2.esm.all-C32wHI3n.js";import{D as R}from"./DxPanelButton-Bfx2Xjlg.js";import{D as h}from"./DxButton-CsjWvhyj.js";import"./Logout-DquunmIv.js";import"./server.browser-CMbz63Ok.js";import"./default-BbN4y6Mb.js";import"./index-D_o9jIE1.js";class I extends B{constructor(){super(...arguments);x(this,"path","campaigns")}}const p=new I,q=({can:n})=>{const t=r.useRef(),i=r.useRef(),o=r.useRef(),s=r.useRef(),c=r.useRef(),u=r.useRef(),m=r.useRef(),d=r.useRef(),[k,b]=r.useState(!1),C=[{id:"facebook",label:"Facebook"},{id:"youtube",label:"YouTube"},{id:"instagram",label:"Instagram"},{id:"whatsapp",label:"WhatsApp"},{id:"tiktok",label:"TikTok"},{id:"wechat",label:"WeChat"},{id:"telegram",label:"Telegram"},{id:"messenger",label:"Facebook Messenger"},{id:"snapchat",label:"Snapchat"},{id:"x",label:"X (Twitter)"},{id:"mastodon",label:"Mastodon"},{id:"douyin",label:"Douyin"},{id:"kuaishou",label:"Kuaishou"},{id:"reddit",label:"Reddit"},{id:"pinterest",label:"Pinterest"},{id:"linkedin",label:"LinkedIn"},{id:"landing",label:"Landing Page"}],g=e=>{e!=null&&e.id?b(!0):b(!1),o.current.value=(e==null?void 0:e.id)||null,s.current.value=(e==null?void 0:e.code)||null,$(c.current).val((e==null?void 0:e.source)||null).trigger("change"),u.current.value=(e==null?void 0:e.title)||null,m.current.value=(e==null?void 0:e.link)||null,d.current.value=(e==null?void 0:e.notes)||null,$(i.current).modal("show")},T=async e=>{e.preventDefault();const a={id:o.current.value||void 0,code:s.current.value,source:$(c.current).val(),title:u.current.value,link:m.current.value,notes:d.current.value};await p.save(a)&&($(t.current).dxDataGrid("instance").refresh(),$(i.current).modal("hide"))},v=async e=>{const{isConfirmed:a}=await M.fire({title:"Eliminar campaña",text:"¿Está seguro de eliminar esta campaña?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"Cancelar"});!a||!await p.delete(e)||$(t.current).dxDataGrid("instance").refresh()};return l.jsxs(l.Fragment,{children:[l.jsx(N,{gridRef:t,title:"Campaña",rest:p,toolBar:e=>{e.unshift(R({className:"btn btn-xs btn-soft-dark",text:"Actualizar",title:"Refrescar tabla",icon:"fas fa-undo-alt",onClick:()=>$(t.current).dxDataGrid("instance").refresh()})),n("campaigns","all","create")&&e.unshift(R({className:"btn btn-xs btn-soft-primary",text:"Nuevo",title:"Agregar registro",icon:"fa fa-plus",onClick:()=>g()}))},columns:[{dataField:"code",caption:"Código",dataType:"string",cssClass:"font-monospace"},{dataField:"source",caption:"Fuente",dataType:"string"},{dataField:"title",caption:"Título",dataType:"string"},{dataField:"link",caption:"Enlace",dataType:"string"},{dataField:"notes",caption:"Notas",dataType:"string"},{caption:"Acciones",cellTemplate:(e,{data:a})=>{n("campaigns","root","all","update")&&e.append(h({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>g(a)})),n("campaigns","root","all","delete")&&e.append(h({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash-alt",onClick:()=>v(a.id)}))},allowFiltering:!1,allowExporting:!1}]}),l.jsx(S,{modalRef:i,title:k?"Editar campaña":"Agregar campaña",onSubmit:T,children:l.jsxs("div",{className:"row",id:"campaign-form",children:[l.jsx("input",{ref:o,type:"hidden"}),l.jsx(f,{eRef:s,label:"Código",col:"col-12",required:!0}),l.jsx(G,{eRef:c,label:"Fuente",col:"col-12",required:!0,dropdownParent:"#campaign-form",children:C.map(e=>l.jsx("option",{value:e.id,children:e.label},e.id))}),l.jsx(f,{eRef:u,label:"Título",col:"col-12",required:!0}),l.jsx(f,{eRef:m,label:"Enlace",col:"col-12"}),l.jsx(A,{eRef:d,label:"Notas",col:"col-12"})]})})]})};y((n,t)=>{if(!t.can("campaigns","root","all","list"))return location.href="/";E(n).render(l.jsx(D,{...t,title:"Campañas",showTitle:!1,children:l.jsx(q,{...t})}))});
