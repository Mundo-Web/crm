import{C as y,c as g,j as s,r as t,G as v}from"./CreateReactScript-DEiMbi6B.js";import{A as N,u as w}from"./Adminto-BubVNbfu.js";import"./Logout-DAQhHADr.js";import"./sweetalert2.esm.all-B5d0Dmk7.js";const E=({session:r,messages:n=[],waDummy:l})=>{const d=l?l.split(",").map(e=>e.trim()):[],[m,u]=t.useState(n),[a,p]=t.useState(""),[o,b]=t.useState(d[0]||""),{socket:c}=w({}),h=t.useRef(null),f=[...m].sort((e,i)=>e.microtime-i.microtime),x=async()=>{if(a.trim())try{await fetch(`${v.APP_URL}/meta/evoapi/${r.business_uuid}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:{pushName:"Dummy",key:{fromMe:!1,remoteJid:`${o}@s.whatsapp.net`},messageType:"conversation",message:{conversation:a.trim()}}})}),p("")}catch(e){console.error("Error sending message:",e)}};return t.useEffect(()=>{u(n)},[n]),t.useEffect(()=>{var e;(e=h.current)==null||e.scrollIntoView({behavior:"smooth"})},[m]),t.useEffect(()=>{const e=i=>{u(j=>[...j,i])};return c.on("message.created",e),()=>{c.off("message.created",e)}},[c,o]),s.jsx("div",{className:"container d-flex justify-content-center align-items-center ",style:{minHeight:"calc(100vh - 200px)"},children:s.jsx("div",{className:"col-xl-4 col-lg-6 col-md-8 col-sm-10 col-12",children:s.jsxs("div",{className:"card shadow-sm",children:[s.jsxs("div",{className:"card-header bg-primary text-white d-flex justify-content-between align-items-center",children:[s.jsx("h5",{className:"mb-0",children:"Chat"}),s.jsxs("div",{className:"dropdown",children:[s.jsx("button",{className:"btn btn-sm btn-outline-light border-0 dropdown-toggle",type:"button",id:"numberDropdown","data-bs-toggle":"dropdown","aria-expanded":"false",children:o}),s.jsx("ul",{className:"dropdown-menu dropdown-menu-end","aria-labelledby":"numberDropdown",children:d.map(e=>s.jsx("li",{children:s.jsx("button",{className:"dropdown-item",type:"button",onClick:()=>b(e),children:e})},e))})]})]}),s.jsxs("div",{className:"card-body p-0 d-flex flex-column",style:{height:"600px"},children:[s.jsxs("div",{className:"flex-fill overflow-auto p-3 bg-light",children:[f.map(e=>s.jsx("div",{className:`d-flex mb-2 ${e.role==="Human"?"justify-content-end":"justify-content-start"}`,children:s.jsx("div",{className:`px-3 py-2 rounded shadow-sm ${e.role==="Human"?"bg-primary text-white":"bg-white text-dark border"}`,style:{maxWidth:"75%",whiteSpace:"pre-line"},children:e.message})},e.id)),s.jsx("div",{ref:h})]}),s.jsxs("div",{className:"input-group p-2 border-top",children:[s.jsx("input",{type:"text",className:"form-control form-control-sm",value:a,onChange:e=>p(e.target.value),onKeyDown:e=>e.key==="Enter"&&x(),placeholder:"Escribe un mensaje..."}),s.jsx("button",{className:"btn btn-primary btn-sm",onClick:x,children:"Enviar"})]})]})]})})})};y((r,n)=>{g(r).render(s.jsx(N,{...n,title:"Simple Chat",children:s.jsx(E,{...n})}))});
