import{C as f,c as y,R as e,r as i}from"./CreateReactScript-CiSpie-0.js";import{A as g,i as N}from"./Adminto-B_6p9P5E.js";import{P as p,D as _,A as w}from"./DateRange-CH1B7DzJ.js";import"./server.browser-DwjXelOo.js";const k=({})=>{const[o,m]=i.useState([]),[b,E]=i.useState(!1),[r,c]=i.useState("all");i.useEffect(()=>{p.paginate({sort:[{selector:"ends_at",desc:!1}],requireTotalCount:!0,skip:0,take:100}).then(({data:t=[]})=>{m(t)})},[null]);const u=()=>{const t=moment(),a={delayed:[],thisMonth:[],future:{}};return o.forEach(l=>{const s=moment(l.ends_at);if(s.isSame(t,"month")&&s.isSame(t,"year"))a.thisMonth.push(l);else if(s.isBefore(t,"day"))a.delayed.push(l);else{const n=s.format("MMMM YYYY");a.future[n]||(a.future[n]=[]),a.future[n].push(l)}}),a},h=t=>{const a=t??r,l=moment();let s=o;switch(b&&(s=s.filter(n=>Number(n.remaining_amount)>0)),a){case"delayed":return s.filter(n=>moment(n.ends_at).isBefore(l,"day"));case"thisMonth":return s.filter(n=>{const d=moment(n.ends_at);return d.isSame(l,"month")&&d.isSame(l,"year")});default:if(a.startsWith("month_")){const n=a.replace("month_","");return s.filter(d=>moment(d.ends_at).format("MMMM YYYY")===n)}return s}};return e.createElement(e.Fragment,null,e.createElement("div",{className:"row"},e.createElement("div",{className:"col-12"},e.createElement("div",{className:"card"},e.createElement("div",{className:"card-header"},e.createElement("div",{className:"dropdown float-end"},e.createElement(N,{content:"Ver proyectos",arrow:!0},e.createElement("a",{href:"/projects",className:"arrow-none card-drop"},e.createElement("i",{className:"mdi mdi-arrow-top-right"})))),e.createElement("h4",{className:"header-title mt-0 mb-0"},"Proyectos pendientes"),e.createElement("div",{className:"mt-2 d-flex gap-1 flex-wrap"},u().delayed.length>0&&e.createElement("button",{className:`btn btn-xs ${r==="delayed"?"btn-danger":"btn-soft-danger"}`,onClick:()=>c("delayed")},"Atrasados (",h("delayed").length,")"),u().thisMonth.length>0&&e.createElement("button",{className:`btn btn-xs ${r==="thisMonth"?"btn-primary":"btn-soft-primary"}`,onClick:()=>c("thisMonth")},"Este mes (",h("thisMonth").length,")"),Object.entries(u().future).map(([t,a])=>e.createElement("button",{key:t,className:`btn btn-xs ${r===`month_${t}`?"btn-success":"btn-soft-success"}`,onClick:()=>c(`month_${t}`)},t," (",a.length,")")),r!=="all"&&e.createElement("button",{className:"btn btn-xs btn-soft-secondary",onClick:()=>c("all")},"Mostrar todos"))),e.createElement("div",{className:"card-body",style:{height:"calc(100vh - 250px)",overflow:"auto"}},e.createElement("div",{className:"form-check form-switch mb-2 align-content-center"},e.createElement("input",{className:"form-check-input",type:"checkbox",id:"showDebtOnly",onChange:t=>E(t.target.checked),style:{cursor:"pointer"}}),e.createElement("label",{className:"form-check-label",htmlFor:"showDebtOnly",style:{cursor:"pointer"}},"Solo mostrar proyectos con deuda")),e.createElement("div",{className:"table-responsive"},e.createElement("table",{className:"table table-sm table-bordered table-striped mb-0"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null,"Cliente"),e.createElement("th",null,"Fecha de desarrollo"),e.createElement("th",null,"Estado"),e.createElement("th",null,"Debe"),e.createElement("th",null,"Asignado a"))),e.createElement("tbody",null,h().map((t,a)=>{const l=t.users.map(s=>s.relative_id);return e.createElement("tr",{key:`project-${a}`,style:{backgroundColor:t.is_alert?"rgba(255,91,91,.18)":"unset"}},e.createElement("td",{className:`${moment(t.ends_at).isBefore(moment())?"text-danger":""}`,style:{boxShadow:t.is_alert?"unset":""}},e.createElement("b",{className:"d-block"},t.client.tradename),e.createElement("small",null,t.name)),e.createElement("td",{style:{boxShadow:t.is_alert?"unset":""}},_(t.starts_at,t.ends_at)),e.createElement("td",{style:{boxShadow:t.is_alert?"unset":""}},e.createElement("span",{className:"badge",style:{backgroundColor:t.status.color}},t.status.name)),e.createElement("td",{style:{boxShadow:t.is_alert?"unset":""}},t.remaining_amount>0?e.createElement("b",{className:"text-danger"},"Debe"):"No debe"),e.createElement("td",{style:{boxShadow:t.is_alert?"unset":""}},w(l)))})))))))))};f((o,m)=>{y(o).render(e.createElement(g,{...m,title:"Cuadro de control"},e.createElement(k,{...m})))});
