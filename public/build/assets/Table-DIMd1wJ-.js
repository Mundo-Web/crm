import{r as p,j as a,R as ee}from"./CreateReactScript-oCcGkxM7.js";import{r as te}from"./server.browser-D6534rAg.js";import{l as ae,d as ne}from"./default-CykgR28A.js";const re=({gridRef:e,rest:n,columns:t,toolBar:o,masterDetail:i,filterValue:c,defaultRows:s,selection:d,allowedPageSizes:v=[5,10,25,50,100],pageSize:b=100,exportable:M,exportableName:x,customizeCell:L=()=>{},reloadWith:P=[null],height:G="calc(100vh - 185px)",keyExpr:O,onSelectionChanged:V})=>(p.useEffect(()=>{var E,g,z;DevExpress.localization.locale(navigator.language),$(e.current).data("dxDataGrid")&&((g=(E=$(e.current))==null?void 0:E.dxDataGrid("instance"))==null||g.dispose()),$(e.current).dxDataGrid({language:"es",dataSource:{load:async u=>{const l=await n.paginate(u)??{};let h=(l==null?void 0:l.data)||[];if(s){const f=s.map(y=>Object.keys(y)),I=h.concat(s.filter(y=>!h.some(k=>f.some(w=>w.every(D=>k[D]==y[D])))));l.data=I}return l}},onToolbarPreparing:u=>{const{items:l}=u.toolbarOptions;o(l)},remoteOperations:!0,columnResizingMode:"widget",allowColumnResizing:!0,allowColumnReordering:!0,columnAutoWidth:!0,scrollbars:"auto",filterPanel:{visible:!1},searchPanel:{visible:!1},headerFilter:{visible:!0,search:{enabled:!0}},height:G,filterValue:c,keyExpr:O,selection:d||null,onSelectionChanged:V,export:{enabled:!1},onExporting:function(u){var l=new ExcelJS.Workbook,h=l.addWorksheet("Main sheet");DevExpress.excelExporter.exportDataGrid({worksheet:h,component:u.component,customizeCell:function(f){L(f),f.excelCell.alignment={horizontal:"left",vertical:"top",...f.excelCell.alignment}}}).then(function(){l.xlsx.writeBuffer().then(function(f){saveAs(new Blob([f],{type:"application/octet-stream"}),`${x}.xlsx`)})})},rowAlternationEnabled:!0,showBorders:!0,filterRow:{visible:!0,applyFilter:"auto"},filterBuilderPopup:{visible:!1,position:{of:window,at:"top",my:"top",offset:{y:10}}},paging:{pageSize:b},pager:{visible:!0,allowedPageSizes:v,showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0},allowFiltering:!0,scrolling:{mode:"standard",useNative:!0,preloadEnabled:!0,rowRenderingMode:"standard"},columnChooser:{title:"Mostrar/Ocultar columnas",enabled:!1,mode:"select",search:{enabled:!0}},columns:t,masterDetail:i,onContentReady:(...u)=>{tippy(".tippy-here",{arrow:!0,animation:"scale"})},onOptionChanged:u=>{if(u.fullName==="filterValue"){const l=location.pathname,h=Local.get("dxSettings")||{};h[l]={filterValue:u.value},Local.set("dxSettings",h)}}}).dxDataGrid("instance"),tippy(".dx-button",{arrow:!0});const S=Local.get("dxSettings")||{};(z=S[location.pathname])!=null&&z.filterValue&&$(e.current).dxDataGrid("instance").option("filterValue",S[location.pathname].filterValue)},P),a.jsx("div",{ref:e})),oe={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},se=(e,n,t)=>{let o;const i=oe[e];return typeof i=="string"?o=i:n===1?o=i.one:o=i.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"en "+o:"hace "+o:o};function _(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const ie={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},le={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},de={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ce={date:_({formats:ie,defaultWidth:"full"}),time:_({formats:le,defaultWidth:"full"}),dateTime:_({formats:de,defaultWidth:"full"})},me={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},ue={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},he=(e,n,t,o)=>n.getHours()!==1?ue[e]:me[e];function C(e){return(n,t)=>{const o=t!=null&&t.context?String(t.context):"standalone";let i;if(o==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,d=t!=null&&t.width?String(t.width):s;i=e.formattingValues[d]||e.formattingValues[s]}else{const s=e.defaultWidth,d=t!=null&&t.width?String(t.width):e.defaultWidth;i=e.values[d]||e.values[s]}const c=e.argumentCallback?e.argumentCallback(n):n;return i[c]}}const fe={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},be={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},pe={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},xe={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},we={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},ve={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},ge=(e,n)=>Number(e)+"º",ye={ordinalNumber:ge,era:C({values:fe,defaultWidth:"wide"}),quarter:C({values:be,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:C({values:pe,defaultWidth:"wide"}),day:C({values:xe,defaultWidth:"wide"}),dayPeriod:C({values:we,defaultWidth:"wide",formattingValues:ve,defaultFormattingWidth:"wide"})};function je(e){return(n,t={})=>{const o=n.match(e.matchPattern);if(!o)return null;const i=o[0],c=n.match(e.parsePattern);if(!c)return null;let s=e.valueCallback?e.valueCallback(c[0]):c[0];s=t.valueCallback?t.valueCallback(s):s;const d=n.slice(i.length);return{value:s,rest:d}}}function W(e){return(n,t={})=>{const o=t.width,i=o&&e.matchPatterns[o]||e.matchPatterns[e.defaultMatchWidth],c=n.match(i);if(!c)return null;const s=c[0],d=o&&e.parsePatterns[o]||e.parsePatterns[e.defaultParseWidth],v=Array.isArray(d)?ke(d,x=>x.test(s)):Pe(d,x=>x.test(s));let b;b=e.valueCallback?e.valueCallback(v):v,b=t.valueCallback?t.valueCallback(b):b;const M=n.slice(s.length);return{value:b,rest:M}}}function Pe(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function ke(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}const De=/^(\d+)(º)?/i,Ne=/\d+/i,Ce={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},We={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},Me={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},Se={any:[/1/i,/2/i,/3/i,/4/i]},Ee={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},ze={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},Fe={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},Ae={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},Le={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},$e={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},Ge={ordinalNumber:je({matchPattern:De,parsePattern:Ne,valueCallback:function(e){return parseInt(e,10)}}),era:W({matchPatterns:Ce,defaultMatchWidth:"wide",parsePatterns:We,defaultParseWidth:"any"}),quarter:W({matchPatterns:Me,defaultMatchWidth:"wide",parsePatterns:Se,defaultParseWidth:"any",valueCallback:e=>e+1}),month:W({matchPatterns:Ee,defaultMatchWidth:"wide",parsePatterns:ze,defaultParseWidth:"any"}),day:W({matchPatterns:Fe,defaultMatchWidth:"wide",parsePatterns:Ae,defaultParseWidth:"any"}),dayPeriod:W({matchPatterns:Le,defaultMatchWidth:"any",parsePatterns:$e,defaultParseWidth:"any"})},Oe={code:"es",formatDistance:se,formatLong:ce,formatRelative:he,localize:ye,match:Ge,options:{weekStartsOn:1,firstWeekContainsDate:1}},Te=({title:e,gridRef:n,rest:t,columns:o,toolBar:i,masterDetail:c,filterValue:s=[],defaultRows:d,selection:v,cardClass:b="",className:M="",allowedPageSizes:x,pageSize:L,exportable:P=!1,customizeCell:G,reloadWith:O,height:V,cardStyle:S,keyExpr:E,onSelectionChanged:g,massiveActions:z})=>{const u=te(a.jsx("div",{children:e})),l=$(u).text().trim().replace("-",""),[h,f]=p.useState([{startDate:new Date,endDate:new Date,key:"selection"}]),[I,y]=p.useState(!1),[k,w]=p.useState(!1),[D,q]=p.useState(0),R=p.useRef(null);`${crypto.randomUUID()}`;const[T,H]=p.useState(!1),B=Array.isArray(t)&&t.length&&t[0].rest!==void 0,[X,K]=p.useState(0),J=p.useCallback(ae.debounce(r=>{$(n.current).dxDataGrid("instance").searchByText(r)},500),[n]),Q=()=>{const{startDate:r,endDate:m}=h[0];if(!r||!m)return;const F=new Date(r);F.setHours(-5,0,0,0);const j=new Date(m);j.setHours(18,59,59,999),$(n.current).dxDataGrid("instance").filter([["created_at",">=",F],"and",["created_at","<=",j]]),y(!0),w(!1)},U=()=>{$(n.current).dxDataGrid("instance").clearFilter(),f([{startDate:new Date,endDate:new Date,key:"selection"}]),y(!1),w(!1)},Z=()=>{if(!P)return;const r=$(n.current).dxDataGrid("instance"),m=new ExcelJS.Workbook,F=m.addWorksheet("Data");DevExpress.excelExporter.exportDataGrid({component:r,worksheet:F,autoFilterEnabled:!0,topLeftCell:{row:1,column:1},customizeCell:function(j){const{gridCell:N,excelCell:A}=j;N.rowType==="header"?(A.value=N.column.caption||N.column.dataField,A.font={bold:!0},A.alignment={horizontal:"center"}):A.value=N.value}}).then(function(){m.xlsx.writeBuffer().then(function(j){saveAs(new Blob([j],{type:"application/octet-stream"}),`${l.toLowerCase()}.xlsx`)})})},Y=r=>{R.current&&!R.current.contains(r.target)&&w(!1)};return ee.useEffect(()=>(document.addEventListener("mousedown",Y),()=>{document.removeEventListener("mousedown",Y)}),[]),a.jsx("div",{className:`row ${M}`,children:a.jsx("div",{className:"col-12",children:a.jsx("div",{className:`card ${b}`,style:S,children:a.jsxs("div",{className:"card-body",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[typeof e=="string"?a.jsxs("h4",{className:"w-100 my-0 header-title",children:["Lista de ",e]}):a.jsx("div",{className:"w-100 my-0",children:e}),a.jsxs("button",{className:"btn btn-white btn-xs text-nowrap",onClick:()=>$(n.current).dxDataGrid("instance").refresh(),children:[a.jsx("i",{className:"mdi mdi-refresh me-1"}),"Actualizar"]})]}),B&&a.jsx("div",{className:"d-flex flex-wrap gap-1 mb-2",children:t.map((r,m)=>a.jsx("button",{className:`btn ${m===X?r.classNameWhenActive||"btn-success":r.className||"btn-white"} btn-xs text-nowrap rounded-pill waves-effect`,onClick:()=>K(m),children:r.label},m))}),!B&&Array.isArray(t)&&a.jsx("div",{className:"d-flex flex-wrap gap-1 mb-2",children:t.map((r,m)=>a.jsx("button",{className:`btn ${r.className||"btn-white"} btn-xs text-nowrap rounded-pill waves-effect`,onClick:()=>r(),children:r.label},m))}),a.jsxs("div",{className:"d-flex mb-2 gap-2",children:[a.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Buscar...",onChange:r=>J(r.target.value)}),a.jsxs("div",{className:"d-flex gap-2",children:[D>0&&a.jsxs("div",{className:"dropdown position-relative",children:[a.jsxs("button",{className:"btn btn-white btn-sm dropdown-toggle position-relative bg-white",type:"button",onClick:()=>H(!T),style:{zIndex:T?1e4:void 0},children:[a.jsx("i",{className:"mdi mdi-format-list-checks me-1"}),"Acciones",a.jsx("span",{className:"badge bg-primary ms-1",children:D}),a.jsx("i",{className:"mdi mdi-chevron-down ms-1"})]}),T&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"position-fixed",style:{top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999},onClick:()=>H(!1)}),a.jsx("ul",{className:"dropdown-menu dropdown-menu-end show",style:{position:"absolute",zIndex:1e4},onClick:()=>H(!1),children:z})]})]}),a.jsxs("div",{className:"dropdown position-relative",ref:R,children:[a.jsxs("button",{className:"position-relative btn btn-sm btn-white dropdown-toggle bg-white",onClick:()=>w(!k),style:{zIndex:k?1e4:void 0},children:[a.jsx("i",{className:"mdi mdi-calendar-range me-1"}),"Periodo",I&&a.jsx("span",{className:"ms-1 badge bg-primary",children:a.jsx("i",{className:"mdi mdi-filter"})})]}),k&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"position-fixed",style:{top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999},onClick:()=>w(!1)}),a.jsxs("div",{className:"dropdown-menu p-2 show mt-1",style:{minWidth:"650px",position:"absolute",right:0,transform:"translateX(0)",zIndex:1e4},children:[a.jsx(ne.DateRange,{editableDateInputs:!0,onChange:r=>f([r.selection]),moveRangeOnFirstSelection:!1,ranges:h,locale:Oe,months:2,direction:"horizontal",showDateDisplay:!1}),a.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-2",children:[a.jsxs("button",{className:"btn btn-sm btn-danger",onClick:U,children:[a.jsx("i",{className:"mdi mdi-filter-remove me-1"}),"Limpiar"]}),a.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>Q(),children:[a.jsx("i",{className:"mdi mdi-filter me-1"}),"Filtrar"]})]})]})]})]}),a.jsxs("button",{className:"btn btn-sm btn-white text-nowrap",onClick:Z,disabled:!P,children:[a.jsx("i",{className:"mdi mdi-download me-1"}),"Exportar"]})]})]}),a.jsx(re,{gridRef:n,rest:B?t[X].rest:t,columns:o.filter(Boolean),toolBar:i,masterDetail:c,filterValue:s,defaultRows:d,selection:v,allowedPageSizes:x,pageSize:L,exportable:P,exportableName:l.toLowerCase(),customizeCell:G,reloadWith:[...O??[],X],height:V,keyExpr:E,onSelectionChanged:r=>{q(r.selectedRowKeys.length),g==null||g(r)}})]})})})})};export{Te as T};
