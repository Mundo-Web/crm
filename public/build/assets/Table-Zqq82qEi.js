import{r as u,j as t,d as oe}from"./CreateReactScript-BkSYNPDa.js";import{r as ie}from"./server.browser-BEhsz7UB.js";import{l as le,d as de}from"./default-Dfqbhhm5.js";import{A as U}from"./ArrayJoin-2k6ba35P.js";const ce=({gridRef:e,rest:r,columns:a,toolBar:n,masterDetail:i,filterValue:m,defaultRows:o,selection:c,allowedPageSizes:w=[5,10,25,50,100],pageSize:p=100,exportable:M,exportableName:x,customizeCell:O=()=>{},reloadWith:V=[null],height:k="calc(100vh - 185px)",keyExpr:I,onSelectionChanged:R})=>(u.useEffect(()=>{var F,z,v;DevExpress.localization.locale(navigator.language),$(e.current).data("dxDataGrid")&&((z=(F=$(e.current))==null?void 0:F.dxDataGrid("instance"))==null||z.dispose()),$(e.current).dxDataGrid({language:"es",dataSource:{load:async h=>{const l=await r.paginate(h)??{};let f=(l==null?void 0:l.data)||[];if(o){const b=o.map(g=>Object.keys(g)),E=f.concat(o.filter(g=>!f.some(A=>b.some(N=>N.every(P=>A[P]==g[P])))));l.data=E}return l}},onToolbarPreparing:h=>{const{items:l}=h.toolbarOptions;n(l)},remoteOperations:!0,columnResizingMode:"widget",allowColumnResizing:!0,allowColumnReordering:!0,columnAutoWidth:!0,scrollbars:"auto",filterPanel:{visible:!1},searchPanel:{visible:!1},headerFilter:{visible:!0,search:{enabled:!0}},height:k,filterValue:m,keyExpr:I,selection:c||null,onSelectionChanged:R,export:{enabled:!1},onExporting:function(h){var l=new ExcelJS.Workbook,f=l.addWorksheet("Main sheet");DevExpress.excelExporter.exportDataGrid({worksheet:f,component:h.component,customizeCell:function(b){O(b),b.excelCell.alignment={horizontal:"left",vertical:"top",...b.excelCell.alignment}}}).then(function(){l.xlsx.writeBuffer().then(function(b){saveAs(new Blob([b],{type:"application/octet-stream"}),`${x}.xlsx`)})})},rowAlternationEnabled:!0,showBorders:!0,filterRow:{visible:!0,applyFilter:"auto"},filterBuilderPopup:{visible:!1,position:{of:window,at:"top",my:"top",offset:{y:10}}},paging:{pageSize:p},pager:{visible:!0,allowedPageSizes:w,showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0},allowFiltering:!0,scrolling:{mode:"standard",useNative:!0,preloadEnabled:!0,rowRenderingMode:"standard"},columnChooser:{title:"Mostrar/Ocultar columnas",enabled:!1,mode:"select",search:{enabled:!0}},columns:a,masterDetail:i,onContentReady:(...h)=>{tippy(".tippy-here",{arrow:!0,animation:"scale"})},onOptionChanged:h=>{if(h.fullName==="filterValue"){const l=location.pathname,f=Local.get("dxSettings")||{};f[l]={filterValue:h.value},Local.set("dxSettings",f)}}}).dxDataGrid("instance"),tippy(".dx-button",{arrow:!0});const S=Local.get("dxSettings")||{};(v=S[location.pathname])!=null&&v.filterValue&&$(e.current).dxDataGrid("instance").option("filterValue",S[location.pathname].filterValue)},V),t.jsx("div",{ref:e})),me={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},ue=(e,r,a)=>{let n;const i=me[e];return typeof i=="string"?n=i:r===1?n=i.one:n=i.other.replace("{{count}}",r.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"en "+n:"hace "+n:n};function q(e){return(r={})=>{const a=r.width?String(r.width):e.defaultWidth;return e.formats[a]||e.formats[e.defaultWidth]}}const he={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},fe={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},be={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pe={date:q({formats:he,defaultWidth:"full"}),time:q({formats:fe,defaultWidth:"full"}),dateTime:q({formats:be,defaultWidth:"full"})},xe={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},we={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},ve=(e,r,a,n)=>r.getHours()!==1?we[e]:xe[e];function C(e){return(r,a)=>{const n=a!=null&&a.context?String(a.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,c=a!=null&&a.width?String(a.width):o;i=e.formattingValues[c]||e.formattingValues[o]}else{const o=e.defaultWidth,c=a!=null&&a.width?String(a.width):e.defaultWidth;i=e.values[c]||e.values[o]}const m=e.argumentCallback?e.argumentCallback(r):r;return i[m]}}const ge={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},ye={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},je={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},ke={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},Ne={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},Pe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},De=(e,r)=>Number(e)+"º",Ce={ordinalNumber:De,era:C({values:ge,defaultWidth:"wide"}),quarter:C({values:ye,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:C({values:je,defaultWidth:"wide"}),day:C({values:ke,defaultWidth:"wide"}),dayPeriod:C({values:Ne,defaultWidth:"wide",formattingValues:Pe,defaultFormattingWidth:"wide"})};function We(e){return(r,a={})=>{const n=r.match(e.matchPattern);if(!n)return null;const i=n[0],m=r.match(e.parsePattern);if(!m)return null;let o=e.valueCallback?e.valueCallback(m[0]):m[0];o=a.valueCallback?a.valueCallback(o):o;const c=r.slice(i.length);return{value:o,rest:c}}}function W(e){return(r,a={})=>{const n=a.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],m=r.match(i);if(!m)return null;const o=m[0],c=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],w=Array.isArray(c)?Se(c,x=>x.test(o)):Me(c,x=>x.test(o));let p;p=e.valueCallback?e.valueCallback(w):w,p=a.valueCallback?a.valueCallback(p):p;const M=r.slice(o.length);return{value:p,rest:M}}}function Me(e,r){for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&r(e[a]))return a}function Se(e,r){for(let a=0;a<e.length;a++)if(r(e[a]))return a}const Fe=/^(\d+)(º)?/i,ze=/\d+/i,Ee={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},Ae={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},Le={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},Te={any:[/1/i,/2/i,/3/i,/4/i]},Oe={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},Ve={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},$e={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},Ie={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},Re={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},He={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},Ge={ordinalNumber:We({matchPattern:Fe,parsePattern:ze,valueCallback:function(e){return parseInt(e,10)}}),era:W({matchPatterns:Ee,defaultMatchWidth:"wide",parsePatterns:Ae,defaultParseWidth:"any"}),quarter:W({matchPatterns:Le,defaultMatchWidth:"wide",parsePatterns:Te,defaultParseWidth:"any",valueCallback:e=>e+1}),month:W({matchPatterns:Oe,defaultMatchWidth:"wide",parsePatterns:Ve,defaultParseWidth:"any"}),day:W({matchPatterns:$e,defaultMatchWidth:"wide",parsePatterns:Ie,defaultParseWidth:"any"}),dayPeriod:W({matchPatterns:Re,defaultMatchWidth:"any",parsePatterns:He,defaultParseWidth:"any"})},Be={code:"es",formatDistance:ue,formatLong:pe,formatRelative:ve,localize:Ce,match:Ge,options:{weekStartsOn:1,firstWeekContainsDate:1}},Je=({title:e,filter:r=[],gridRef:a,rest:n,columns:i,toolBar:m,masterDetail:o,filterValue:c=[],defaultRows:w,selection:p,cardClass:M="",className:x="",allowedPageSizes:O,pageSize:V,exportable:k=!1,customizeCell:I,reloadWith:R,height:S,cardStyle:F,keyExpr:z,onSelectionChanged:v,massiveActions:h})=>{const l=ie(t.jsx("div",{children:e})),f=$(l).text().trim().replace("-",""),[b,E]=u.useState([{startDate:new Date,endDate:new Date,key:"selection"}]),[g,A]=u.useState([]),[N,P]=u.useState("updated_at"),[Z,J]=u.useState(!1),[H,D]=u.useState(!1),[K,ee]=u.useState(0),G=u.useRef(null);`${crypto.randomUUID()}`;const[B,X]=u.useState(!1),_=Array.isArray(n)&&n.length&&n[0].rest!==void 0,[Y,te]=u.useState(0),ae=u.useCallback(le.debounce(s=>{$(a.current).dxDataGrid("instance").searchByText(s)},500),[a]),ne=()=>{const{startDate:s,endDate:d}=b[0];if(!s||!d)return;const y=new Date(s);y.setHours(-5,0,0,0);const j=new Date(d);j.setHours(18,59,59,999),A(U([[N,">=",y],[N,"<=",j]],"and")),J(!0),D(!1)},re=()=>{E([{startDate:new Date,endDate:new Date,key:"selection"}]),A([]),J(!1),D(!1)};u.useEffect(()=>{const s=$(a.current).dxDataGrid("instance"),d=[g,r].filter(y=>y.length>0);s.filter(U(d,"and"))},[r,g]);const se=()=>{if(!k)return;const s=$(a.current).dxDataGrid("instance"),d=new ExcelJS.Workbook,y=d.addWorksheet("Data");DevExpress.excelExporter.exportDataGrid({component:s,worksheet:y,autoFilterEnabled:!0,topLeftCell:{row:1,column:1},customizeCell:function(j){const{gridCell:L,excelCell:T}=j;L.rowType==="header"?(T.value=L.column.caption||L.column.dataField,T.font={bold:!0},T.alignment={horizontal:"center"}):T.value=L.value}}).then(function(){d.xlsx.writeBuffer().then(function(j){saveAs(new Blob([j],{type:"application/octet-stream"}),`${f.toLowerCase()}.xlsx`)})})},Q=s=>{G.current&&!G.current.contains(s.target)&&D(!1)};return oe.useEffect(()=>(document.addEventListener("mousedown",Q),()=>{document.removeEventListener("mousedown",Q)}),[]),t.jsx("div",{className:`row ${x}`,children:t.jsx("div",{className:"col-12",children:t.jsx("div",{className:`card ${M}`,style:F,children:t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2 gap-1",children:[typeof e=="string"?t.jsxs("h4",{className:"my-0 header-title flex-1 text-break",children:["Lista de ",e]}):t.jsx("div",{className:"my-0 flex-1 overflow-hidden",children:e}),t.jsx("div",{className:"d-flex gap-1 flex-wrap",children:t.jsxs("button",{className:"btn btn-white btn-xs text-nowrap",onClick:()=>$(a.current).dxDataGrid("instance").refresh(),children:[t.jsx("i",{className:"mdi mdi-refresh me-md-1"}),t.jsx("span",{className:"d-none d-md-inline-block",children:"Actualizar"})]})})]}),_&&t.jsx("div",{className:"d-flex flex-wrap gap-1 mb-2",children:n.map((s,d)=>t.jsx("button",{className:`btn ${d===Y?s.classNameWhenActive||"btn-success":s.className||"btn-white"} btn-xs text-nowrap rounded-pill waves-effect`,onClick:()=>te(d),children:s.label},d))}),!_&&Array.isArray(n)&&t.jsx("div",{className:"d-flex flex-wrap gap-1 mb-2",children:n.map((s,d)=>t.jsx("button",{className:`btn ${s.className||"btn-white"} btn-xs text-nowrap rounded-pill waves-effect`,onClick:()=>s(),children:s.label},d))}),t.jsxs("div",{className:"d-flex mb-2 gap-2",children:[t.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Buscar...",onChange:s=>ae(s.target.value)}),t.jsxs("div",{className:"d-flex gap-2",children:[K>0&&t.jsxs("div",{className:"dropdown position-relative",children:[t.jsxs("button",{className:"btn btn-white btn-sm dropdown-toggle position-relative bg-white",type:"button",onClick:()=>X(!B),style:{zIndex:B?1e4:void 0},children:[t.jsx("i",{className:"mdi mdi-format-list-checks me-md-1"}),t.jsx("span",{className:"d-none d-md-inline-block",children:"Acciones"}),t.jsx("span",{className:"badge bg-primary ms-1",children:K}),t.jsx("i",{className:"mdi mdi-chevron-down ms-1"})]}),B&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"position-fixed",style:{top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999},onClick:()=>X(!1)}),t.jsx("ul",{className:"dropdown-menu dropdown-menu-end show",style:{position:"absolute",zIndex:1e4},onClick:()=>X(!1),children:h})]})]}),t.jsxs("div",{className:"dropdown position-relative",ref:G,children:[t.jsxs("button",{className:"position-relative btn btn-sm btn-white dropdown-toggle bg-white",onClick:()=>D(!H),style:{zIndex:H?1e4:void 0},children:[t.jsx("i",{className:"mdi mdi-calendar-range me-md-1"}),t.jsx("span",{className:"d-none d-md-inline-block",children:"Periodo"}),Z&&t.jsx("span",{className:"ms-1 badge bg-primary",children:t.jsx("i",{className:"mdi mdi-filter"})})]}),H&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"position-fixed",style:{top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999},onClick:()=>D(!1)}),t.jsxs("div",{className:"dropdown-menu p-2 show mt-1",style:{minWidth:"650px",position:"absolute",right:0,transform:"translateX(0)",zIndex:1e4},children:[t.jsx(de.DateRange,{editableDateInputs:!0,onChange:s=>E([s.selection]),moveRangeOnFirstSelection:!1,ranges:b,locale:Be,months:2,direction:"horizontal",showDateDisplay:!1}),t.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-2",children:[t.jsxs("div",{className:"dropdown",children:[t.jsx("button",{className:"btn btn-sm btn-white dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:N==="created_at"?"Fecha creación":"Fecha actualización"}),t.jsxs("ul",{className:"dropdown-menu",children:[t.jsx("li",{children:t.jsx("button",{className:"dropdown-item",type:"button",onClick:()=>P("created_at"),children:"Fecha creación"})}),t.jsx("li",{children:t.jsx("button",{className:"dropdown-item",type:"button",onClick:()=>P("updated_at"),children:"Fecha actualización"})})]})]}),t.jsxs("button",{className:"btn btn-sm btn-danger",onClick:re,children:[t.jsx("i",{className:"mdi mdi-filter-remove me-1"}),"Limpiar"]}),t.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>ne(),children:[t.jsx("i",{className:"mdi mdi-filter me-1"}),"Filtrar"]})]})]})]})]}),t.jsxs("button",{className:"btn btn-sm btn-white text-nowrap",onClick:se,disabled:!k,children:[t.jsx("i",{className:"mdi mdi-download me-md-1"}),t.jsx("span",{className:"d-none d-md-inline-block",children:"Exportar"})]})]})]}),t.jsx(ce,{gridRef:a,rest:_?n[Y].rest:n,columns:i.filter(Boolean),toolBar:m,masterDetail:o,filterValue:c,defaultRows:w,selection:p,allowedPageSizes:O,pageSize:V,exportable:k,exportableName:f.toLowerCase(),customizeCell:I,reloadWith:[...R??[],Y],height:S,keyExpr:z,onSelectionChanged:s=>{ee(s.selectedRowKeys.length),v==null||v(s)}})]})})})})};export{Je as T};
