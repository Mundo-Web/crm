import{r as b,j as a,R as J}from"./CreateReactScript-9UX3kXBD.js";import{r as Q}from"./server.browser-DF3AkXWG.js";import{l as U,d as Z}from"./default-DBDxJu4M.js";const ee=({gridRef:e,rest:n,columns:t,toolBar:r,masterDetail:s,filterValue:c,defaultRows:o,selection:l,allowedPageSizes:v=[5,10,25,50,100],pageSize:h=100,exportable:N,exportableName:p,customizeCell:P=()=>{},reloadWith:O=[null],height:V="calc(100vh - 185px)",keyExpr:T,onSelectionChanged:A})=>(b.useEffect(()=>{var g,M,S;DevExpress.localization.locale(navigator.language),$(e.current).data("dxDataGrid")&&((M=(g=$(e.current))==null?void 0:g.dxDataGrid("instance"))==null||M.dispose()),$(e.current).dxDataGrid({language:"es",dataSource:{load:async m=>{const d=await n.paginate(m)??{};let u=(d==null?void 0:d.data)||[];if(o){const f=o.map(x=>Object.keys(x)),E=u.concat(o.filter(x=>!u.some(w=>f.some(z=>z.every(F=>w[F]==x[F])))));d.data=E}return d}},onToolbarPreparing:m=>{const{items:d}=m.toolbarOptions;r(d)},remoteOperations:!0,columnResizingMode:"widget",allowColumnResizing:!0,allowColumnReordering:!0,columnAutoWidth:!0,scrollbars:"auto",filterPanel:{visible:!1},searchPanel:{visible:!1},headerFilter:{visible:!0,search:{enabled:!0}},height:V,filterValue:c,keyExpr:T,selection:l||null,onSelectionChanged:A,export:{enabled:!1},onExporting:function(m){var d=new ExcelJS.Workbook,u=d.addWorksheet("Main sheet");DevExpress.excelExporter.exportDataGrid({worksheet:u,component:m.component,customizeCell:function(f){P(f),f.excelCell.alignment={horizontal:"left",vertical:"top",...f.excelCell.alignment}}}).then(function(){d.xlsx.writeBuffer().then(function(f){saveAs(new Blob([f],{type:"application/octet-stream"}),`${p}.xlsx`)})})},rowAlternationEnabled:!0,showBorders:!0,filterRow:{visible:!0,applyFilter:"auto"},filterBuilderPopup:{visible:!1,position:{of:window,at:"top",my:"top",offset:{y:10}}},paging:{pageSize:h},pager:{visible:!0,allowedPageSizes:v,showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0},allowFiltering:!0,scrolling:{mode:"standard",useNative:!0,preloadEnabled:!0,rowRenderingMode:"standard"},columnChooser:{title:"Mostrar/Ocultar columnas",enabled:!1,mode:"select",search:{enabled:!0}},columns:t,masterDetail:s,onContentReady:(...m)=>{tippy(".tippy-here",{arrow:!0,animation:"scale"})},onOptionChanged:m=>{if(m.fullName==="filterValue"){const d=location.pathname,u=Local.get("dxSettings")||{};u[d]={filterValue:m.value},Local.set("dxSettings",u)}}}).dxDataGrid("instance"),tippy(".dx-button",{arrow:!0});const W=Local.get("dxSettings")||{};(S=W[location.pathname])!=null&&S.filterValue&&$(e.current).dxDataGrid("instance").option("filterValue",W[location.pathname].filterValue)},O),a.jsx("div",{ref:e})),te={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},ae=(e,n,t)=>{let r;const s=te[e];return typeof s=="string"?r=s:n===1?r=s.one:r=s.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"en "+r:"hace "+r:r};function B(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const ne={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},re={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},oe={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},se={date:B({formats:ne,defaultWidth:"full"}),time:B({formats:re,defaultWidth:"full"}),dateTime:B({formats:oe,defaultWidth:"full"})},ie={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},de={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},le=(e,n,t,r)=>n.getHours()!==1?de[e]:ie[e];function k(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=t!=null&&t.width?String(t.width):o;s=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=t!=null&&t.width?String(t.width):e.defaultWidth;s=e.values[l]||e.values[o]}const c=e.argumentCallback?e.argumentCallback(n):n;return s[c]}}const ce={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},me={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},ue={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},he={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},fe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},be={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},pe=(e,n)=>Number(e)+"º",xe={ordinalNumber:pe,era:k({values:ce,defaultWidth:"wide"}),quarter:k({values:me,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:k({values:ue,defaultWidth:"wide"}),day:k({values:he,defaultWidth:"wide"}),dayPeriod:k({values:fe,defaultWidth:"wide",formattingValues:be,defaultFormattingWidth:"wide"})};function we(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const s=r[0],c=n.match(e.parsePattern);if(!c)return null;let o=e.valueCallback?e.valueCallback(c[0]):c[0];o=t.valueCallback?t.valueCallback(o):o;const l=n.slice(s.length);return{value:o,rest:l}}}function C(e){return(n,t={})=>{const r=t.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],c=n.match(s);if(!c)return null;const o=c[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],v=Array.isArray(l)?ge(l,p=>p.test(o)):ve(l,p=>p.test(o));let h;h=e.valueCallback?e.valueCallback(v):v,h=t.valueCallback?t.valueCallback(h):h;const N=n.slice(o.length);return{value:h,rest:N}}}function ve(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function ge(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}const ye=/^(\d+)(º)?/i,je=/\d+/i,Pe={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},De={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},ke={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},Ce={any:[/1/i,/2/i,/3/i,/4/i]},Ne={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},We={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},Me={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},Se={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},Ee={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},ze={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},Fe={ordinalNumber:we({matchPattern:ye,parsePattern:je,valueCallback:function(e){return parseInt(e,10)}}),era:C({matchPatterns:Pe,defaultMatchWidth:"wide",parsePatterns:De,defaultParseWidth:"any"}),quarter:C({matchPatterns:ke,defaultMatchWidth:"wide",parsePatterns:Ce,defaultParseWidth:"any",valueCallback:e=>e+1}),month:C({matchPatterns:Ne,defaultMatchWidth:"wide",parsePatterns:We,defaultParseWidth:"any"}),day:C({matchPatterns:Me,defaultMatchWidth:"wide",parsePatterns:Se,defaultParseWidth:"any"}),dayPeriod:C({matchPatterns:Ee,defaultMatchWidth:"any",parsePatterns:ze,defaultParseWidth:"any"})},Le={code:"es",formatDistance:ae,formatLong:se,formatRelative:le,localize:xe,match:Fe,options:{weekStartsOn:1,firstWeekContainsDate:1}},Te=({title:e,gridRef:n,rest:t,columns:r,toolBar:s,masterDetail:c,filterValue:o=[],defaultRows:l,selection:v,className:h="",allowedPageSizes:N,pageSize:p,exportable:P=!1,customizeCell:O,reloadWith:V,height:T,cardStyle:A,keyExpr:W,onSelectionChanged:g,massiveActions:M})=>{const S=Q(a.jsx("div",{children:e})),m=$(S).text().trim().replace("-",""),[d,u]=b.useState([{startDate:new Date,endDate:new Date,key:"selection"}]),[f,E]=b.useState(!1),[x,w]=b.useState(!1),[z,F]=b.useState(0),H=b.useRef(null);`${crypto.randomUUID()}`;const[I,R]=b.useState(!1),_=b.useCallback(U.debounce(i=>{$(n.current).dxDataGrid("instance").searchByText(i)},500),[n]),Y=()=>{const{startDate:i,endDate:y}=d[0];if(!i||!y)return;const L=new Date(i);L.setHours(-5,0,0,0);const j=new Date(y);j.setHours(18,59,59,999),$(n.current).dxDataGrid("instance").filter([["created_at",">=",L],"and",["created_at","<=",j]]),E(!0),w(!1)},q=()=>{$(n.current).dxDataGrid("instance").clearFilter(),u([{startDate:new Date,endDate:new Date,key:"selection"}]),E(!1),w(!1)},K=()=>{if(!P)return;const i=$(n.current).dxDataGrid("instance"),y=new ExcelJS.Workbook,L=y.addWorksheet("Data");DevExpress.excelExporter.exportDataGrid({component:i,worksheet:L,autoFilterEnabled:!0,topLeftCell:{row:1,column:1},customizeCell:function(j){const{gridCell:D,excelCell:G}=j;D.rowType==="header"?(G.value=D.column.caption||D.column.dataField,G.font={bold:!0},G.alignment={horizontal:"center"}):G.value=D.value}}).then(function(){y.xlsx.writeBuffer().then(function(j){saveAs(new Blob([j],{type:"application/octet-stream"}),`${m.toLowerCase()}.xlsx`)})})},X=i=>{H.current&&!H.current.contains(i.target)&&w(!1)};return J.useEffect(()=>(document.addEventListener("mousedown",X),()=>{document.removeEventListener("mousedown",X)}),[]),a.jsx("div",{className:`row ${h}`,children:a.jsx("div",{className:"col-12",children:a.jsx("div",{className:"card",style:A,children:a.jsxs("div",{className:"card-body",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[typeof e=="string"?a.jsxs("h4",{className:"w-100 my-0 header-title",children:["Lista de ",e]}):a.jsx("div",{className:"w-100 my-0",children:e}),a.jsxs("button",{className:"btn btn-white btn-xs text-nowrap",onClick:()=>$(n.current).dxDataGrid("instance").refresh(),children:[a.jsx("i",{className:"mdi mdi-refresh me-1"}),"Actualizar"]})]}),a.jsxs("div",{className:"d-flex mb-2 gap-2",children:[a.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Buscar...",onChange:i=>_(i.target.value)}),a.jsxs("div",{className:"d-flex gap-2",children:[z>0&&a.jsxs("div",{className:"dropdown position-relative",children:[a.jsxs("button",{className:"btn btn-white btn-sm dropdown-toggle position-relative bg-white",type:"button",onClick:()=>R(!I),style:{zIndex:I?1e4:void 0},children:[a.jsx("i",{className:"mdi mdi-format-list-checks me-1"}),"Acciones",a.jsx("span",{className:"badge bg-primary ms-1",children:z}),a.jsx("i",{className:"mdi mdi-chevron-down ms-1"})]}),I&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"position-fixed",style:{top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999},onClick:()=>R(!1)}),a.jsx("ul",{className:"dropdown-menu dropdown-menu-end show",style:{position:"absolute",zIndex:1e4},onClick:()=>R(!1),children:M})]})]}),a.jsxs("div",{className:"dropdown position-relative",ref:H,children:[a.jsxs("button",{className:"position-relative btn btn-sm btn-white dropdown-toggle bg-white",onClick:()=>w(!x),style:{zIndex:x?1e4:void 0},children:[a.jsx("i",{className:"mdi mdi-calendar-range me-1"}),"Periodo",f&&a.jsx("span",{className:"ms-1 badge bg-primary",children:a.jsx("i",{className:"mdi mdi-filter"})})]}),x&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"position-fixed",style:{top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999},onClick:()=>w(!1)}),a.jsxs("div",{className:"dropdown-menu p-2 show mt-1",style:{minWidth:"650px",position:"absolute",right:0,transform:"translateX(0)",zIndex:1e4},children:[a.jsx(Z.DateRange,{editableDateInputs:!0,onChange:i=>u([i.selection]),moveRangeOnFirstSelection:!1,ranges:d,locale:Le,months:2,direction:"horizontal",showDateDisplay:!1}),a.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-2",children:[a.jsxs("button",{className:"btn btn-sm btn-danger",onClick:q,children:[a.jsx("i",{className:"mdi mdi-filter-remove me-1"}),"Limpiar"]}),a.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>Y(),children:[a.jsx("i",{className:"mdi mdi-filter me-1"}),"Filtrar"]})]})]})]})]}),a.jsxs("button",{className:"btn btn-sm btn-white text-nowrap",onClick:K,disabled:!P,children:[a.jsx("i",{className:"mdi mdi-download me-1"}),"Exportar"]})]})]}),a.jsx(ee,{gridRef:n,rest:t,columns:r.filter(Boolean),toolBar:s,masterDetail:c,filterValue:o,defaultRows:l,selection:v,allowedPageSizes:N,pageSize:p,exportable:P,exportableName:m.toLowerCase(),customizeCell:O,reloadWith:V,height:T,keyExpr:W,onSelectionChanged:i=>{F(i.selectedRowKeys.length),g==null||g(i)}})]})})})})};export{Te as T};
