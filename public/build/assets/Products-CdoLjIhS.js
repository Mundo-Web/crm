var F=Object.defineProperty;var P=(n,r,o)=>r in n?F(n,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[r]=o;var b=(n,r,o)=>P(n,typeof r!="symbol"?r+"":r,o);import{j as e,C as B,c as D,r as i}from"./CreateReactScript-BvCtOVXi.js";import{B as I,A,i as g}from"./Adminto-DuJ3iBGW.js";import{M}from"./Modal-cWsP_Pmm.js";import{I as v}from"./InputFormGroup-lApApDqt.js";import{T}from"./TextareaFormGroup-ChPZU0AS.js";import{S as G}from"./sweetalert2.esm.all-Bee8ig8x.js";import{N as L}from"./Number2Currency-e57Tgsuk.js";import{I as O}from"./ImageFormGroup-Dfug_juR.js";import"./Logout-D-WLkxh-.js";class W extends I{constructor(){super(...arguments);b(this,"path","products");b(this,"hasFiles",!0)}}const q=({className:n,ribbon:r,children:o,cardStyle:m,...u})=>e.jsxs("article",{className:`pricing-column ${n} mb-0`,...u,children:[r?e.jsx("div",{className:"ribbon",style:{left:-5},children:e.jsx("span",{children:r})}):"",e.jsx("div",{className:"card mb-0",style:m,children:e.jsx("div",{className:"inner-box card-body p-2",children:o})})]}),N=new W,Y=({products:n=[],types:r=[],can:o})=>{const m=i.useRef(),u=i.useRef(),d=i.useRef(),x=i.useRef(),f=i.useRef(),p=i.useRef(),h=i.useRef(),[C,y]=i.useState(!1),[R,j]=i.useState(n),w=s=>{s!=null&&s.id?y(!0):y(!1),u.current.value=(s==null?void 0:s.id)||null,d.image.src=`/storage/images/product/${(s==null?void 0:s.image)||"null"}`,x.current.value=(s==null?void 0:s.name)||null,f.current.value=(s==null?void 0:s.price)||null,p.current.value=(s==null?void 0:s.color)||null,h.current.value=(s==null?void 0:s.description)||null,$(m.current).modal("show")},S=async s=>{s.preventDefault();const t=new FormData;u.current.value&&t.append("id",u.current.value),t.append("name",x.current.value),t.append("price",f.current.value),t.append("color",p.current.value),t.append("description",h.current.value),d.current.files[0]&&t.append("image",d.current.files[0]);const c=await N.save(t);if(!c)return;$(m.current).modal("hide");const a=structuredClone(R).map(l=>l.id==c.id?c:l);a.find(l=>l.id==c.id)||a.push(c),j(a)},k=async({id:s,status:t})=>{await N.status({id:s,status:t})&&j(a=>a.map(l=>(l.id==s&&(l.status=1),l)))},E=async s=>{const{isConfirmed:t}=await G.fire({title:"Estas seguro?",text:"No podras revertir esta accion!",icon:"warning",showCancelButton:!0,confirmButtonText:"Continuar",cancelButtonText:"Cancelar"});!t||!await N.delete(s)||j(a=>a.filter(l=>l.id!=s))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"float-end",children:e.jsxs("button",{className:"btn btn-success btn-sm",onClick:w,children:[e.jsx("i",{className:"fa fa-plus me-1"}),"Agregar producto"]})}),e.jsx("h4",{className:"header-title my-0",children:"Lista de productos"})]}),e.jsxs("div",{className:"card-body",style:{height:"calc(100vh - 160px)",overflowY:"auto"},children:[e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"text-center"})}),e.jsx("div",{className:"d-flex flex-wrap align-items-center justify-content-center gap-3",style:{height:"max-height"},children:R.map((s,t)=>e.jsx(q,{style:{width:"300px",textDecorationLine:s.status==null&&"line-through",opacity:s.status==null&&.5},cardStyle:{border:`1px solid ${s.color}44`,backgroundColor:`${s.color}11`},children:e.jsxs("div",{className:"d-flex justify-content-between gap-2 align-items-start",children:[e.jsx("img",{src:`/storage/images/product/${s.image}`,alt:s.name,className:"rounded",style:{width:"48px",height:"48px",aspectRatio:1,objectFit:"cover",objectPosition:"center"},onError:c=>{c.target.onerror=null,c.target.src="//placehold.co/100x100"}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`${s.ribbon?"ms-4":""} text-truncate line-clamp-2 my-0`,style:{cursor:s.color},children:s.name}),e.jsx("small",{className:"mb-1",style:{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,height:"36px"},children:s.description||"- Sin descripciÃ³n -"}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("b",{children:["S/. ",L(s.price)]}),e.jsx("div",{className:"flex-1 d-flex gap-1 align-items-center",children:s.status==null?e.jsx(g,{content:"Restaurar",children:e.jsx("button",{className:"btn btn-xs btn-soft-dark fas fa-trash-restore",onClick:()=>k({id:s.id,status:!1})})}):e.jsxs(e.Fragment,{children:[e.jsx(g,{content:"Editar",children:e.jsx("button",{className:"btn btn-xs btn-soft-primary fa fa-pen",onClick:()=>w(s)})}),e.jsx(g,{content:"Eliminar",children:e.jsx("button",{className:"btn btn-xs btn-soft-danger fa fa-times",onClick:()=>E(s.id)})})]})})]})]})]})},t))})]})]})})}),e.jsx(M,{modalRef:m,title:C?"Editar producto":"Agregar producto",onSubmit:S,children:e.jsxs("div",{className:"row",id:"main-container",children:[e.jsx("input",{ref:u,type:"hidden"}),e.jsx(O,{eRef:d,label:"Imagen",col:"col-6",onError:"//placehold.co/400x400",aspect:"1"}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"row",children:[e.jsx(v,{eRef:x,label:"Producto",col:"col-12",required:!0}),e.jsx(v,{eRef:f,label:"Precio",col:"col-7",type:"number",step:.01}),e.jsx(v,{eRef:p,label:"Color",col:"col-5",type:"color"}),e.jsx(T,{eRef:h,label:"Descripcion",col:"col-12"})]})})]})})]})};B((n,r)=>{D(n).render(e.jsx(A,{...r,title:"Productos",children:e.jsx(Y,{...r})}))});
