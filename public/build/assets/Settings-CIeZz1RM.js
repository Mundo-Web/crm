var v=Object.defineProperty;var R=(s,e,t)=>e in s?v(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var g=(s,e,t)=>(R(s,typeof e!="symbol"?e+"":e,t),t);import{m as a,r as l,R as o,C as N,c as F}from"./CreateReactScript-vbGM1frk.js";import{R as y}from"./ReactAppend-gizQ1-AH.js";import{A as T}from"./Adminto-BH4vSez6.js";import{M as x}from"./Modal-eo6CSBkF.js";import{T as C,a as S}from"./Table-pvcNzkfZ.js";import{I as h}from"./InputFormGroup-HYuIwuxN.js";const O=(s,e)=>{s.root.innerHTML=e};class m{}g(m,"paginate",async e=>{const{result:t}=await a.Fetch("/api/settings/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});return t}),g(m,"save",async e=>{try{const{status:t,result:n}=await a.Fetch("/api/settings",{method:"POST",body:JSON.stringify(e)});if(!t)throw new Error((n==null?void 0:n.message)||"Ocurrio un error inesperado");return a.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:n.message,type:"success"}),!0}catch(t){return a.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:t.message,type:"danger"}),!1}}),g(m,"status",async({id:e,status:t})=>{try{const{status:n,result:i}=await a.Fetch("/api/settings/status",{method:"PATCH",body:JSON.stringify({id:e,status:t})});if(!n)throw new Error((i==null?void 0:i.message)??"Ocurrio un error inesperado");return a.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:i.message,type:"success"}),!0}catch(n){return a.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:n.message,type:"danger"}),!1}}),g(m,"delete",async e=>{try{const{status:t,result:n}=await a.Fetch(`/api/settings/${e}`,{method:"DELETE"});if(!t)throw new Error((n==null?void 0:n.message)??"Ocurrio un error inesperado");return a.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:n.message,type:"success"}),!0}catch(t){return a.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:t.message,type:"danger"}),!1}});const A=({col:s,label:e,eRef:t,value:n,required:i=!1,rows:d=3,theme:f="snow"})=>{const p=l.useRef();return l.useEffect(()=>{const c=new Quill(p.current,{theme:f,modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}]]}});c.on("text-change",()=>{t.current.value=c.root.innerHTML}),t.editor=c},[null]),o.createElement("div",{className:`form-group ${s} mb-2`,style:{height:"max-content"}},o.createElement("label",{htmlFor:""},e," ",i&&o.createElement("b",{className:"text-danger"},"*")),o.createElement("div",{ref:p,style:{height:"100px"}},n),o.createElement("input",{ref:t,type:"hidden",required:i,rows:d}))},D=({can:s})=>{const e=l.useRef(),t=l.useRef(),n=l.useRef(),i=l.useRef(),d=l.useRef(),f=l.useRef(),[p,c]=l.useState(!1),E=r=>{r!=null&&r.id?c(!0):c(!1),n.current.value=(r==null?void 0:r.id)||null,i.current.value=(r==null?void 0:r.name)||null,O(d.editor,(r==null?void 0:r.value)||null),f.current.value=(r==null?void 0:r.description)||null,$(t.current).modal("show")},b=async r=>{r.preventDefault();const u={id:n.current.value||void 0,name:i.current.value,value:d.current.value,description:f.current.value};await m.save(u)&&($(e.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"))},w=[{name:"whatsapp-new-lead-notification-message"},{name:"whatsapp-new-lead-notification-waid"},{name:"whatsapp-new-lead-notification-message-client"}];return o.createElement(o.Fragment,null,o.createElement(C,{gridRef:e,title:"Configuracion",defaultRows:w,rest:m,toolBar:r=>{r.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Nombre de configuracion"},{dataField:"description",caption:"Descripcion",cellTemplate:(r,{value:u})=>{u?y(r,u):y(r,o.createElement("i",{className:"text-muted"},"- Sin descripcion -"))}},{caption:"Acciones",cellTemplate:(r,{data:u})=>{s("settings","root","all","update")&&y(r,o.createElement(S,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>E(u)},o.createElement("i",{className:"fa fa-pen"})))},allowFiltering:!1,allowExporting:!1}]}),o.createElement(x,{modalRef:t,title:p?"Editar configuracion":"Agregar configuracion",onSubmit:b,size:"md"},o.createElement("div",{className:"row",id:"settings-crud-container"},o.createElement("input",{ref:n,type:"hidden"}),o.createElement(h,{eRef:i,label:"Alias",col:"col-12",required:!0,disabled:!0,readonly:!0}),o.createElement(h,{eRef:f,label:"Descripcion",col:"col-12"}),o.createElement(A,{eRef:d,label:"Valor",col:"col-12",theme:"bubble",required:!0}))))};N((s,e)=>{if(!e.can("settings","root","all","list"))return location.href="/";F(s).render(o.createElement(T,{...e,title:"Constantes de configuracion"},o.createElement(D,{...e})))});
