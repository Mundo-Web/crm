var O=Object.defineProperty;var R=(a,r,d)=>r in a?O(a,r,{enumerable:!0,configurable:!0,writable:!0,value:d}):a[r]=d;var C=(a,r,d)=>R(a,typeof r!="symbol"?r+"":r,d);import{m as w,C as z,c as L,j as e,r as u,G as y,R as V}from"./CreateReactScript-DcwmeAVN.js";import{B as U,A as H,i as G}from"./Adminto-8qxubLRL.js";import{S as q,t as M}from"./sweetalert2.esm.all-BB4SRWjP.js";import{M as J}from"./Modal-C2Wyq7YS.js";import"./Logout-CMhpjQt5.js";class Q extends U{constructor(){super(...arguments);C(this,"path","integrations");C(this,"profile",async d=>{try{const{status:n,result:p}=await w.Fetch(`/api/${this.path}/profile`,{method:"POST",body:JSON.stringify(d)});if(!n)throw new Error((p==null?void 0:p.message)||"Ocurrio un error inesperado");return p.data??!0}catch(n){return w.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:n.message,type:"danger"}),!1}})}}const _=new Q,A={messenger:e.jsx("img",{src:"/assets/img/messenger.svg",alt:"Messenger",style:{height:"200px",width:"auto"}}),instagram:e.jsx("img",{src:"/assets/img/instagram.svg",alt:"Instagram",style:{height:"200px",width:"auto"}}),whatsapp:e.jsx("img",{src:"/assets/img/whatsapp.svg",alt:"WhatsApp",style:{height:"200px",width:"auto"}}),tiktok:e.jsx("img",{src:"/assets/img/tiktok.svg",alt:"TikTok",style:{height:"200px",width:"auto",opacity:.5}}),gmail:e.jsx("img",{src:"/assets/img/gmail.svg",alt:"Gmail",style:{height:"200px",width:"auto"}}),"google-calendar":e.jsx("img",{src:"/assets/img/calendar.svg",alt:"Google Calendar",style:{height:"200px",width:"auto",opacity:.5}}),formularios:e.jsx("img",{src:"/assets/img/website.svg",alt:"Formularios",style:{height:"200px",width:"auto"}})},K=({service:a,icon:r,description:d,integration:n,onIntegrate:p,onUnlink:j})=>{const i=a==="tiktok"||a==="google-calendar";return e.jsx("div",{className:"col-xxl-3 col-xl-4 col-lg-6 col-md-6 ",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mb-3",children:e.jsx("h4",{className:"mt-0 mb-1",children:a.toTitleCase()})}),e.jsx("div",{className:"d-flex align-items-center justify-content-center mb-3",children:e.jsx("div",{className:"",children:e.jsx("span",{className:"avatar-title rounded p-2 d-flex align-items-center justify-content-center text-primary",children:r})})}),n!=null&&n.meta_business_name?e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{className:"avatar-sm rounded-circle me-2",src:`/api/integrations/media/${n.meta_business_profile}`,alt:n.meta_business_name,onError:t=>t.target.src=`//${y.APP_DOMAIN}/api/logo/thumbnail/null`}),e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0",children:n.meta_business_name}),e.jsxs("small",{className:"text-muted",children:[n.leads_count??0," lead(s) generados"]})]})]}),e.jsx(G,{content:"Desvincular",children:e.jsx("button",{className:"btn btn-link text-danger p-0",type:"button",onClick:()=>j(n.id),children:e.jsx("i",{className:"mdi mdi-link-variant-off font-18"})})})]}):e.jsx("button",{className:`btn w-100 ${i?"btn-outline-secondary":"btn-primary"}`,onClick:()=>!i&&p(a),disabled:i,style:i?{cursor:"not-allowed"}:{},children:i?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-clock-outline me-1"}),"Próximamente"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-plus me-1"}),"Integrar ",a.toTitleCase()]})})]})})})},X=({service:a,setService:r,apikey:d,auth_token:n,onClose:p,onSuccess:j})=>{var D,E;const i=u.useRef(null),[t,g]=u.useState(1),[b,N]=u.useState(""),[l,m]=u.useState(""),[c,v]=u.useState(null),[k,I]=u.useState(!1),[S,F]=u.useState(!1),T={messenger:{name:"Messenger",color:"#0084FF",icon:"mdi-facebook-messenger",developer_url:"https://developers.facebook.com/apps",product_name:"Messenger",account_type:"página de Facebook",permissions:"pages_messaging, pages_read_engagement",steps:["Abrir el <strong>Panel de Desarrolladores</strong> de Meta","Crear una nueva aplicación o <em>seleccionar una existente</em>",'Agregar el producto <code>"Messenger"</code> a tu aplicación',"Configurar webhook con la URL proporcionada",'Generar token de página con <span style="color: #0084FF; font-weight: 600;">permisos de mensajería</span>'],authSteps:["Ve a la configuración de tu aplicación en <strong>Meta for Developers</strong>",'Navega a <code>"Messenger"</code> → <em>"Settings"</em> en el menú lateral','Selecciona la <span style="color: #0084FF; font-weight: 600;">página de Facebook</span> que deseas conectar',"Genera un <strong>Page Access Token</strong> con permisos de mensajería","Copia el <code>Page ID</code> y el <code>Access Token</code> generados"]},instagram:{name:"Instagram",color:"#E4405F",icon:"mdi-instagram",developer_url:"https://developers.facebook.com/apps",product_name:"Instagram Basic Display",account_type:"cuenta de Instagram Business",permissions:"instagram_basic, instagram_manage_messages",steps:["Acceder al <strong>Panel de Desarrolladores</strong> de Meta",'Crear aplicación y agregar <code>"Instagram Basic Display"</code>',"Conectar <em>cuenta de Instagram Business</em>","Configurar webhook para recibir mensajes",'Obtener <span style="color: #E4405F; font-weight: 600;">token de acceso</span> de la cuenta'],authSteps:['Accede a <a href="https://developers.facebook.com/apps" target="_blank" style="color: #E4405F; text-decoration: underline;">Meta for Developers</a>','Ve a <code>"Instagram Basic Display"</code> → <em>"Basic Display"</em>',"Conecta tu <strong>cuenta de Instagram Business</strong>",'Genera un <span style="color: #E4405F; font-weight: 600;">User Access Token</span>',"Obtén el <code>Instagram User ID</code> de tu cuenta"]},whatsapp:{name:"WhatsApp",color:"#25D366",icon:"mdi-whatsapp",developer_url:"https://developers.facebook.com/apps",product_name:"WhatsApp Business API",account_type:"cuenta de WhatsApp Business",permissions:"whatsapp_business_messaging",hasImages:!0,steps:[{text:"Dirigirse a la parte superior del Panel Administrativo",image:"/assets/img/whatsapp/paso1.png"},{text:"Seleccionar la opción de configuración de WhatsApp",image:"/assets/img/whatsapp/paso2.png"}],authSteps:[{text:"Configurar la integración con el webhook",image:"/assets/img/whatsapp/paso3.png"},{text:"Verificar la conexión y activar el servicio",image:"/assets/img/whatsapp/paso4.png"}],completedStep:{text:"WhatsApp configurado exitosamente y listo para usar",image:"/assets/img/whatsapp/paso5.jpg"}},tiktok:{name:"TikTok",color:"#FF0050",icon:"mdi-music-note",developer_url:"https://developers.tiktok.com/apps",product_name:"TikTok for Developers",account_type:"cuenta de TikTok Business",permissions:"user.info.basic, video.list",steps:["Crear cuenta en TikTok for Developers","Registrar nueva aplicación","Solicitar permisos de API comercial","Configurar webhook para comentarios","Obtener credenciales de API"],authSteps:['Accede a <a href="https://developers.tiktok.com/apps" target="_blank" style="color: #FF0050; text-decoration: underline;">TikTok for Developers</a>','Ve a tu aplicación → <code>"Authentication"</code>',"Configura <strong>OAuth 2.0</strong> para tu cuenta business","Autoriza la aplicación con tu <em>cuenta de TikTok Business</em>",'Obtén el <span style="color: #FF0050; font-weight: 600;">Access Token</span> y <code>User ID</code>']},gmail:{name:"Gmail",color:"#EA4335",icon:"mdi-gmail",developer_url:"https://console.developers.google.com",product_name:"Gmail API",account_type:"cuenta de Gmail",permissions:"gmail.readonly, gmail.send",hasImages:!0,steps:[{text:"Acceder a Google Cloud Console y crear proyecto",image:"/assets/img/gmail/paso1.png"},{text:"Habilitar Gmail API en el proyecto",image:"/assets/img/gmail/paso2.png"}],authSteps:[{text:"Configurar credenciales OAuth 2.0",image:"/assets/img/gmail/paso3.png"}],completedStep:{text:"Gmail configurado exitosamente y listo para usar",image:"/assets/img/gmail/paso4.jpg"}},"google-calendar":{name:"Google Calendar",color:"#4285F4",icon:"mdi-calendar",developer_url:"https://console.developers.google.com",product_name:"Calendar API",account_type:"cuenta de Google",permissions:"calendar.readonly, calendar.events",steps:["Abrir Google Cloud Console","Habilitar Calendar API en tu proyecto","Configurar credenciales de servicio","Establecer permisos de calendario","Configurar notificaciones push (opcional)"],authSteps:['Accede a <a href="https://console.developers.google.com" target="_blank" style="color: #4285F4; text-decoration: underline;">Google Cloud Console</a>','Ve a <code>"APIs & Services"</code> → <strong>"Calendar API"</strong>',"Configura <em>credenciales OAuth 2.0</em> para tu aplicación",'Autoriza el acceso a <span style="color: #4285F4; font-weight: 600;">tu calendario de Google</span>',"Obtén el <code>Calendar ID</code> y <strong>Access Token</strong> válidos"]},formularios:{name:"Formularios Web",color:"#6C757D",icon:"mdi-form-select",developer_url:"#",product_name:"Webhooks Personalizados",account_type:"formulario web",permissions:"webhook.receive",hasImages:!1,steps:['Dirigirse a la seccion de  <a href="/apikeys">Formulario Externo</a>'],authSteps:["Conecta tu formulario con Atalaya"],completedStep:{text:"Formulario configurado exitosamente y listo para recibir datos",image:null}}},s=T[a]||T.messenger,P=async o=>{w.Clipboard.copy(o,()=>{M("Copiado al portapapeles",{icon:e.jsx("i",{className:"mdi mdi-content-copy"}),description:"El texto ha sido copiado al portapapeles"})})},W=async()=>{I(!0);const o=await _.profile({service:a,accountId:l,accessToken:b});I(!1),o&&v(o)},B=async()=>{F(!0);const o=await _.save({service:a,accountId:l,accessToken:b});F(!1),o&&(j(o),r(null))};return u.useEffect(()=>{a?(g(1),m(""),N(""),v(null),$(i.current).modal("show")):($(i.current).modal("hide"),$(".modal-backdrop").remove())},[a]),u.useEffect(()=>($(i.current).on("hidden.bs.modal",()=>{p(),r(null)}),()=>{$(i.current).off("hidden.bs.modal")}),[null]),e.jsx(J,{modalRef:i,title:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"me-3",children:e.jsx("div",{className:"avatar-md rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:`${s.color}15`,border:`2px solid ${s.color}`},children:A[a]&&V.cloneElement(A[a],{style:{height:"30px",width:"auto",opacity:.8},className:""})})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-0",children:["Integrar ",s.name]}),e.jsxs("small",{className:"text-muted",children:["Conecta tu ",s.account_type," con Atalaya"]})]})]}),bodyClass:"px-4 pt-2 pb-4",hideFooter:!0,onClose:()=>r(null),isStatic:!0,children:e.jsxs("div",{id:"progressbarwizard",children:[a!=="formularios"&&e.jsxs("ul",{className:"nav nav-pills nav-justified form-wizard-header mb-4 rounded-3",style:{backgroundColor:"var(--bs-gray-100)",border:"1px solid var(--bs-border-color)"},children:[e.jsx("li",{className:"nav-item",children:e.jsxs("a",{href:"#account-2","data-bs-toggle":"tab","data-toggle":"tab",className:`nav-link rounded-start border-0 pt-3 pb-3 ${t==1&&"active"}`,onClick:()=>g(1),style:{backgroundColor:t==1?s.color:"transparent",color:t==1?"white":"var(--bs-gray-600)",fontWeight:t==1?"600":"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"mdi mdi-cog me-2"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Configuración"})]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{href:"#profile-tab-2","data-bs-toggle":"tab","data-toggle":"tab",className:`nav-link border-0 pt-3 pb-3 ${t==2&&"active"}`,onClick:()=>g(2),style:{backgroundColor:t==2?s.color:"transparent",color:t==2?"white":"var(--bs-gray-600)",fontWeight:t==2?"600":"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"mdi mdi-key me-2"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Autenticación"})]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{href:"#finish-2","data-bs-toggle":"tab","data-toggle":"tab",className:`nav-link rounded-end border-0 pt-3 pb-3 ${t==3&&"active"} ${a==="whatsapp"||a==="gmail"?"":"disabled"}`,disabled:a!=="whatsapp"&&a!=="gmail",onClick:()=>(a==="whatsapp"||a==="gmail")&&g(3),style:{backgroundColor:t==3?s.color:"transparent",color:t==3?"white":"var(--bs-gray-500)",fontWeight:t==3?"600":"500",transition:"all 0.3s ease",cursor:a==="whatsapp"||a==="gmail"?"pointer":"not-allowed"},children:[e.jsx("i",{className:"mdi mdi-check-circle me-2"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Completado"})]})})]}),e.jsxs("div",{className:"tab-content b-0 mb-0 pt-0",children:[e.jsx("div",{className:`tab-pane ${t==1&&"active"}`,id:"account-2",children:a==="formularios"?e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"alert border-0 rounded-3",style:{backgroundColor:`${s.color}10`,borderLeft:`4px solid ${s.color}`},children:[e.jsxs("h6",{className:"alert-heading d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-2",style:{width:"32px",height:"32px",backgroundColor:s.color,color:"white"},children:e.jsx("i",{className:"mdi mdi-information fs-6"})}),"Configuración de ",s.name]}),e.jsx("div",{className:"mb-0 ps-3",children:s.steps.map((o,h)=>e.jsx("div",{className:"mb-2",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:o}})},h))})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsxs("button",{type:"button",className:"btn px-4",style:{backgroundColor:s.color,borderColor:s.color,color:"white"},onClick:()=>r(null),children:[e.jsx("i",{className:"mdi mdi-check me-2"}),"Cerrar"]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"alert border-0 rounded-3",style:{backgroundColor:`${s.color}10`,borderLeft:`4px solid ${s.color}`},children:[e.jsxs("h6",{className:"alert-heading d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-2",style:{width:"32px",height:"32px",backgroundColor:s.color,color:"white"},children:e.jsx("i",{className:"mdi mdi-information fs-6"})}),"Pasos previos requeridos"]}),e.jsx("ol",{className:"mb-0 ps-3",children:s.steps.map((o,h)=>{if(s.hasImages&&typeof o=="object")return e.jsx("li",{className:"mb-4",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:o.text},className:"mb-2"}),e.jsxs("div",{className:"border rounded-3 overflow-hidden",style:{maxWidth:"100%"},children:[e.jsx("img",{src:o.image,alt:`Paso ${h+1} - WhatsApp`,className:"img-fluid",style:{width:"100%",height:"auto"},onError:x=>{x.target.style.display="none",x.target.nextSibling.style.display="block"}}),e.jsxs("div",{className:"text-center p-3 text-muted",style:{display:"none"},children:[e.jsx("i",{className:"mdi mdi-image-off-outline fs-4 mb-2"}),e.jsx("br",{}),"Imagen no disponible"]})]})]})},h);let f=o;return typeof o=="string"&&(o.includes("Panel de Desarrolladores")||o.includes("Console"))&&(f=o.replace(/Panel de Desarrolladores|Console/g,x=>`<a href="${s.developer_url}" target="_blank" style="color: ${s.color}; font-weight: 500; text-decoration: underline;">${x}</a>`)),e.jsxs("li",{className:"mb-2",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:f}}),typeof o=="string"&&o.includes("permisos")&&e.jsx("div",{className:"mt-1",children:e.jsx("code",{className:"small px-2 py-1 rounded",style:{backgroundColor:"var(--bs-gray-100)",color:"var(--bs-gray-800)",fontSize:"0.75rem"},children:s.permissions})})]},h)})}),a!=="whatsapp"||a!=="gmail"&&s.developer_url!=="#"&&e.jsx("div",{className:"mt-3 pt-3 border-top",style:{borderColor:`${s.color}30`},children:e.jsxs("a",{href:s.developer_url,target:"_blank",className:"btn btn-sm",style:{backgroundColor:s.color,borderColor:s.color,color:"white"},children:[e.jsx("i",{className:"mdi mdi-open-in-new me-1"}),"Abrir Panel de Desarrolladores"]})})]}),a!=="whatsapp"&&a!=="gmail"&&a!=="formularios"&&e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{className:"form-label fw-semibold d-flex align-items-center",children:[e.jsx("i",{className:"mdi mdi-link me-2",style:{color:s.color}}),"URL de Callback:"]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",className:"form-control border-2",value:`${y.APP_URL}/meta/${a}/${d}`,readOnly:!0,style:{backgroundColor:"var(--bs-gray-50)",borderColor:"var(--bs-border-color)",color:"var(--bs-body-color)"}}),e.jsx("button",{type:"button",className:"btn border-2",style:{borderColor:s.color,color:s.color,backgroundColor:"var(--bs-body-bg)"},onClick:()=>P(`${y.APP_URL}/meta/${a}/${d}`),children:e.jsx("i",{className:"mdi mdi-content-copy"})})]})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{className:"form-label fw-semibold d-flex align-items-center",children:[e.jsx("i",{className:"mdi mdi-shield-check me-2",style:{color:s.color}}),"Token de Verificación:"]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",className:"form-control border-2",value:n,readOnly:!0,style:{backgroundColor:"var(--bs-gray-50)",borderColor:"var(--bs-border-color)",color:"var(--bs-body-color)"}}),e.jsx("button",{type:"button",className:"btn border-2",style:{borderColor:s.color,color:s.color,backgroundColor:"var(--bs-body-bg)"},onClick:()=>P(n),children:e.jsx("i",{className:"mdi mdi-content-copy"})})]})]})]})]})}),e.jsxs("div",{className:`tab-pane ${t==2&&"active"}`,id:"profile-tab-2",children:[e.jsxs("div",{className:"alert border-0 rounded-3",style:{backgroundColor:`${s.color}10`,borderLeft:`4px solid ${s.color}`},children:[e.jsxs("h6",{className:"alert-heading d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-2",style:{width:"32px",height:"32px",backgroundColor:s.color,color:"white"},children:e.jsx("i",{className:"mdi mdi-key fs-6"})}),"Obtener credenciales de ",s.name]}),e.jsx("ol",{className:"mb-0 ps-3",children:s.authSteps.map((o,h)=>{if(s.hasImages&&typeof o=="object")return e.jsx("li",{className:"mb-4",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:o.text},className:"mb-2"}),e.jsxs("div",{className:"border rounded-3 overflow-hidden",style:{maxWidth:"100%"},children:[e.jsx("img",{src:o.image,alt:`Autenticación paso ${h+1} - WhatsApp`,className:"img-fluid",style:{width:"100%",height:"auto"},onError:x=>{x.target.style.display="none",x.target.nextSibling.style.display="block"}}),e.jsxs("div",{className:"text-center p-3 text-muted",style:{display:"none"},children:[e.jsx("i",{className:"mdi mdi-image-off-outline fs-4 mb-2"}),e.jsx("br",{}),"Imagen no disponible"]})]})]})},h);let f=o;return typeof o=="string"&&(o.includes("Panel de Desarrolladores")||o.includes("Console"))&&(f=o.replace(/Panel de Desarrolladores|Console/g,x=>`<a href="${s.developer_url}" target="_blank" style="color: ${s.color}; font-weight: 500; text-decoration: underline;">${x}</a>`)),e.jsx("li",{className:"mb-2",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:f}})},h)})})]}),a!=="whatsapp"&&a!=="gmail"&&a!=="formularios"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{className:"form-label fw-semibold d-flex align-items-center",children:[e.jsx("i",{className:"mdi mdi-account me-2",style:{color:s.color}}),"ID de la ",s.account_type,":"]}),e.jsx("input",{type:"text",className:"form-control border-2",value:l,onChange:o=>m(o.target.value),placeholder:"Ej: 123456789",disabled:!!c,style:{borderColor:c?"#28a745":"var(--bs-border-color)",backgroundColor:c?"#d4edda":"var(--bs-body-bg)",color:"var(--bs-body-color)"}})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{className:"form-label fw-semibold d-flex align-items-center",children:[e.jsx("i",{className:"mdi mdi-key-variant me-2",style:{color:s.color}}),"Access Token:"]}),e.jsx("input",{type:"text",className:"form-control border-2",value:b,onChange:o=>N(o.target.value),placeholder:"Pega aquí tu Access Token",disabled:!!c,style:{borderColor:c?"#28a745":"var(--bs-border-color)",backgroundColor:c?"#d4edda":"var(--bs-body-bg)",color:"var(--bs-body-color)"}})]})]}),e.jsx("div",{className:"mt-4",children:c?e.jsxs("div",{className:"alert alert-success border-0 rounded-3",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{className:"avatar-md rounded-circle me-3 border",src:((E=(D=c.picture)==null?void 0:D.data)==null?void 0:E.url)||c.profile_pic||"/assets/img/default-avatar.png",alt:c.name,onError:o=>o.target.src=`//${y.APP_DOMAIN}/api/logo/thumbnail/null`}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-1",children:c.name}),e.jsxs("small",{className:"text-muted",children:["@",c.username||c.id]})]}),e.jsx("div",{className:"text-success",children:e.jsx("i",{className:"mdi mdi-check-circle fs-4"})})]}),e.jsxs("div",{className:"mt-3 pt-3 border-top",children:[e.jsx("i",{className:"mdi mdi-check-circle me-1"}),e.jsx("small",{children:"Cuenta verificada exitosamente y lista para integrar"})]})]}):e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",className:"btn btn-lg px-4 py-2",style:{backgroundColor:s.color,borderColor:s.color,color:"white"},onClick:W,disabled:k||!l||!b,children:k?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-loading mdi-spin me-2"}),"Verificando cuenta..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-check-circle me-2"}),"Verificar cuenta"]})})})})]})]}),e.jsx("div",{className:`tab-pane ${t==3&&"active"}`,id:"finish-2",children:(a==="whatsapp"||a==="gmail"||a==="formularios")&&s.completedStep?e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"avatar-xl rounded-circle d-flex align-items-center justify-content-center mx-auto mb-3",style:{backgroundColor:`${s.color}15`,border:`3px solid ${s.color}`},children:e.jsx("i",{className:"mdi mdi-check-all fs-1",style:{color:s.color}})}),e.jsxs("h3",{className:"text-success",children:["¡",s.name," Configurado!"]})]}),e.jsxs("div",{className:"alert border-0 rounded-3",style:{backgroundColor:`${s.color}10`,borderLeft:`4px solid ${s.color}`},children:[e.jsxs("h6",{className:"alert-heading d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-2",style:{width:"32px",height:"32px",backgroundColor:s.color,color:"white"},children:e.jsx("i",{className:"mdi mdi-check-circle fs-6"})}),"Configuración finalizada"]}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:s.completedStep.text},className:"mb-3"}),s.completedStep.image&&e.jsxs("div",{className:"border rounded-3 overflow-hidden",style:{maxWidth:"100%"},children:[e.jsx("img",{src:s.completedStep.image,alt:`${s.name} configurado exitosamente`,className:"img-fluid",style:{width:"100%",height:"auto"},onError:o=>{o.target.style.display="none",o.target.nextSibling.style.display="block"}}),e.jsxs("div",{className:"text-center p-3 text-muted",style:{display:"none"},children:[e.jsx("i",{className:"mdi mdi-image-off-outline fs-4 mb-2"}),e.jsx("br",{}),"Imagen no disponible"]})]})]})]}),e.jsxs("p",{className:"text-muted",children:[s.name," está ahora completamente configurado y listo para usar."]})]}):e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"avatar-xl rounded-circle d-flex align-items-center justify-content-center mx-auto mb-3",style:{backgroundColor:`${s.color}15`,border:`3px solid ${s.color}`},children:e.jsx("i",{className:"mdi mdi-check-all fs-1",style:{color:s.color}})}),e.jsx("h3",{className:"text-success",children:"¡Integración Completada!"})]}),e.jsxs("div",{className:"alert alert-success border-0 rounded-3 text-start",children:[e.jsxs("h6",{className:"alert-heading d-flex align-items-center",children:[e.jsx("i",{className:"mdi mdi-rocket me-2"}),"¿Qué puedes hacer ahora?"]}),e.jsxs("ul",{className:"mb-0 ps-3",children:[e.jsx("li",{children:"Gestionar conversaciones desde el panel principal"}),e.jsx("li",{children:"Recibir notificaciones en tiempo real"}),e.jsx("li",{children:"Automatizar respuestas con IA"}),e.jsx("li",{children:"Generar reportes de engagement"})]})]}),e.jsxs("p",{className:"text-muted",children:["Tu ",s.account_type," está ahora conectada con ",y.APP_NAME,". Todas las interacciones se sincronizarán automáticamente."]})]})}),e.jsx("div",{className:"d-flex justify-content-between align-items-center mt-4 pt-3 border-top",children:a!=="formularios"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{children:t>1&&e.jsxs("button",{type:"button",className:"btn btn-outline-secondary px-4",onClick:()=>g(o=>--o),children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"Anterior"]})}),e.jsx("div",{className:"text-center flex-grow-1",children:e.jsxs("small",{className:"text-muted",children:["Paso ",t," de 3"]})}),e.jsxs("div",{children:[t==1&&e.jsxs("button",{type:"button",className:"btn px-4",style:{backgroundColor:s.color,borderColor:s.color,color:"white"},onClick:()=>g(o=>++o),children:["Siguiente",e.jsx("i",{className:"mdi mdi-arrow-right ms-1"})]}),t==2&&(a==="whatsapp"||a==="gmail"||a==="formularios"?e.jsxs("button",{type:"button",className:"btn px-4",style:{backgroundColor:s.color,borderColor:s.color,color:"white"},onClick:()=>g(3),children:["Finalizar",e.jsx("i",{className:"mdi mdi-arrow-right ms-1"})]}):c?e.jsx("button",{type:"button",className:"btn px-4",style:{backgroundColor:s.color,borderColor:s.color,color:"white"},onClick:()=>B(),disabled:S,children:S?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-spin mdi-loading me-1"}),"Integrando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-plus me-1"}),"Finalizar"]})}):e.jsx(G,{content:"Verifica la cuenta primero",children:e.jsxs("button",{type:"button",className:"btn btn-outline-secondary px-4",disabled:!0,children:[e.jsx("i",{className:"mdi mdi-plus me-1"}),"Finalizar"]})})),t==3&&(a==="whatsapp"||a==="gmail"||a==="formularios")&&e.jsxs("button",{type:"button",className:"btn px-4",style:{backgroundColor:s.color,borderColor:s.color,color:"white"},onClick:()=>r(null),children:[e.jsx("i",{className:"mdi mdi-check me-2"}),"Cerrar"]})]})]})})]})]})})},Y=({apikey:a,auth_token:r,integrations:d})=>{const[n,p]=u.useState(d),[j,i]=u.useState(null),t={messenger:"Integra tu página de Facebook para recibir y responder mensajes directamente desde Atalaya.",instagram:"Conecta tu cuenta de Instagram para gestionar mensajes directos y comentarios desde Atalaya.",whatsapp:"Conecta tu cuenta de WhatsApp Business para gestionar mensajes desde Atalaya.",tiktok:"Integra tu cuenta de TikTok para gestionar comentarios y mensajes desde Atalaya.",gmail:"Conecta tu cuenta de Gmail para gestionar correos electrónicos desde Atalaya.","google-calendar":"Integra Google Calendar para gestionar citas y eventos desde Atalaya.",formularios:"Conecta formularios web para recibir leads directamente en Atalaya."},g=l=>{p(m=>[...m,l])},b=async l=>{const{isConfirmed:m}=await q.fire({title:"¿Estás seguro?",text:"Esta acción desvinculará la integración. ¿Deseas continuar?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, desvincular",cancelButtonText:"Cancelar",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"});if(!m)return;await _.delete(l)&&(p(v=>v.filter(k=>k.id!==l)),M.success("Integración desvinculada exitosamente"))},N=n.reduce((l,m)=>(l[m.meta_service]||(l[m.meta_service]=m),l),{});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"row",children:Object.entries(A).map(([l,m])=>e.jsx(K,{service:l,icon:m,description:t[l],integration:N[l],onIntegrate:i,onUnlink:b},l))})}),e.jsx(X,{service:j,setService:i,apikey:a,auth_token:r,onClose:()=>i(null),onSuccess:g})]})};z((a,r)=>{L(a).render(e.jsx(H,{...r,title:"Redes Sociales",children:e.jsx(Y,{...r})}))});
