var j=Object.defineProperty;var b=(e,a,l)=>a in e?j(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l;var p=(e,a,l)=>b(e,typeof a!="symbol"?a+"":a,l);import{C as g,c as f,j as s,r,G as h}from"./CreateReactScript-YnZ-kYcA.js";import{B as v,A as k}from"./Adminto-q7KHnKeW.js";import"./sweetalert2.esm.all-vWusNgk2.js";import{M as N}from"./Modal-Dt0TK3Cw.js";class C extends v{constructor(){super(...arguments);p(this,"path","integrations")}}new C;const y={messenger:"mdi-facebook-messenger",instagram:"mdi-instagram"},I=({service:e,icon:a,description:l,integration:i,onIntegrate:d})=>s.jsx("div",{className:"col-xxl-3 col-xl-4 col-lg-6 col-md-6 ",children:s.jsx("div",{className:"card",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:"avatar-sm me-3",children:s.jsx("span",{className:"avatar-title bg-soft-primary rounded px-2",children:s.jsx("i",{className:`mdi ${a} font-22 text-primary`})})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h4",{className:"mt-0 mb-1",children:e.toTitleCase()}),s.jsx("p",{className:"text-muted mb-0",children:l})]})]}),i!=null&&i.meta_business_name?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("img",{className:"avatar-sm rounded-circle me-2",src:`/api/integrations/media/${i.meta_business_profile}`,alt:i.meta_business_name,onError:o=>o.target.src=`//${h.APP_DOMAIN}/api/logo/thumbnail/null`}),s.jsxs("div",{children:[s.jsx("h5",{className:"mb-0",children:i.meta_business_name}),s.jsxs("small",{className:"text-muted",children:[i.meta_leads," leads generados"]})]})]}):s.jsxs("button",{className:"btn btn-primary w-100",onClick:()=>d(e),children:[s.jsx("i",{className:"mdi mdi-plus me-1"}),"Integrar ",e.toTitleCase()]})]})})}),S=({service:e,setService:a,apikey:l,auth_token:i,onClose:d,onSuccess:o})=>{const t=r.useRef(null),[u,m]=r.useState(1),[x,n]=r.useState("");return r.useEffect(()=>{e?(m(1),n(""),$(t.current).modal("show")):$(t.current).modal("hide")},[e]),r.useEffect(()=>($(t.current).on("hidden.bs.modal",()=>{d(),a(null)}),()=>{$(t.current).off("hidden.bs.modal")}),[null]),console.log(e),s.jsx(N,{modalRef:t,title:`Integrar ${e==null?void 0:e.toTitleCase()}`,bodyClass:"px-3 pt-0 pb-3",hideFooter:!0,children:s.jsxs("div",{id:"progressbarwizard",children:[s.jsxs("ul",{class:"nav nav-pills bg-light nav-justified form-wizard-header mb-3",children:[s.jsx("li",{class:"nav-item",children:s.jsxs("a",{href:"#account-2","data-bs-toggle":"tab","data-toggle":"tab",class:"nav-link rounded-0 pt-2 pb-2 active",children:[s.jsx("i",{class:"mdi mdi-application me-1"}),s.jsx("span",{class:"d-none d-sm-inline",children:"Crear aplicación"})]})}),s.jsx("li",{class:"nav-item",children:s.jsxs("a",{href:"#profile-tab-2","data-bs-toggle":"tab","data-toggle":"tab",class:"nav-link rounded-0 pt-2 pb-2",children:[s.jsx("i",{class:"mdi mdi-identifier me-1"}),s.jsx("span",{class:"d-none d-sm-inline",children:"Generar un Token"})]})}),s.jsx("li",{class:"nav-item",children:s.jsxs("a",{href:"#finish-2","data-bs-toggle":"tab","data-toggle":"tab",class:"nav-link rounded-0 pt-2 pb-2",children:[s.jsx("i",{class:"mdi mdi-checkbox-marked-circle-outline me-1"}),s.jsx("span",{class:"d-none d-sm-inline",children:"Listo para generar"})]})})]}),s.jsxs("div",{class:"tab-content b-0 mb-0 pt-0",children:[s.jsxs("div",{class:"tab-pane active",id:"account-2",children:[s.jsxs("p",{children:["Para integrar ",e==null?void 0:e.toTitleCase(),", primero debes:"]}),s.jsxs("ol",{children:[s.jsxs("li",{children:["Abrir el ",s.jsx("a",{href:"https://developers.facebook.com/apps",target:"_blank",children:"Panel de Aplicaciones de Meta"})]}),s.jsx("li",{children:"Crear una nueva aplicación o seleccionar una existente"}),s.jsxs("li",{children:['Habilitar el producto "',e==="messenger"?"Messenger":"Instagram",'"']}),s.jsx("li",{children:"Configurar los permisos necesarios"})]}),s.jsx("p",{children:"Copia y pega estos datos en la configuración de webhook de tu aplicación:"}),s.jsxs("div",{className:"form-group mb-3",children:[s.jsx("label",{children:"URL de Callback:"}),s.jsxs("div",{className:"input-group",children:[s.jsx("input",{type:"text",className:"form-control",value:`${h.APP_URL}/meta/${e}/${l}`,readOnly:!0}),s.jsx("button",{className:"btn btn-secondary",onClick:()=>onCopyClicked(`${h.APP_URL}/meta/${e}/${l}`),children:s.jsx("i",{className:"mdi mdi-content-copy"})})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Token de Verificación:"}),s.jsxs("div",{className:"input-group",children:[s.jsx("input",{type:"text",className:"form-control",value:i,readOnly:!0}),s.jsx("button",{className:"btn btn-secondary",onClick:()=>onCopyClicked(i),children:s.jsx("i",{className:"mdi mdi-content-copy"})})]})]})]}),s.jsxs("div",{class:"tab-pane",id:"profile-tab-2",children:[s.jsx("p",{children:"Ingresa el Access Token generado para verificar la conexión:"}),s.jsx("div",{className:"form-group",children:s.jsx("input",{type:"text",className:"form-control",value:x,onChange:c=>n(c.target.value),placeholder:"Pega aquí tu Access Token"})}),s.jsx("h4",{children:"Previsualizacion de la cuenta asociada al token"})]}),s.jsx("div",{class:"tab-pane",id:"finish-2",children:s.jsx("div",{class:"row",children:s.jsx("div",{class:"col-12",children:s.jsxs("div",{class:"text-center",children:[s.jsx("h2",{class:"mt-0",children:s.jsx("i",{class:"mdi mdi-check-all"})}),s.jsx("h3",{class:"mt-0",children:"Thank you !"}),s.jsx("p",{class:"w-75 mb-2 mx-auto",children:"Quisque nec turpis at urna dictum luctus. Suspendisse convallis dignissim eros at volutpat. In egestas mattis dui. Aliquam mattis dictum aliquet."}),s.jsx("div",{class:"mb-3",children:s.jsxs("div",{class:"form-check d-inline-block",children:[s.jsx("input",{type:"checkbox",class:"form-check-input",id:"customCheck3"}),s.jsx("label",{class:"form-check-label",for:"customCheck3",children:"I agree with the Terms and Conditions"})]})})]})})})}),s.jsxs("ul",{class:"list-inline mb-0 wizard mt-3",children:[s.jsx("li",{class:"previous list-inline-item disabled",children:s.jsx("a",{href:"javascript: void(0);",class:"btn btn-secondary",children:"Previous"})}),s.jsx("li",{class:"next list-inline-item float-end",children:s.jsx("a",{href:"javascript: void(0);",class:"btn btn-secondary",children:"Next"})})]})]})]})})},_=({apikey:e,auth_token:a,integrations:l})=>{const[i,d]=r.useState(l),[o,t]=r.useState(null),u={messenger:"Integra tu página de Facebook para recibir y responder mensajes directamente desde Atalaya.",instagram:"Conecta tu cuenta de Instagram para gestionar mensajes directos y comentarios."},m=n=>{d(c=>[...c,n])},x=i.reduce((n,c)=>(n[c.meta_service]||(n[c.meta_service]=c),n),{});return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"container-fluid",children:s.jsx("div",{className:"row",children:Object.entries(y).map(([n,c])=>s.jsx(I,{service:n,icon:c,description:u[n],integration:x[n],onIntegrate:t},n))})}),s.jsx(S,{service:o,setService:t,apikey:e,auth_token:a,onClose:()=>t(null),onSuccess:m})]})};g((e,a)=>{f(e).render(s.jsx(k,{...a,title:"Integraciones - Webhooks",children:s.jsx(_,{...a})}))});
