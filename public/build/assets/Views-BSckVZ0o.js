var y=Object.defineProperty;var k=(l,a,r)=>a in l?y(l,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[a]=r;var p=(l,a,r)=>k(l,typeof a!="symbol"?a+"":a,r);import{C as g,c as R,j as e,r as i}from"./CreateReactScript-CgEuCtoy.js";import{B as C,A as V}from"./Adminto-CGPua8W5.js";import{M as F}from"./Modal-Dp_0-Qk7.js";import{I as W}from"./InputFormGroup-CWxYSLYW.js";import{T as O}from"./TextareaFormGroup-rQZ0nV4r.js";import"./sweetalert2.esm.all-DJ5rN5x4.js";class S extends C{constructor(){super(...arguments);p(this,"path","views")}}const f=new S,B=({tables:l,views:a,statuses:r})=>{const c=i.useRef(),m=i.useRef(),n=i.useRef(),o=i.useRef(),d=i.useRef(),[u,j]=i.useState(null);i.useEffect(()=>{x()},[null]);const b=()=>{n.current.value=null,o.current.value=null,d.current.value=null,$('[name="ck-status"]').prop("checked",!1),$(m.current).modal("show")},x=s=>{var t;j((t=c==null?void 0:c.current)==null?void 0:t.value)},v=async s=>{s.preventDefault();const t={id:n.current.value??void 0,table_id:c.current.value,name:o.current.value,description:d.current.value,statuses:[...$('[name="ck-status"]:checked')].map(w=>w.value)};await f.save(t)&&location.reload()},N=async s=>{await f.delete(s.id)&&location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{minHeight:"calc(100vh - 135px)"},children:e.jsxs("div",{style:{width:"100%"},children:[e.jsx("div",{className:"mx-auto form-group",style:{width:"240px"},children:e.jsxs("div",{className:"form-floating mb-3",children:[e.jsx("select",{ref:c,className:"form-select",id:"view-select","aria-label":"Crea vistas para",onChange:x,children:l.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},`table-${t}`))}),e.jsx("label",{htmlFor:"view-select",children:"Crea vistas para"})]})}),e.jsx("hr",{className:"mx-auto",style:{width:"180px"}}),e.jsxs("button",{className:"d-block m-auto btn btn-white rounded-pill mb-3",onClick:b,children:[e.jsx("i",{className:"mdi mdi-plus"})," Nuevo"]}),e.jsx("div",{className:"d-flex flex-wrap align-items-center justify-content-center gap-3 mb-3",style:{width:"100%"},children:a.filter(s=>s.table_id==u).map((s,t)=>e.jsx("div",{className:"card mb-0",style:{width:"100%",maxWidth:"360px"},children:e.jsxs("div",{className:"card-body project-box",children:[e.jsxs("div",{className:"float-end",children:[e.jsx("button",{className:"btn btn-xs btn-white ms-1",children:e.jsx("i",{className:"fa fa-pen"})}),e.jsx("button",{className:"btn btn-xs btn-danger ms-1",onClick:()=>N(s),children:e.jsx("i",{className:"fa fa-trash"})})]}),e.jsx("h4",{className:"mt-0",children:e.jsxs("a",{href:`/clients/${s.id}`,className:"text-dark",children:[s.name," ",e.jsx("i",{className:"mdi mdi-arrow-top-right"})]})}),e.jsx("div",{className:"mb-2",children:e.jsx("code",{children:s.id})}),e.jsx("p",{className:"text-muted font-13",style:{display:"-webkit-box",WebkitLineClamp:2,textOverflow:"ellipsis",WebkitBoxOrient:"vertical",overflow:"hidden",height:"38px"},children:s.description||e.jsx("i",{className:"text-muted",children:"- Sin descripcion -"})}),e.jsxs("div",{className:"project-members mb-0",children:[e.jsx("h5",{className:"mb-1",children:"Estados filtrados:"}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:e.jsxs("p",{className:"mb-0 font-13",style:{display:"-webkit-box",WebkitLineClamp:2,textOverflow:"ellipsis",WebkitBoxOrient:"vertical",overflow:"hidden",height:"38px"},children:[s.statuses.length>0?s.statuses.map(({name:h})=>h).join(", "):e.jsx("i",{className:"text-muted",children:"No se han seleccionado filtros de estado para esta vista"}),"."]},`status-${t}`)})]})]})},`service-${t}`))})]})}),e.jsxs(F,{modalRef:m,title:"Agregar vista",size:"sm",onSubmit:v,children:[e.jsx("input",{ref:n,type:"hidden"}),e.jsx(W,{eRef:o,label:"Nombre",required:!0}),e.jsx(O,{eRef:d,label:"Descripcion"}),e.jsx("hr",{className:"my-2"}),e.jsxs("h5",{children:["Filtro de estados ",e.jsx("small",{className:"text-muted",style:{fontWeight:"normal"},children:"Que estados quieres filtrar en esta vista"})]}),e.jsx("div",{className:"d-flex flex-wrap justify-content-center gap-2",children:r.filter(s=>s.table.id==u).map((s,t)=>e.jsxs("div",{className:"form-check form-check-success",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",name:"ck-status",value:s.id,id:`status-${t}`,style:{cursor:"pointer"}}),e.jsx("label",{className:"form-check-label",htmlFor:`status-${t}`,style:{cursor:"pointer"},children:s.name})]},`status-${t}`))})]})]})};g((l,a)=>{R(l).render(e.jsx(V,{...a,title:"Vistas de usuario",children:e.jsx(B,{...a})}))});
