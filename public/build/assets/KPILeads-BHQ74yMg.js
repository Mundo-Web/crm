var q=Object.defineProperty;var Y=(c,a,l)=>a in c?q(c,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[a]=l;var u=(c,a,l)=>(Y(c,typeof a!="symbol"?a+"":a,l),l);import{m as R,C as k,c as F,R as e,r}from"./CreateReactScript-DiMSE74L.js";import{A as T}from"./Adminto-Cg0uEWCF.js";import{S as A}from"./SelectFormGroup-1DdRYKS8.js";import{r as G}from"./server.browser-BzA2yPSr.js";class E{}u(E,"kpi",async a=>{const{result:l}=await R.Fetch(`/api/dashboard/leads/kpi/${a}`);return{data:(l==null?void 0:l.data)??[],summary:(l==null?void 0:l.summary)??{}}});const L=({months:c=[],currentMonth:a,currentYear:l})=>{const v=moment({month:a-1,year:l}).format("MMMM YYYY"),[o,g]=r.useState(`${l}-${a}`),[p,N]=r.useState([]),[y,h]=r.useState([]),[f,x]=r.useState(0),[C,b]=r.useState(0),[S,M]=r.useState(0),[w,_]=r.useState(0),i=({id:t,text:s,element:n})=>{if(!t)return s;const m=$(n).data("option");return $(G(e.createElement("div",null,e.createElement("b",{className:"d-block"},s),e.createElement("small",null,e.createElement("i",{className:"me-1 fa fa-users"}),m.quantity," entradas"))))};return r.useEffect(()=>{console.log(o),E.kpi(o).then(({data:t,summary:s})=>{h(t),N(s.grouped??[]),x(s.totalCount??0),b(s.clientsCount??0),M(s.archivedCount??0),_(s.managingCount??0)})},[o]),e.createElement(e.Fragment,null,e.createElement("div",{className:"row"},e.createElement("div",{className:"col-xl-3 col-lg-4 col-md-6 col-sm-8 col-12 mb-2"},e.createElement(A,{minimumResultsForSearch:-1,templateResult:i,templateSelection:i,onChange:t=>g(t.target.value)},c.map((t,s)=>{const n=moment({month:t.month-1,year:t.year});return e.createElement("option",{key:s,value:t.id,"data-option":JSON.stringify(t),selected:o==t.id},n.format("MMMM YYYY").toTitleCase())})))),e.createElement("div",{className:"row"},e.createElement("div",{className:"col-xl-3 col-md-6"},e.createElement("div",{className:"card"},e.createElement("div",{className:"card-body widget-user"},e.createElement("div",{className:"text-center"},e.createElement("h2",{className:"fw-normal text-info","data-plugin":"counterup"},f),e.createElement("h5",null,"Leads - ",v))))),e.createElement("div",{className:"col-xl-3 col-md-6"},e.createElement("div",{className:"card"},e.createElement("div",{className:"card-body widget-user"},e.createElement("div",{className:"text-center"},e.createElement("h2",{className:"fw-normal text-success","data-plugin":"counterup"},C),e.createElement("h5",null,"Convertidos"))))),e.createElement("div",{className:"col-xl-3 col-md-6"},e.createElement("div",{className:"card"},e.createElement("div",{className:"card-body widget-user"},e.createElement("div",{className:"text-center"},e.createElement("h2",{className:"fw-normal text-danger","data-plugin":"counterup"},S),e.createElement("h5",null,"No convertidos"))))),e.createElement("div",{className:"col-xl-3 col-md-6"},e.createElement("div",{className:"card"},e.createElement("div",{className:"card-body widget-user"},e.createElement("div",{className:"text-center"},e.createElement("h2",{className:"fw-normal text-primary","data-plugin":"counterup"},w),e.createElement("h5",null,"En gestion")))))),e.createElement("div",{className:"row"},e.createElement("div",{className:"col-12"},e.createElement("div",{className:"d-flex gap-1 mb-3",style:{overflowX:"auto"}},p.map((t,s)=>e.createElement("div",{key:s,className:"card",style:{minWidth:"270px",maxWidth:"270px"}},e.createElement("div",{className:"card-header"},e.createElement("div",{className:"float-end"},e.createElement("b",null,t.quantity)),e.createElement("h4",{className:"header-title my-0 text-truncate",style:{color:t.color}},t.name)),e.createElement("div",{className:"card-body"},e.createElement("div",{className:"d-flex gap-3 flex-column"},y.filter(({status_id:n})=>n==t.id).sort((n,m)=>m.quantity-n.quantity).map((n,m)=>{const d=(n.quantity/t.quantity*100).toFixed(2);return e.createElement("div",{key:m},e.createElement("h5",{className:"my-0"},n.manage_status_name," ",e.createElement("span",{className:"float-end",style:{color:n.manage_status_color}},n.quantity)),e.createElement("div",{className:"progress progress-bar-alt-primary progress-sm mt-0",style:{backgroundColor:`${n.manage_status_color}44`}},e.createElement("div",{className:"progress-bar progress-animated wow animated animated",role:"progressbar","aria-valuenow":d,"aria-valuemin":"0","aria-valuemax":"100",style:{width:`${d}%`,visibility:"visible",animationName:"animationProgress",backgroundColor:n.manage_status_color}})))})))))))))};k((c,a)=>{F(c).render(e.createElement(T,{...a,title:"KPI - Leads"},e.createElement(L,{...a})))});
