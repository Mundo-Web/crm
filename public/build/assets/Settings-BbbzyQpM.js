var de=Object.defineProperty;var ue=(s,t,r)=>t in s?de(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var K=(s,t,r)=>ue(s,typeof t!="symbol"?t+"":t,r);import{r as v,j as e,C as pe,c as me}from"./CreateReactScript-DkPHjjj8.js";import{B as fe,A as he}from"./Adminto-mifwD4qb.js";import{M as z}from"./Modal-Db-IUAew.js";import{Q as ve}from"./QuillFormGroup-cXoE68lr.js";/* empty css                    */import{S as D}from"./SelectFormGroup-CYqBXbWv.js";import{p as a}from"./index-NXiu0Ygb.js";import{T as be}from"./TextareaFormGroup-CZSGMUbb.js";import"./Logout-8TYPfS2o.js";import"./sweetalert2.esm.all-DXx0rc8u.js";class Y extends fe{constructor(){super(...arguments);K(this,"path","settings")}}var F=function(){return F=Object.assign||function(s){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(s[o]=t[o])}return s},F.apply(this,arguments)},Z={onActivate:a.func,onAddUndo:a.func,onBeforeAddUndo:a.func,onBeforeExecCommand:a.func,onBeforeGetContent:a.func,onBeforeRenderUI:a.func,onBeforeSetContent:a.func,onBeforePaste:a.func,onBlur:a.func,onChange:a.func,onClearUndos:a.func,onClick:a.func,onContextMenu:a.func,onCommentChange:a.func,onCompositionEnd:a.func,onCompositionStart:a.func,onCompositionUpdate:a.func,onCopy:a.func,onCut:a.func,onDblclick:a.func,onDeactivate:a.func,onDirty:a.func,onDrag:a.func,onDragDrop:a.func,onDragEnd:a.func,onDragGesture:a.func,onDragOver:a.func,onDrop:a.func,onExecCommand:a.func,onFocus:a.func,onFocusIn:a.func,onFocusOut:a.func,onGetContent:a.func,onHide:a.func,onInit:a.func,onInput:a.func,onKeyDown:a.func,onKeyPress:a.func,onKeyUp:a.func,onLoadContent:a.func,onMouseDown:a.func,onMouseEnter:a.func,onMouseLeave:a.func,onMouseMove:a.func,onMouseOut:a.func,onMouseOver:a.func,onMouseUp:a.func,onNodeChange:a.func,onObjectResizeStart:a.func,onObjectResized:a.func,onObjectSelected:a.func,onPaste:a.func,onPostProcess:a.func,onPostRender:a.func,onPreProcess:a.func,onProgressState:a.func,onRedo:a.func,onRemove:a.func,onReset:a.func,onSaveContent:a.func,onSelectionChange:a.func,onSetAttrib:a.func,onSetContent:a.func,onShow:a.func,onSubmit:a.func,onUndo:a.func,onVisualAid:a.func,onSkinLoadError:a.func,onThemeLoadError:a.func,onModelLoadError:a.func,onPluginLoadError:a.func,onIconsLoadError:a.func,onLanguageLoadError:a.func,onScriptsLoad:a.func,onScriptsLoadError:a.func},xe=F({apiKey:a.string,licenseKey:a.string,id:a.string,inline:a.bool,init:a.object,initialValue:a.string,onEditorChange:a.func,value:a.string,tagName:a.string,tabIndex:a.number,cloudChannel:a.string,plugins:a.oneOfType([a.string,a.array]),toolbar:a.oneOfType([a.string,a.array]),disabled:a.bool,textareaName:a.string,tinymceScriptSrc:a.oneOfType([a.string,a.arrayOf(a.string),a.arrayOf(a.shape({src:a.string,async:a.bool,defer:a.bool}))]),rollback:a.oneOfType([a.number,a.oneOf([!1])]),scriptLoading:a.shape({async:a.bool,defer:a.bool,delay:a.number})},Z),q=function(s){return typeof s=="function"},V=function(s){return s in Z},G=function(s){return s.substr(2)},ge=function(s,t,r,i,o,c,n){var l=Object.keys(o).filter(V),p=Object.keys(c).filter(V),f=l.filter(function(m){return c[m]===void 0}),b=p.filter(function(m){return o[m]===void 0});f.forEach(function(m){var g=G(m),y=n[g];r(g,y),delete n[g]}),b.forEach(function(m){var g=i(s,m),y=G(m);n[y]=g,t(y,g)})},je=function(s,t,r,i,o){return ge(o,s.on.bind(s),s.off.bind(s),function(c,n){return function(l){var p;return(p=c(n))===null||p===void 0?void 0:p(l,s)}},t,r,i)},U=0,ee=function(s){var t=Date.now(),r=Math.floor(Math.random()*1e9);return U++,s+"_"+r+U+String(t)},J=function(s){return s!==null&&(s.tagName.toLowerCase()==="textarea"||s.tagName.toLowerCase()==="input")},W=function(s){return typeof s>"u"||s===""?[]:Array.isArray(s)?s:s.split(" ")},ye=function(s,t){return W(s).concat(W(t))},Ne=function(){return window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"},Ce=function(s){if(!("isConnected"in Node.prototype)){for(var t=s,r=s.parentNode;r!=null;)t=r,r=t.parentNode;return t===s.ownerDocument}return s.isConnected},X=function(s,t){s!==void 0&&(s.mode!=null&&typeof s.mode=="object"&&typeof s.mode.set=="function"?s.mode.set(t):s.setMode(t))},Q=function(){return Q=Object.assign||function(s){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(s[o]=t[o])}return s},Q.apply(this,arguments)},we=function(s,t,r){var i,o,c=s.createElement("script");c.referrerPolicy="origin",c.type="application/javascript",c.id=t.id,c.src=t.src,c.async=(i=t.async)!==null&&i!==void 0?i:!1,c.defer=(o=t.defer)!==null&&o!==void 0?o:!1;var n=function(){c.removeEventListener("load",n),c.removeEventListener("error",l),r(t.src)},l=function(p){c.removeEventListener("load",n),c.removeEventListener("error",l),r(t.src,p)};c.addEventListener("load",n),c.addEventListener("error",l),s.head&&s.head.appendChild(c)},ke=function(s){var t={},r=function(n,l){var p=t[n];p.done=!0,p.error=l;for(var f=0,b=p.handlers;f<b.length;f++){var m=b[f];m(n,l)}p.handlers=[]},i=function(n,l,p){var f=function(S){return p!==void 0?p(S):console.error(S)};if(n.length===0){f(new Error("At least one script must be provided"));return}for(var b=0,m=!1,g=function(S,E){m||(E?(m=!0,f(E)):++b===n.length&&l())},y=0,j=n;y<j.length;y++){var x=j[y],N=t[x.src];if(N)N.done?g(x.src,N.error):N.handlers.push(g);else{var k=ee("tiny-");t[x.src]={id:k,src:x.src,done:!1,error:null,handlers:[g]},we(s,Q({id:k},x),r)}}},o=function(){for(var n,l=0,p=Object.values(t);l<p.length;l++){var f=p[l],b=s.getElementById(f.id);b!=null&&b.tagName==="SCRIPT"&&((n=b.parentNode)===null||n===void 0||n.removeChild(b))}t={}},c=function(){return s};return{loadScripts:i,deleteScripts:o,getDocument:c}},Se=function(){var s=[],t=function(o){var c=s.find(function(n){return n.getDocument()===o});return c===void 0&&(c=ke(o),s.push(c)),c},r=function(o,c,n,l,p){var f=function(){return t(o).loadScripts(c,l,p)};n>0?setTimeout(f,n):f()},i=function(){for(var o=s.pop();o!=null;o=s.pop())o.deleteScripts()};return{loadList:r,reinitialize:i}},Ee=Se(),H=function(s){var t=s;return t&&t.tinymce?t.tinymce:null},Re=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])},s(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");s(t,r);function i(){this.constructor=t}t.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),O=function(){return O=Object.assign||function(s){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(s[o]=t[o])}return s},O.apply(this,arguments)},_e=function(s){Re(t,s);function t(r){var i,o,c,n=s.call(this,r)||this;return n.rollbackTimer=void 0,n.valueCursor=void 0,n.rollbackChange=function(){var l=n.editor,p=n.props.value;l&&p&&p!==n.currentContent&&l.undoManager.ignore(function(){if(l.setContent(p),n.valueCursor&&(!n.inline||l.hasFocus()))try{l.selection.moveToBookmark(n.valueCursor)}catch{}}),n.rollbackTimer=void 0},n.handleBeforeInput=function(l){if(n.props.value!==void 0&&n.props.value===n.currentContent&&n.editor&&(!n.inline||n.editor.hasFocus()))try{n.valueCursor=n.editor.selection.getBookmark(3)}catch{}},n.handleBeforeInputSpecial=function(l){(l.key==="Enter"||l.key==="Backspace"||l.key==="Delete")&&n.handleBeforeInput(l)},n.handleEditorChange=function(l){var p=n.editor;if(p&&p.initialized){var f=p.getContent();n.props.value!==void 0&&n.props.value!==f&&n.props.rollback!==!1&&(n.rollbackTimer||(n.rollbackTimer=window.setTimeout(n.rollbackChange,typeof n.props.rollback=="number"?n.props.rollback:200))),f!==n.currentContent&&(n.currentContent=f,q(n.props.onEditorChange)&&n.props.onEditorChange(f,p))}},n.handleEditorChangeSpecial=function(l){(l.key==="Backspace"||l.key==="Delete")&&n.handleEditorChange(l)},n.initialise=function(l){var p,f,b;l===void 0&&(l=0);var m=n.elementRef.current;if(m){if(!Ce(m)){if(l===0)setTimeout(function(){return n.initialise(1)},1);else if(l<100)setTimeout(function(){return n.initialise(l+1)},100);else throw new Error("tinymce can only be initialised when in a document");return}var g=H(n.view);if(!g)throw new Error("tinymce should have been loaded into global scope");var y=O(O(O(O({},n.props.init),{selector:void 0,target:m,readonly:n.props.disabled,inline:n.inline,plugins:ye((p=n.props.init)===null||p===void 0?void 0:p.plugins,n.props.plugins),toolbar:(f=n.props.toolbar)!==null&&f!==void 0?f:(b=n.props.init)===null||b===void 0?void 0:b.toolbar}),n.props.licenseKey?{license_key:n.props.licenseKey}:{}),{setup:function(j){n.editor=j,n.bindHandlers({}),n.inline&&!J(m)&&j.once("PostRender",function(x){j.setContent(n.getInitialValue(),{no_events:!0})}),n.props.init&&q(n.props.init.setup)&&n.props.init.setup(j)},init_instance_callback:function(j){var x,N,k=n.getInitialValue();n.currentContent=(x=n.currentContent)!==null&&x!==void 0?x:j.getContent(),n.currentContent!==k&&(n.currentContent=k,j.setContent(k),j.undoManager.clear(),j.undoManager.add(),j.setDirty(!1));var S=(N=n.props.disabled)!==null&&N!==void 0?N:!1;X(n.editor,S?"readonly":"design"),n.props.init&&q(n.props.init.init_instance_callback)&&n.props.init.init_instance_callback(j)}});n.inline||(m.style.visibility=""),J(m)&&(m.value=n.getInitialValue()),g.init(y)}},n.id=n.props.id||ee("tiny-react"),n.elementRef=v.createRef(),n.inline=(c=(i=n.props.inline)!==null&&i!==void 0?i:(o=n.props.init)===null||o===void 0?void 0:o.inline)!==null&&c!==void 0?c:!1,n.boundHandlers={},n}return Object.defineProperty(t.prototype,"view",{get:function(){var r,i;return(i=(r=this.elementRef.current)===null||r===void 0?void 0:r.ownerDocument.defaultView)!==null&&i!==void 0?i:window},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(r){var i=this,o,c;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(r),this.editor.initialized)){if(this.currentContent=(o=this.currentContent)!==null&&o!==void 0?o:this.editor.getContent(),typeof this.props.initialValue=="string"&&this.props.initialValue!==r.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if(typeof this.props.value=="string"&&this.props.value!==this.currentContent){var n=this.editor;n.undoManager.transact(function(){var p;if(!i.inline||n.hasFocus())try{p=n.selection.getBookmark(3)}catch{}var f=i.valueCursor;if(n.setContent(i.props.value),!i.inline||n.hasFocus())for(var b=0,m=[p,f];b<m.length;b++){var g=m[b];if(g)try{n.selection.moveToBookmark(g),i.valueCursor=g;break}catch{}}})}if(this.props.disabled!==r.disabled){var l=(c=this.props.disabled)!==null&&c!==void 0?c:!1;X(this.editor,l?"readonly":"design")}}},t.prototype.componentDidMount=function(){var r=this,i,o,c,n,l;if(H(this.view)!==null)this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&this.props.tinymceScriptSrc.length===0)(o=(i=this.props).onScriptsLoadError)===null||o===void 0||o.call(i,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(!((c=this.elementRef.current)===null||c===void 0)&&c.ownerDocument){var p=function(){var b,m;(m=(b=r.props).onScriptsLoad)===null||m===void 0||m.call(b),r.initialise()},f=function(b){var m,g;(g=(m=r.props).onScriptsLoadError)===null||g===void 0||g.call(m,b)};Ee.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),(l=(n=this.props.scriptLoading)===null||n===void 0?void 0:n.delay)!==null&&l!==void 0?l:0,p,f)}},t.prototype.componentWillUnmount=function(){var r=this,i=this.editor;i&&(i.off(this.changeEvents(),this.handleEditorChange),i.off(this.beforeInputEvent(),this.handleBeforeInput),i.off("keypress",this.handleEditorChangeSpecial),i.off("keydown",this.handleBeforeInputSpecial),i.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(o){i.off(o,r.boundHandlers[o])}),this.boundHandlers={},i.remove(),this.editor=void 0)},t.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},t.prototype.changeEvents=function(){var r,i,o,c=(o=(i=(r=H(this.view))===null||r===void 0?void 0:r.Env)===null||i===void 0?void 0:i.browser)===null||o===void 0?void 0:o.isIE();return c?"change keyup compositionend setcontent CommentChange":"change input compositionend setcontent CommentChange"},t.prototype.beforeInputEvent=function(){return Ne()?"beforeinput SelectionChange":"SelectionChange"},t.prototype.renderInline=function(){var r=this.props.tagName,i=r===void 0?"div":r;return v.createElement(i,{ref:this.elementRef,id:this.id,tabIndex:this.props.tabIndex})},t.prototype.renderIframe=function(){return v.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id,tabIndex:this.props.tabIndex})},t.prototype.getScriptSources=function(){var r,i,o=(r=this.props.scriptLoading)===null||r===void 0?void 0:r.async,c=(i=this.props.scriptLoading)===null||i===void 0?void 0:i.defer;if(this.props.tinymceScriptSrc!==void 0)return typeof this.props.tinymceScriptSrc=="string"?[{src:this.props.tinymceScriptSrc,async:o,defer:c}]:this.props.tinymceScriptSrc.map(function(f){return typeof f=="string"?{src:f,async:o,defer:c}:f});var n=this.props.cloudChannel,l=this.props.apiKey?this.props.apiKey:"no-api-key",p="https://cdn.tiny.cloud/1/".concat(l,"/tinymce/").concat(n,"/tinymce.min.js");return[{src:p,async:o,defer:c}]},t.prototype.getInitialValue=function(){return typeof this.props.initialValue=="string"?this.props.initialValue:typeof this.props.value=="string"?this.props.value:""},t.prototype.bindHandlers=function(r){var i=this;if(this.editor!==void 0){je(this.editor,r,this.props,this.boundHandlers,function(l){return i.props[l]});var o=function(l){return l.onEditorChange!==void 0||l.value!==void 0},c=o(r),n=o(this.props);!c&&n?(this.editor.on(this.changeEvents(),this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):c&&!n&&(this.editor.off(this.changeEvents(),this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},t.propTypes=xe,t.defaultProps={cloudChannel:"7"},t}(v.Component);function ne(s,t){if(s===t)return!0;if(typeof s!="object"||typeof t!="object"||s==null||t==null)return!1;const r=Object.keys(s),i=Object.keys(t);if(r.length!==i.length)return!1;for(let o of r)if(!ne(s[o],t[o]))return!1;return!0}function Ie(s,t){if(s.length!==t.length)return!1;for(let r=0;r<s.length;r++)if(!ne(s[r],t[r]))return!1;return!0}const Le=new Y,Oe=({questions:s,isOpen:t,setIsOpen:r})=>{const[i,o]=v.useState(s),[c,n]=v.useState(s),[l,p]=v.useState(""),[f,b]=v.useState(null),[m,g]=v.useState(null),[y,j]=v.useState(""),x=()=>{l.trim()&&(o([...i,{id:Date.now(),text:l.trim()}]),p(""))},N=h=>{o(i.filter(w=>w.id!==h))},k=(h,w)=>{g(h),j(w)},S=()=>{o(i.map(h=>h.id===m?{...h,text:y}:h)),g(null),j("")},E=()=>{g(null),j("")},P=h=>{b(h)},R=h=>{h.preventDefault()},I=(h,w)=>{if(h.preventDefault(),f===null||f===w)return;const C=[...i],A=C[f];C.splice(f,1),C.splice(w,0,A),o(C),b(null)},L=v.useCallback(async()=>{await Le.save({type:"json",name:"gemini-extra-questions",value:JSON.stringify(i)})&&n(i)},[i,c]);return v.useEffect(()=>{t&&(Ie(i,c)||L())},[t,i,c]),e.jsx("div",{className:"card",style:{minHeight:"calc(100vh - 160px)"},hidden:!t,children:e.jsxs("div",{className:"card-body",children:[e.jsxs("button",{className:"btn btn-soft-danger btn-xs position-absolute",onClick:()=>r(!1),children:[e.jsx("i",{className:"mdi mdi-pan-left me-1"}),"Volver"]}),e.jsx("div",{className:"d-flex justify-content-center align-items-start",style:{minHeight:"calc(100vh - 220px)"},children:e.jsxs("div",{className:"d-flex flex-column align-items-center",children:[e.jsx("div",{className:"rounded-pill bg-success bg-opacity-10 text-success px-4 py-1 fw-semibold",children:"Inicio"}),e.jsx("i",{className:"d-block mdi mdi-pan-down text-secondary opacity-50",style:{fontSize:"24px"}}),e.jsx("div",{className:"rounded bg-primary bg-opacity-10 text-primary px-4 py-1 fw-semibold",children:"Saludo inicial (cliente)"}),e.jsx("i",{className:"d-block mdi mdi-pan-down text-secondary opacity-50",style:{fontSize:"24px"}}),e.jsx("div",{className:"rounded bg-primary bg-opacity-10 text-primary px-4 py-1 fw-semibold",children:"Recolección de datos (bot)"}),e.jsx("i",{className:"d-block mdi mdi-pan-down text-secondary opacity-50 mb-2",style:{fontSize:"24px"}}),e.jsxs("fieldset",{className:"w-100 border rounded position-relative p-2",style:{minWidth:"480px"},children:[e.jsx("legend",{className:"position-absolute top-0 start-50 translate-middle bg-white px-2 fw-semibold text-uppercase small text-muted mb-0",style:{width:"max-content"},children:"Preguntas extra"}),i.map((h,w)=>e.jsxs("div",{draggable:!0,onDragStart:()=>P(w),onDragOver:R,onDrop:C=>I(C,w),onDoubleClick:()=>k(h.id,h.text),className:"d-flex align-items-center rounded bg-light border px-2 py-2 mb-2 mt-0 cursor-move",children:[e.jsx("i",{className:"mdi mdi-drag me-2 text-muted"}),m===h.id?e.jsxs("div",{className:"flex-grow-1 d-flex gap-1",children:[e.jsx("input",{type:"text",className:"form-control form-control-sm",value:y,onChange:C=>j(C.target.value),onKeyDown:C=>C.key==="Enter"&&S()}),e.jsx("button",{className:"btn btn-xs btn-outline-success ",onClick:S,children:e.jsx("i",{className:"mdi mdi-check"})}),e.jsx("button",{className:"btn btn-xs btn-outline-secondary ",onClick:E,children:e.jsx("i",{className:"mdi mdi-close"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-grow-1",children:h.text}),e.jsx("button",{className:"btn btn-xs btn-outline-primary ms-1",onClick:()=>k(h.id,h.text),children:e.jsx("i",{className:"mdi mdi-pencil"})}),e.jsx("button",{className:"btn btn-xs btn-outline-danger ms-1",onClick:()=>N(h.id),children:e.jsx("i",{className:"mdi mdi-trash-can"})})]})]},h.id)),e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Nueva pregunta",value:l,onChange:h=>p(h.target.value),onKeyDown:h=>h.key==="Enter"&&x()}),e.jsx("button",{className:"btn btn-outline-primary",onClick:x,children:e.jsx("i",{className:"mdi mdi-plus"})})]})]}),e.jsx("i",{className:"d-block mdi mdi-pan-down text-secondary opacity-50",style:{fontSize:"24px"}}),e.jsx("div",{className:"rounded bg-primary bg-opacity-10 text-primary px-4 py-1 fw-semibold",children:"Saludo final (asistente)"}),e.jsx("i",{className:"d-block mdi mdi-pan-down text-secondary opacity-50",style:{fontSize:"24px"}}),e.jsx("div",{className:"rounded-pill bg-danger bg-opacity-10 text-danger px-4 py-1 fw-semibold",children:"Fin"})]})})]})})},M=new Y,Te=({can:s,constants:t,statuses:r})=>{const i=v.useRef(),o=v.useRef(),c=v.useRef(),n=v.useRef(),l=v.useRef(),p=v.useRef(),f=v.useRef(),b=v.useRef(),[m,g]=v.useState(),[y,j]=v.useState(),[x,N]=v.useState(window.location.hash.slice(1)||"general"),[k,S]=v.useState(!1),E=(d,u,_,T,ce="")=>{const B=R(u);switch(g(T),j(ce),c.current.value=u,o.current.value=T,T){case"simpleHTML":l.editor.root.innerHTML=B.value;break;case"HTML":p.current.setContent(B.value);break;default:n.current.value=B.value;break}$(i.current).find(".modal-title").text(_),$(i.current).modal("show")},P=async d=>{d.preventDefault();let u=n.current.value;switch(m){case"simpleHTML":u=l.editor.root.innerHTML;break;case"HTML":u=p.current.getContent();break}const _={type:o.current.value,name:c.current.value,value:u};await M.save(_)&&($(i.current).modal("hide"),location.reload())},R=d=>{const u=t.find(({name:_})=>_==d);return u||{name:d,value:null}},I=v.useRef(),L=v.useRef(),h=v.useRef(),w=v.useRef(),C=v.useRef(),A=()=>{const d=R("assignation-lead-status"),u=JSON.parse(d.value);$(C.current).find(".modal-title").text("Estados de asignacion"),I.current.value="assignation-lead-status",$(L.current).val(u==null?void 0:u.lead).trigger("change"),$(h.current).val(u==null?void 0:u.manage).trigger("change"),$(w.current).val(u==null?void 0:u.task).trigger("change"),$(C.current).modal("show")},ae=()=>{const d=R("revertion-lead-status"),u=JSON.parse(d.value);$(C.current).find(".modal-title").text("Estados de reversion"),I.current.value="revertion-lead-status",$(L.current).val(u==null?void 0:u.lead).trigger("change"),$(h.current).val(u==null?void 0:u.manage).trigger("change"),$(w.current).val(u==null?void 0:u.task).trigger("change"),$(C.current).modal("show")},te=async d=>{d.preventDefault();const u={lead:L.current.value,manage:h.current.value,task:w.current.value},_={name:I.current.value,value:JSON.stringify(u),type:"json"};await M.save(_)&&($(i.current).modal("hide"),location.reload())},se=async d=>{const u={name:"finished-project-status",value:d.target.value};await M.save(u)},re=async d=>{const u={name:"converted-lead-status",value:d.target.value};await M.save(u)},ie=R("finished-project-status"),oe=R("converted-lead-status");v.useEffect(()=>{window.location.hash=x},[x]),v.useEffect(()=>{$(f.current).val(ie.value).select2(),$(b.current).val(oe.value).select2()},[null]);const le=R("gemini-extra-questions");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"card",style:{minHeight:"calc(100vh - 160px)"},hidden:k,children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"header-title mb-0",children:"Configura aqui las constantes del sistema"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-3 mb-2",children:e.jsxs("div",{className:"nav flex-column nav-pills nav-pills-tab",id:"v-pills-tab",role:"tablist","aria-orientation":"vertical",children:[e.jsx("button",{className:`nav-link mb-1 text-start ${x==="general"?"active show":""}`,id:"v-general-tab","data-bs-toggle":"pill",href:"#v-general",role:"tab","aria-controls":"v-general","aria-selected":"true",onClick:()=>N("general"),children:"General"}),e.jsx("button",{className:`nav-link mb-1 text-start ${x==="dashboard"?"active show":""}`,id:"v-dashboard-tab","data-bs-toggle":"pill",href:"#v-dashboard",role:"tab","aria-controls":"v-dashboard","aria-selected":"true",onClick:()=>N("dashboard"),children:"Dashboard"}),e.jsx("button",{className:`nav-link mb-1 text-start ${x==="clients-leads"?"active show":""}`,id:"v-clients-leads-tab","data-bs-toggle":"pill",href:"#v-clients-leads",role:"tab","aria-controls":"v-clients-leads","aria-selected":"false",onClick:()=>N("clients-leads"),children:"Clientes y leads"}),e.jsx("button",{className:`nav-link mb-1 text-start ${x==="projects"?"active show":""}`,id:"v-projects-tab","data-bs-toggle":"pill",href:"#v-projects",role:"tab","aria-controls":"v-projects","aria-selected":"false",onClick:()=>N("projects"),children:"Proyectos"}),e.jsx("button",{className:`nav-link mb-1 text-start ${x==="email"?"active show":""}`,id:"v-email-tab","data-bs-toggle":"pill",href:"#v-email",role:"tab","aria-controls":"v-email","aria-selected":"false",onClick:()=>N("email"),children:"Correo"}),e.jsx("button",{className:`nav-link mb-1 text-start ${x==="whatsapp"?"active show":""}`,id:"v-whatsapp-tab","data-bs-toggle":"pill",href:"#v-whatsapp",role:"tab","aria-controls":"v-whatsapp","aria-selected":"false",onClick:()=>N("whatsapp"),children:"WhatsApp"}),e.jsxs("button",{className:`nav-link mb-1 text-start ${x==="generativeai"?"active show":""}`,id:"v-generativeai-tab","data-bs-toggle":"pill",href:"#v-generativeai",role:"tab","aria-controls":"v-generativeai","aria-selected":"false",onClick:()=>N("generativeai"),children:["Chat IA ",e.jsx("i",{className:"mdi mdi-star-four-points"})]})]})}),e.jsx("div",{className:"col-sm-9",children:e.jsxs("div",{className:"tab-content pt-0",children:[e.jsxs("div",{className:`tab-pane fade ${x==="general"?"show active":""} coming-soon`,id:"v-general",role:"tabpanel","aria-labelledby":"v-general-tab",children:[e.jsx("h4",{children:"Configuracion general"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",children:[e.jsx("h5",{className:"card-title mb-1",children:"Que julio no vea esto"}),e.jsx("p",{className:"card-text mb-1",children:"Si lo ves, aun esta en implementacion, pero quiero que vaya quedando el diseño"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Atte. Manuel (el 9)"})})]})}),e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",children:[e.jsx("h5",{className:"card-title mb-1",children:"Que julio no vea esto"}),e.jsx("p",{className:"card-text mb-1",children:"Si lo ves, aun esta en implementacion, pero quiero que vaya quedando el diseño"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Atte. Manuel (el 9)"})})]})}),e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",children:[e.jsx("h5",{className:"card-title mb-1",children:"Que julio no vea esto"}),e.jsx("p",{className:"card-text mb-1",children:"Si lo ves, aun esta en implementacion, pero quiero que vaya quedando el diseño"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Atte. Manuel (el 9)"})})]})})]})]}),e.jsxs("div",{className:`tab-pane fade ${x==="dashboard"?"show active":""}`,id:"v-dashboard",role:"tabpanel","aria-labelledby":"v-dashboard-tab",children:[e.jsx("h4",{children:"Configuracion de dashboard"}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",style:{cursor:"default"},children:[e.jsx("h5",{className:"card-title mb-1",children:"Estado de Conversión"}),e.jsx("p",{className:"card-text mb-0",children:"¿Cuál es el estado que define mejor a un lead que ha sido convertido exitosamente?"}),e.jsx("blockquote",{className:"my-1",style:{borderLeft:"4px solid #007bff",backgroundColor:"var(--bs-gray-300)",padding:"5px 10px"},children:e.jsx("small",{children:"Esta configuración nos ayudará a identificar y medir las conversiones efectivas en el sistema."})}),e.jsx(D,{eRef:b,label:"Escoge un estado",noMargin:!0,onChange:re,children:r.filter(d=>d.table_id=="9c27e649-574a-47eb-82af-851c5d425434").map((d,u)=>e.jsx("option",{value:d.id,children:d.name},u))})]})})})]}),e.jsxs("div",{className:`tab-pane fade ${x==="clientsleads"?"show active":""}`,id:"v-clients-leads",role:"tabpanel","aria-labelledby":"v-clients-leads-tab",children:[e.jsx("h4",{children:"Configuracion de clientes y leads"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:A,children:[e.jsx("h5",{className:"card-title mb-1",children:"Estados de asignacion"}),e.jsx("p",{className:"card-text mb-0",children:"Cuales son los estados que asignan el usuario al cliente directamente?"})]})}),e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:ae,children:[e.jsx("h5",{className:"card-title mb-1",children:"Estados de reversion"}),e.jsx("p",{className:"card-text mb-0",children:"Cuales son los estados que quitan la asignacion del usuario directamente?"})]})})]})]}),e.jsxs("div",{className:`tab-pane fade ${x==="projects"?"show active":""}`,id:"v-projects",role:"tabpanel","aria-labelledby":"v-projects-tab",children:[e.jsx("h4",{children:"Configuracion de Proyectos"}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",children:[e.jsx("h5",{className:"card-title mb-1",children:"Estado de culminación"}),e.jsx("p",{className:"card-text",children:"¿Qué estado define mejor a un proyecto que ha sido terminado?"}),e.jsx(D,{eRef:f,label:"Escoge un estado",noMargin:!0,onChange:se,children:r.filter(d=>d.table_id=="cd8bd48f-c73c-4a62-9935-024139f3be5f").map((d,u)=>e.jsx("option",{value:d.id,children:d.name},u))})]})})})]}),e.jsxs("div",{className:`tab-pane fade ${x==="email"?"show active":""} coming-soon`,id:"v-email",role:"tabpanel","aria-labelledby":"v-email-tab",children:[e.jsx("h4",{children:"Configuracion de correo"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",children:[e.jsx("h5",{className:"card-title mb-1",children:"Credenciales"}),e.jsx("p",{className:"card-text mb-1",children:"De donde saldran los mensajes de correo hacia los leads?"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Correo actual: mundoweb.pe"})})]})}),e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:()=>{},children:[e.jsx("h5",{className:"card-title mb-1",children:"Diseño de correo para el lead"}),e.jsx("p",{className:"card-text mb-1",children:"Que correo veran los nuevos leads cuando caigan al crm?"})]})}),e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",children:[e.jsx("h5",{className:"card-title mb-1",children:"Correo administrador"}),e.jsx("p",{className:"card-text mb-1",children:"A que correo deseas que te enviemos un mensaje cuando se registe un nuevo lead?"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted ",style:{wordWrap:"wrap"},children:"Correo actual: gamboapalominocarlosmanuel@gmail.com"})})]})})]})]}),e.jsxs("div",{className:`tab-pane fade ${x==="whatsapp"?"show active":""}`,id:"v-whatsapp",role:"tabpanel","aria-labelledby":"v-whatsapp-tab",children:[e.jsx("h4",{children:"Configuracion de WhatsApp"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:d=>E(d,"whatsapp-new-lead-notification-message","Notificacion - Nuevo lead","simpleHTML"),children:[e.jsx("h5",{className:"card-title mb-1",children:"Notificacion - Nuevo lead"}),e.jsx("p",{className:"card-text mb-1",children:"Que mensaje llegara al grupo/persona encargado de revisar los leads?"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Click para modificar"})})]})}),e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:d=>E(d,"whatsapp-new-lead-notification-waid","Grupo/Persona encargado","text"),children:[e.jsx("h5",{className:"card-title mb-1",children:"Grupo/Persona encargado"}),e.jsx("p",{className:"card-text mb-1",children:"A quien(es) debemos notificar cuando se registre un nuevo lead?"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Click para modificar"})})]})}),e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:d=>E(d,"whatsapp-new-lead-notification-message-client","Notificacion al lead","simpleHTML"),children:[e.jsx("h5",{className:"card-title mb-1",children:"Notificacion al lead"}),e.jsx("p",{className:"card-text mb-1",children:"Que mensaje le llegara al lead cuando sea registrado en el sistema?"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Click para modificar"})})]})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:d=>E(d,"whatsapp-assigned-message-client","Mensaje de asignación","simpleHTML","Variables disponibles: {{user}} = nombre del ejecutivo, {{lead}} = nombre del cliente"),children:[e.jsx("h5",{className:"card-title mb-1",children:"Mensaje de asignación"}),e.jsx("p",{className:"card-text mb-1",children:"Mensaje que se enviará al lead cuando sea asignado a un usuario/ejecutivo"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Click para modificar"})})]})})})]}),e.jsxs("div",{className:`tab-pane fade ${x==="generativeai"?"show active":""}`,id:"v-generativeai",role:"tabpanel","aria-labelledby":"v-generativeai-tab",children:[e.jsxs("h4",{children:["IA ",e.jsx("i",{className:"mdi mdi-star-four-points"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:d=>E(d,"gemini-api-key","API Key - Gemini","text"),children:[e.jsx("h5",{className:"card-title mb-1",children:"API Key - Gemini"}),e.jsxs("p",{className:"card-text mb-1",children:["Configura un API key para que ",e.jsx("b",{children:"Gemini"})," interactue con nuevos clientes."]}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Click para modificar"})})]})}),e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:d=>E(d,"gemini-what-business-do","Que hace tu empresa [Separado por comas]","text"),children:[e.jsx("h5",{className:"card-title mb-1",children:"Que hace tu empresa"}),e.jsx("p",{className:"card-text mb-1",children:"Ayuda a Gemini a saber que productos y/o servicios buscan los clientes en tu empresa"}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Click para modificar"})})]})}),e.jsx("div",{className:"col-md-4 col-sm-6 col-xs-12",children:e.jsxs("div",{className:"card card-body border p-2",onClick:()=>S(!0),children:[e.jsx("h5",{className:"card-title mb-1",children:"Flujo de asistente (Beta)"}),e.jsx("p",{className:"card-text mb-1",children:"Configura el flujo de Gemini con leads para automatizar preguntas y respuestas."}),e.jsx("p",{className:"card-text",children:e.jsx("small",{className:"text-muted",children:"Click para modificar"})})]})})]})]})]})})]})})]}),e.jsx(Oe,{questions:JSON.parse(le.value??"[]"),isOpen:k,setIsOpen:S})]})}),e.jsxs(z,{modalRef:C,title:"",onSubmit:te,size:"sm",children:[e.jsx("input",{ref:I,type:"hidden"}),e.jsxs("div",{className:"row",id:"assignation-status-container",children:[e.jsxs(D,{eRef:L,label:"Estado del lead",dropdownParent:"#assignation-status-container",required:!0,children:[e.jsx("option",{value:!0,children:"- Sin accion -"}),r.filter(({table_id:d})=>d=="e05a43e5-b3a6-46ce-8d1f-381a73498f33").sort((d,u)=>d.order-u.order).map((d,u)=>e.jsx("option",{value:d.id,children:d.name},`status-${u}`))]}),e.jsxs(D,{eRef:h,label:"Estado de gestion",dropdownParent:"#assignation-status-container",required:!0,children:[e.jsx("option",{value:!0,children:"- Sin accion -"}),r.filter(({table_id:d})=>d=="9c27e649-574a-47eb-82af-851c5d425434").sort((d,u)=>d.order-u.order).map((d,u)=>e.jsx("option",{value:d.id,children:d.name},`status-${u}`))]}),e.jsxs(D,{eRef:w,label:"Estado de la tarea",dropdownParent:"#assignation-status-container",required:!0,children:[e.jsx("option",{value:!0,children:"- Sin accion -"}),e.jsx("option",{value:"Pendiente",children:"Pendiente"}),e.jsx("option",{value:"En curso",children:"En curso"}),e.jsx("option",{value:"Realizado",children:"Realizado"})]})]})]}),e.jsx(z,{modalRef:i,title:"",onSubmit:P,size:"md",children:e.jsxs("div",{className:"row",id:"settings-crud-container",children:[e.jsx("input",{ref:c,type:"hidden"}),e.jsx("input",{ref:o,type:"hidden"}),e.jsx("div",{style:{display:m=="text"||m==""||m==null?"block":"none"},children:e.jsx(be,{eRef:n,label:e.jsxs(e.Fragment,{children:["Valor ",y&&e.jsxs("small",{children:["(",y,")"]})]}),col:"col-12"})}),e.jsx("div",{style:{display:m=="simpleHTML"?"block":"none"},children:e.jsx(ve,{eRef:l,label:e.jsxs(e.Fragment,{children:["Valor ",y&&e.jsxs("small",{children:["(",y,")"]})]}),col:"col-12",theme:"bubble"})}),e.jsxs("div",{className:"col-12",style:{display:m=="HTML"?"block":"none"},children:[e.jsx("label",{htmlFor:"",children:"Valor de la variable"}),e.jsx(_e,{apiKey:"k2389nfj5bxjbe7s3kkc3c6fututtaba9syfaviluaf2jew6",onInit:(d,u)=>p.current=u,init:{height:500,menubar:!1,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","code","help","wordcount"],toolbar:"undo redo | blocks | bold italic forecolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"}})]})]})})]})};pe((s,t)=>{if(!t.can("settings","root","all","list"))return location.href="/";me(s).render(e.jsx(he,{...t,title:"Configuraciones",showTitle:!1,children:e.jsx(Te,{...t})}))});
