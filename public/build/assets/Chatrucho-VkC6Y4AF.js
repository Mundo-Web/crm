import{C as g,c as j,j as t,r as s,G as v}from"./CreateReactScript-DkPHjjj8.js";import{A as b,u as N}from"./Adminto-B7_J_EaR.js";import"./Logout-8TYPfS2o.js";import"./sweetalert2.esm.all-DXx0rc8u.js";const w=({session:n,messages:r=[],waDummy:p})=>{const[l,m]=s.useState(r),[c,d]=s.useState(""),[a,x]=s.useState(p),{socket:o}=N({}),u=s.useRef(null),f=[...l].sort((e,i)=>e.microtime-i.microtime),h=async()=>{if(c.trim())try{await fetch(`${v.APP_URL}/meta/evoapi/${n.business_uuid}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:{pushName:"Dummy",key:{fromMe:!1,remoteJid:`${a}@s.whatsapp.net`},messageType:"conversation",message:{conversation:c.trim()}}})}),d("")}catch(e){console.error("Error sending message:",e)}};return s.useEffect(()=>{m(r)},[r]),s.useEffect(()=>{var e;(e=u.current)==null||e.scrollIntoView({behavior:"smooth"})},[l]),s.useEffect(()=>{o.emit("register_filters",{contactActive:a});const e=i=>{m(y=>[...y,i])};return o.on("message.created",e),()=>{o.off("message.created",e)}},[o,a]),t.jsx("div",{className:"container d-flex justify-content-center align-items-center ",style:{minHeight:"calc(100vh - 200px)"},children:t.jsx("div",{className:"col-xl-4 col-lg-6 col-md-8 col-sm-10 col-12",children:t.jsxs("div",{className:"card shadow-sm",children:[t.jsx("div",{className:"card-header bg-primary text-white text-center",children:t.jsx("h5",{className:"mb-0",children:"Chat"})}),t.jsxs("div",{className:"card-body p-0 d-flex flex-column",style:{height:"600px"},children:[t.jsxs("div",{className:"flex-fill overflow-auto p-3 bg-light",children:[f.map(e=>t.jsx("div",{className:`d-flex mb-2 ${e.role==="Human"?"justify-content-end":"justify-content-start"}`,children:t.jsx("div",{className:`px-3 py-2 rounded shadow-sm ${e.role==="Human"?"bg-primary text-white":"bg-white text-dark border"}`,style:{maxWidth:"75%",whiteSpace:"pre-line"},children:e.message})},e.id)),t.jsx("div",{ref:u})]}),t.jsx("div",{className:"input-group p-2 border-top",children:t.jsx("input",{type:"text",className:"form-control form-control-sm",value:a,onChange:e=>x(e.target.value),placeholder:"NÃºmero dummy..."})}),t.jsxs("div",{className:"input-group p-2 border-top",children:[t.jsx("input",{type:"text",className:"form-control form-control-sm",value:c,onChange:e=>d(e.target.value),onKeyDown:e=>e.key==="Enter"&&h(),placeholder:"Escribe un mensaje..."}),t.jsx("button",{className:"btn btn-primary btn-sm",onClick:h,children:"Enviar"})]})]})]})})})};g((n,r)=>{j(n).render(t.jsx(b,{...r,title:"Simple Chat",children:t.jsx(w,{...r})}))});
