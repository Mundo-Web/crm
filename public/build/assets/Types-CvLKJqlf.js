var w=Object.defineProperty;var T=(o,s,r)=>s in o?w(o,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[s]=r;var p=(o,s,r)=>T(o,typeof s!="symbol"?s+"":s,r);import{m as n,C as E,c as R,j as t,r as d}from"./CreateReactScript-DiT3hDbE.js";import{R as c}from"./ReactAppend-BXtQNJ7e.js";import{a as S,S as C}from"./SetSelectValue-BLhMwzms.js";import{A as F}from"./Adminto-GQhBcQWN.js";import{M as A}from"./Modal-Zb77CfSz.js";import{T as D,D as y}from"./DxPanelButton-rgfoSPIo.js";import{I as k}from"./InputFormGroup-CbQnIdio.js";import{T as O}from"./TextareaFormGroup-BDSgQCfr.js";import{T as g}from"./TippyButton-BV90dL4o.js";import"./server.browser-DOmhYhu7.js";class u{}p(u,"paginate",async s=>{const{result:r}=await n.Fetch("/api/types/paginate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)});return r}),p(u,"save",async s=>{try{const{status:r,result:i}=await n.Fetch("/api/types",{method:"POST",body:JSON.stringify(s)});if(!r)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:i.message,type:"success"}),!0}catch(r){return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:r.message,type:"danger"}),!1}}),p(u,"status",async({id:s,status:r})=>{try{const{status:i,result:l}=await n.Fetch("/api/types/status",{method:"PATCH",body:JSON.stringify({id:s,status:r})});if(!i)throw new Error((l==null?void 0:l.message)??"Ocurrio un error inesperado");return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:l.message,type:"success"}),!0}catch(i){return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:i.message,type:"danger"}),!1}}),p(u,"delete",async s=>{try{const{status:r,result:i}=await n.Fetch(`/api/types/${s}`,{method:"DELETE"});if(!r)throw new Error((i==null?void 0:i.message)??"Ocurrio un error inesperado");return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:i.message,type:"success"}),!0}catch(r){return n.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:r.message,type:"danger"}),!1}});const G=()=>{const o=d.useRef(),s=d.useRef(),r=d.useRef(),i=d.useRef(),l=d.useRef(),f=d.useRef(),[h,b]=d.useState(!1),x=e=>{var a,m;e!=null&&e.id?b(!0):b(!1),r.current.value=(e==null?void 0:e.id)||null,C(l.current,(a=e==null?void 0:e.table)==null?void 0:a.id,(m=e==null?void 0:e.table)==null?void 0:m.name),i.current.value=(e==null?void 0:e.name)||null,f.current.value=(e==null?void 0:e.description)||null,$(s.current).modal("show")},j=async e=>{e.preventDefault();const a={id:r.current.value||void 0,table_id:l.current.value,name:i.current.value,description:f.current.value};await u.save(a)&&($(o.current).dxDataGrid("instance").refresh(),$(s.current).modal("hide"))},N=async({id:e,status:a})=>{await u.status({id:e,status:a})&&$(o.current).dxDataGrid("instance").refresh()},v=async e=>{await u.delete(e)&&$(o.current).dxDataGrid("instance").refresh()};return t.jsxs(t.Fragment,{children:[t.jsx(D,{gridRef:o,title:"Tipos",rest:u,toolBar:e=>{e.unshift(y({className:"btn btn-xs btn-soft-dark",text:"Actualizar",title:"Refrescar tabla",icon:"fas fa-undo-alt",onClick:()=>$(o.current).dxDataGrid("instance").refresh()})),e.unshift(y({className:"btn btn-xs btn-soft-primary",text:"Nuevo",title:"Agregar registro",icon:"fa fa-plus",onClick:()=>onOpenModal()}))},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"table.name",caption:"Tabla",dataType:"string"},{dataField:"name",caption:"Tipo"},{dataField:"description",caption:"Descripcion",cellTemplate:(e,{value:a})=>{a?c(e,a):c(e,t.jsx("i",{className:"text-muted",children:"- Sin descripcion -"}))}},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(e,{data:a})=>{switch(a.status){case 1:c(e,t.jsx("span",{className:"badge bg-success rounded-pill",children:"Activo"}));break;case 0:c(e,t.jsx("span",{className:"badge bg-danger rounded-pill",children:"Inactivo"}));break;default:c(e,t.jsx("span",{className:"badge bg-dark rounded-pill",children:"Eliminado"}));break}}},{caption:"Acciones",cellTemplate:(e,{data:a})=>{e.attr("style","display: flex; gap: 4px; overflow: unset"),c(e,t.jsx(g,{className:"btn btn-xs btn-soft-primary",title:"Editar",onClick:()=>x(a),children:t.jsx("i",{className:"fa fa-pen"})})),c(e,t.jsx(g,{className:"btn btn-xs btn-light",title:a.status===null?"Restaurar":"Cambiar estado",onClick:()=>N(a),children:a.status===1?t.jsx("i",{className:"fa fa-toggle-on text-success"}):a.status===0?t.jsx("i",{className:"fa fa-toggle-off text-danger"}):t.jsx("i",{className:"fas fa-trash-restore"})})),c(e,t.jsx(g,{className:"btn btn-xs btn-soft-danger",title:"Eliminar",onClick:()=>v(a.id),children:t.jsx("i",{className:"fa fa-trash-alt"})}))},allowFiltering:!1,allowExporting:!1}]}),t.jsx(A,{modalRef:s,title:h?"Editar tipo":"Agregar tipo",onSubmit:j,size:"sm",children:t.jsxs("div",{className:"row",id:"type-crud-container",children:[t.jsx("input",{ref:r,type:"hidden"}),t.jsx(k,{eRef:i,label:"Tipo",col:"col-12",required:!0}),t.jsx(S,{eRef:l,label:"Tabla",col:"col-12",dropdownParent:"#type-crud-container",searchAPI:"/api/tables/paginate",searchBy:"name",required:!0}),t.jsx(O,{eRef:f,label:"Descripcion",col:"col-12"})]})})]})};E((o,s)=>{R(o).render(t.jsx(F,{...s,title:"Tipos",children:t.jsx(G,{...s})}))});
